var utils=function(){function e(e,n,t){if(t){var r=new Date;r.setTime(r.getTime()+60*t*1e3);var a="; expires="+r.toUTCString()}else var a="";document.cookie=e+"="+n+a+"; path=/"}function n(e){return document.cookie.length>0&&(c_start=document.cookie.indexOf(e+"="),c_start!=-1)?(c_start=c_start+e.length+1,c_end=document.cookie.indexOf(";",c_start),c_end==-1&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):null}function t(n){e(n,"",-60)}function r(t,r){var a=n(t);null!=a&&e(t,a,r)}function a(){return o(window.location.href)}function o(e){var n={};if(e.indexOf("#")==-1)return n;for(var t,r=/\+/g,a=/([^&;=]+)=?([^&;]*)/g,o=function(e){return decodeURIComponent(e.replace(r," "))},i=e.substring(e.indexOf("#")+1);t=a.exec(i);)n[o(t[1])]=o(t[2]);return n}function c(){return u(window.location.href)}function u(e){return e.indexOf("?")==-1?{}:(q=e.substring(e.indexOf("?")+1),q.indexOf("#")>0&&(q=q.substring(0,q.indexOf("#"))),l(q))}function l(e){var n={};if(S(e))return n;for(var t,r=/\+/g,a=/([^&;=]+)=?([^&;]*)/g,o=function(e){return decodeURIComponent(e.replace(r," "))},n={};t=a.exec(e);)n[o(t[1])]=o(t[2]);return n}function s(e,n){return 0==n.length?e:(e+="?",_.each(n,function(n,t){e+=t+"="+n+"&"}),e=e.substring(0,e.length-1))}function d(e,n){return n<=0?"":n>String(e).length?e:String(e).substring(0,n)}function p(e,n){if(n<=0)return"";if(n>String(e).length)return e;var t=String(e).length;return String(e).substring(t,t-n)}function f(e){return!isNaN(parseFloat(e))&&isFinite(e)}function m(e){if(0==f(e))return!1;e=parseFloat(e);var n=e===(0|parseInt(e));return n}function g(e){return/\S+@\S+\.\S+/.test(e)}function h(){return Math.floor(1e7*Math.random()+1)}function v(e,n){if(null!=e){var t=e.__proto__||e.constructor.prototype;return n in e&&(!(n in t)||t[n]!==e[n])}return!1}function y(e,n){var t=0;return _.each(e,function(e){v(e,n)&&(t+=e[n])}),t}function b(){for(var e=arguments.length,n=1;n<e;n++)if(null==arguments[n]||arguments[n]!=arguments[n-1])return!1;return!0}function S(e){return null==e||void 0==e||(""==e||null==w(e))}function $(e){for(var n in e)e.hasOwnProperty(n)&&("false"===e[n]&&(e[n]=!1),"true"===e[n]&&(e[n]=!0))}function C(e){return"true"==e}function w(e){return e.replace(/ /g,"")}function k(e,n){return Math.round(e*n*100)/100}function T(e){var n=0,t=0,r=!1;e=e.replace(/\D/g,"");for(var a=e.length-1;a>=0;a--){var o=e.charAt(a),t=parseInt(o,10);r&&(t*=2)>9&&(t-=9),n+=t,r=!r}return n%10==0}function E(e){for(var n in e)if(e.hasOwnProperty(n)){if("[object Object]"===Object.prototype.toString.call(e[n])&&E(e[n]),"[object Array]"===Object.prototype.toString.call(e[n]))for(var t in e[n])E(t);void 0===e[n]&&(e[n]=null)}}function x(e,n,t){for(var r=[];e;e=e.nextSibling)1==e.nodeType&&e!=n&&(t?t.toUpperCase()==e.nodeName.toUpperCase()&&r.push(e):r.push(e));return r}function A(e,n){return x(e.parentNode.firstChild,e,n)}function M(e){function n(e){var n=String(e);return 1===n.length&&(n="0"+n),n}var t=new Date,r="00",a="00",o="00";return e||(r=t.getUTCHours(),a=t.getUTCMinutes(),o=t.getUTCSeconds()),t.getUTCFullYear()+"-"+n(t.getUTCMonth()+1)+"-"+n(t.getUTCDate())+"T"+n(r)+":"+n(a)+":"+n(o)+"Z"}function I(e,n){var t="";for(i=0;i<n;i++)t+=e;return t}function P(e,n,t){_.isString(e)&&(e=l(e)),e=e||{};var r=String(e.hide||"").split(","),a=String(e.expand||"").split(","),o=String(n||"").split(","),i=String(t||"").split(",");return r=_.reject(r,function(e){return o.indexOf(e)>=0}),a=a.concat(i),a=_.uniq(a),e.hide=r.join(","),e.expand=a.join(","),e.hide=j(e.hide,","),e.expand=j(e.expand,","),e}function O(e,n){return e&&e.substring(0,1)==n&&(e=e.substring(1)),e}function N(e,n){return e&&"/"==e.charAt(e.length-1)&&(e=e.substr(0,e.length-1)),e}function L(e){var n=e.split(","),t=_.uniq(n);return t.join(",")}function j(e,n){return N(O(e,n),n)}function B(e){var n=[];return n.push("af-na","af-za","af","ar-ae","ar-bh","ar-dj","ar-dz","ar-eg","ar-eh","ar-er","ar-il","ar-iq","ar-jo","ar-km","ar-kw","ar-lb","ar-ly","ar-ma","ar-mr","ar-om","ar-ps","ar-qa","ar-sa","ar-sd","ar-so","ar-ss","ar-sy","ar-td","ar-tn","ar-ye","ar","az-cyrl-az","az-cyrl","az-latn-az","az-latn","az","bg-bg","bg","bo-cn","bo-in","bo","cs-cz","cs","da-dk","da-gl","da","dav-ke","dav","de-at","de-be","de-ch","de-de","de-li","de-lu","de","el-cy","el-gr","el","en-ag","en-ai","en-as","en-au","en-bb","en-be","en-bm","en-bs","en-bw","en-bz","en-ca","en-cc","en-ck","en-cm","en-cx","en-dg","en-dm","en-dsrt-us","en-dsrt","en-er","en-fj","en-fk","en-fm","en-gb","en-gd","en-gg","en-gh","en-gi","en-gm","en-gu","en-gy","en-hk","en-ie","en-im","en-in","en-io","en-iso","en-je","en-jm","en-ke","en-ki","en-kn","en-ky","en-lc","en-lr","en-ls","en-mg","en-mh","en-mo","en-mp","en-ms","en-mt","en-mu","en-mw","en-na","en-nf","en-ng","en-nr","en-nu","en-nz","en-pg","en-ph","en-pk","en-pn","en-pr","en-pw","en-rw","en-sb","en-sc","en-sd","en-sg","en-sh","en-sl","en-ss","en-sx","en-sz","en-tc","en-tk","en-to","en-tt","en-tv","en-tz","en-ug","en-um","en-us","en-vc","en-vg","en-vi","en-vu","en-ws","en-za","en-zm","en-zw","en","es-ar","es-bo","es-cl","es-co","es-cr","es-cu","es-do","es-ea","es-ec","es-es","es-gq","es-gt","es-hn","es-ic","es-mx","es-ni","es-pa","es-pe","es-ph","es-pr","es-py","es-sv","es-us","es-uy","es-ve","es","et-ee","et","eu-es","eu","fa-af","fa-ir","fa","fi-fi","fi","fil-ph","fil","fr-be","fr-bf","fr-bi","fr-bj","fr-bl","fr-ca","fr-cd","fr-cf","fr-cg","fr-ch","fr-ci","fr-cm","fr-dj","fr-dz","fr-fr","fr-ga","fr-gf","fr-gn","fr-gp","fr-gq","fr-ht","fr-km","fr-lu","fr-ma","fr-mc","fr-mf","fr-mg","fr-ml","fr-mq","fr-mr","fr-mu","fr-nc","fr-ne","fr-pf","fr-pm","fr-re","fr-rw","fr-sc","fr-sn","fr-sy","fr-td","fr-tg","fr-tn","fr-vu","fr-wf","fr-yt","fr","hi-in","hi","hr-ba","hr-hr","hr","hu-hu","hu","hy-am","hy","is-is","is","it-ch","it-it","it-sm","it","ja-jp","ja","ka-ge","ka","kab-dz","kab","kam-ke","kam","kk-cyrl-kz","kk-cyrl","kk","kkj-cm","kkj","kl-gl","kl","kln-ke","kln","km-kh","km","ko-kp","ko-kr","ko","kok-in","kok","lo-la","lo","lt-lt","lt","mg-mg","mg","mgh-mz","mgh","mgo-cm","mgo","mk-mk","mk","mn-cyrl-mn","mn-cyrl","mn","ms-bn","ms-latn-bn","ms-latn-my","ms-latn-sg","ms-latn","ms-my","ms","mt-mt","mt","ne-in","ne-np","ne","nl-aw","nl-be","nl-bq","nl-cw","nl-nl","nl-sr","nl-sx","nl","no-no","no","pl-pl","pl","pt-ao","pt-br","pt-cv","pt-gw","pt-mo","pt-mz","pt-pt","pt-st","pt-tl","pt","ro-md","ro-ro","ro","rof-tz","rof","ru-by","ru-kg","ru-kz","ru-md","ru-ru","ru-ua","ru","shi-latn-ma","shi-latn","shi-tfng-ma","shi-tfng","shi","sk-sk","sk","sl-si","sl","sq-al","sq-mk","sq-xk","sq","sr-cyrl-ba","sr-cyrl-me","sr-cyrl-rs","sr-cyrl-xk","sr-cyrl","sr-latn-ba","sr-latn-me","sr-latn-rs","sr-latn-xk","sr-latn","sr","sv-ax","sv-fi","sv-se","sv","th-th","th","tl","to-to","to","tr-cy","tr-tr","tr","uk-ua","uk","uz-arab-af","uz-arab","uz-cyrl-uz","uz-cyrl","uz-latn-uz","uz-latn","uz","vi-vn","vi","zh-cn","zh-hans-cn","zh-hans-hk","zh-hans-mo","zh-hans-sg","zh-hans","zh-hant-hk","zh-hant-mo","zh-hant-tw","zh-hant","zh-hk","zh-tw","zh"),n.indexOf(localStorage.getItem("locale"))>=0?localStorage.getItem("locale"):e}return{setCookie:e,getCookie:n,deleteCookie:t,getPageHashParameters:a,getHashParameters:o,getPageQueryParameters:c,getQueryParameters:u,appendParams:s,left:d,right:p,isValidNumber:f,isValidInteger:m,getRandom:h,stringsToBool:$,stringToBool:C,hasProperty:v,areEqual:b,sumProperties:y,isNullOrEmpty:S,resetCookieExpiration:r,removeWhitespace:w,luhnCheck:T,undefinedToNull:E,parseQueryParameters:l,isValidEmail:g,getChildrenElements:x,getSiblingElements:A,convert:k,getCurrentIsoDate:M,repeat:I,mergeParams:P,deDuplicateCsv:L,getLocale:B}}();String.prototype.replaceAll=function(e,n){return this.split(e).join(n)},app.run(["$rootScope","$http","SettingsService","StorageService","LanguageService","ApiService",function(e,n,t,r,a,o){var i=t.get();i.config.development&&(n.defaults.useXDomain=!0),a.establishLanguage();var c=function(){var e=document.getElementById("app_pageview");if(e&&1!=i.config.development){var n=document.getElementsByTagName("head")[0],t=document.createElement("script");t.id="app_pageviewload",t.type="text/javascript",t.src="analytics/pageview.js",null!=document.getElementById("app_pageviewload")&&n.removeChild(document.getElementById("app_pageviewload")),n.appendChild(t)}};e.$on("$locationChangeSuccess",function(){c()})}]),angular.module("gettext",[]),angular.module("gettext").constant("gettext",function(e){return e}),angular.module("gettext").factory("gettextCatalog",["gettextPlurals","gettextFallbackLanguage","$http","$cacheFactory","$interpolate","$rootScope",function(e,n,t,r,a,o){function i(){o.$broadcast("gettextLanguageChanged")}var c,u="$$noContext",l='<span id="test" title="test" class="tested">test</span>',s=angular.element("<span>"+l+"</span>").html()!==l,d=function(e){return c.debug&&c.currentLanguage!==c.baseLanguage?c.debugPrefix+e:e},p=function(e){return c.showTranslatedMarkers?c.translatedMarkerPrefix+e+c.translatedMarkerSuffix:e};return c={debug:!1,debugPrefix:"[MISSING]: ",showTranslatedMarkers:!1,translatedMarkerPrefix:"[",translatedMarkerSuffix:"]",strings:{},baseLanguage:"en",currentLanguage:"en",cache:r("strings"),setCurrentLanguage:function(e){this.currentLanguage=e,i()},getCurrentLanguage:function(){return this.currentLanguage},setStrings:function(e,n){this.strings[e]||(this.strings[e]={});for(var t in n){var r=n[t];if(s&&(t=angular.element("<span>"+t+"</span>").html()),angular.isString(r)||angular.isArray(r)){var a={};a[u]=r,r=a}for(var o in r){var c=r[o];r[o]=angular.isArray(c)?c:[c]}this.strings[e][t]=r}i()},getStringFormFor:function(n,t,r,a){if(!n)return null;var o=this.strings[n]||{},i=o[t]||{},c=i[a||u]||[];return c[e(n,r)]},getString:function(e,t,r){var o=n(this.currentLanguage);return e=this.getStringFormFor(this.currentLanguage,e,1,r)||this.getStringFormFor(o,e,1,r)||d(e),e=t?a(e)(t):e,p(e)},getPlural:function(e,t,r,o,i){var c=n(this.currentLanguage);return t=this.getStringFormFor(this.currentLanguage,t,e,i)||this.getStringFormFor(c,t,e,i)||d(1===e?t:r),o&&(o.$count=e,t=a(t)(o)),p(t)},loadRemote:function(e){return t({method:"GET",url:e,cache:c.cache}).then(function(e){var n=e.data;for(var t in n)c.setStrings(t,n[t]);return e})}}}]),angular.module("gettext").directive("translate",["gettextCatalog","$parse","$animate","$compile","$window",function(e,n,t,r,a){function o(e,n,t){if(!e)throw new Error("You should add a "+n+" attribute whenever you add a "+t+" attribute.")}var i=function(){return String.prototype.trim?function(e){return"string"==typeof e?e.trim():e}:function(e){return"string"==typeof e?e.replace(/^\s*/,"").replace(/\s*$/,""):e}}(),c=parseInt((/msie (\d+)/.exec(angular.lowercase(a.navigator.userAgent))||[])[1],10);return{restrict:"AE",terminal:!0,compile:function(a,u){o(!u.translatePlural||u.translateN,"translate-n","translate-plural"),o(!u.translateN||u.translatePlural,"translate-plural","translate-n");var l=i(a.html()),s=u.translatePlural,d=u.translateContext;return 8>=c&&"<!--IE fix-->"===l.slice(-13)&&(l=l.slice(0,-13)),{post:function(a,o,c){function u(){var n;s?(a=f||(f=a.$new()),a.$count=p(a),n=e.getPlural(a.$count,l,s,null,d)):n=e.getString(l,null,d);var c=o.contents();if(0!==c.length){if(n===i(c.html()))return void(m&&r(c)(a));var u=angular.element("<span>"+n+"</span>");r(u.contents())(a);var g=u.contents();t.enter(g,o),t.leave(c)}}var p=n(c.translateN),f=null,m=!0;c.translateN&&a.$watch(c.translateN,u),a.$on("gettextLanguageChanged",u),u(),m=!1}}}}}]),angular.module("gettext").factory("gettextFallbackLanguage",function(){var e={},n=/([^_]+)_[^_]+$/;return function(t){if(e[t])return e[t];var r=n.exec(t);return r?(e[t]=r[1],r[1]):null}}),angular.module("gettext").filter("translate",["gettextCatalog",function(e){function n(n,t){return e.getString(n,null,t)}return n.$stateful=!0,n}]),angular.module("gettext").factory("gettextPlurals",function(){return function(e,n){switch(e){case"ay":case"bo":case"cgg":case"dz":case"fa":case"id":case"ja":case"jbo":case"ka":case"kk":case"km":case"ko":case"ky":case"lo":case"ms":case"my":case"sah":case"su":case"th":case"tt":case"ug":case"vi":case"wo":case"zh":return 0;case"is":return n%10!=1||n%100==11?1:0;case"jv":return 0!=n?1:0;case"mk":return 1==n||n%10==1?0:1;case"ach":case"ak":case"am":case"arn":case"br":case"fil":case"fr":case"gun":case"ln":case"mfe":case"mg":case"mi":case"oc":case"pt_BR":case"tg":case"ti":case"tr":case"uz":case"wa":case"zh":return n>1?1:0;case"lv":return n%10==1&&n%100!=11?0:0!=n?1:2;case"lt":return n%10==1&&n%100!=11?0:n%10>=2&&(10>n%100||n%100>=20)?1:2;case"be":case"bs":case"hr":case"ru":case"sr":case"uk":return n%10==1&&n%100!=11?0:n%10>=2&&4>=n%10&&(10>n%100||n%100>=20)?1:2;case"mnk":return 0==n?0:1==n?1:2;case"ro":return 1==n?0:0==n||n%100>0&&20>n%100?1:2;case"pl":return 1==n?0:n%10>=2&&4>=n%10&&(10>n%100||n%100>=20)?1:2;case"cs":case"sk":return 1==n?0:n>=2&&4>=n?1:2;case"sl":return n%100==1?1:n%100==2?2:n%100==3||n%100==4?3:0;case"mt":return 1==n?0:0==n||n%100>1&&11>n%100?1:n%100>10&&20>n%100?2:3;case"gd":return 1==n||11==n?0:2==n||12==n?1:n>2&&20>n?2:3;case"cy":return 1==n?0:2==n?1:8!=n&&11!=n?2:3;case"kw":return 1==n?0:2==n?1:3==n?2:3;case"ga":return 1==n?0:2==n?1:7>n?2:11>n?3:4;case"ar":return 0==n?0:1==n?1:2==n?2:n%100>=3&&10>=n%100?3:n%100>=11?4:5;default:return 1!=n?1:0}}});var duScrollDefaultEasing=function(e){"use strict";return.5>e?Math.pow(2*e,2)/2:1-Math.pow(2*(1-e),2)/2};angular.module("duScroll",["duScroll.scrollspy","duScroll.smoothScroll","duScroll.scrollContainer","duScroll.spyContext","duScroll.scrollHelpers"]).value("duScrollDuration",350).value("duScrollSpyWait",100).value("duScrollGreedy",!1).value("duScrollOffset",0).value("duScrollEasing",duScrollDefaultEasing).value("duScrollCancelOnEvents","scroll mousedown mousewheel touchmove keydown").value("duScrollBottomSpy",!1).value("duScrollActiveClass","active"),angular.module("duScroll.scrollHelpers",["duScroll.requestAnimation"]).run(["$window","$q","cancelAnimation","requestAnimation","duScrollEasing","duScrollDuration","duScrollOffset","duScrollCancelOnEvents",function(e,n,t,r,a,o,i,c){"use strict";var u={},l=function(e){return"undefined"!=typeof HTMLDocument&&e instanceof HTMLDocument||e.nodeType&&e.nodeType===e.DOCUMENT_NODE},s=function(e){return"undefined"!=typeof HTMLElement&&e instanceof HTMLElement||e.nodeType&&e.nodeType===e.ELEMENT_NODE},d=function(e){return s(e)||l(e)?e:e[0]};u.duScrollTo=function(n,t,r,a){var o;if(angular.isElement(n)?o=this.duScrollToElement:angular.isDefined(r)&&(o=this.duScrollToAnimated),o)return o.apply(this,arguments);var i=d(this);return l(i)?e.scrollTo(n,t):(i.scrollLeft=n,void(i.scrollTop=t))};var p,f;u.duScrollToAnimated=function(e,o,i,u){i&&!u&&(u=a);var l=this.duScrollLeft(),s=this.duScrollTop(),d=Math.round(e-l),m=Math.round(o-s),g=null,h=0,v=this,y=function(e){(!e||h&&e.which>0)&&(c&&v.unbind(c,y),t(p),f.reject(),p=null)};if(p&&y(),f=n.defer(),0===i||!d&&!m)return 0===i&&v.duScrollTo(e,o),f.resolve(),f.promise;var b=function(e){null===g&&(g=e),h=e-g;var n=h>=i?1:u(h/i);v.scrollTo(l+Math.ceil(d*n),s+Math.ceil(m*n)),1>n?p=r(b):(c&&v.unbind(c,y),p=null,f.resolve())};return v.duScrollTo(l,s),c&&v.bind(c,y),p=r(b),f.promise},u.duScrollToElement=function(e,n,t,r){var a=d(this);(!angular.isNumber(n)||isNaN(n))&&(n=i);var o=this.duScrollTop()+d(e).getBoundingClientRect().top-n;return s(a)&&(o-=a.getBoundingClientRect().top),this.duScrollTo(0,o,t,r)},u.duScrollLeft=function(n,t,r){if(angular.isNumber(n))return this.duScrollTo(n,this.duScrollTop(),t,r);var a=d(this);return l(a)?e.scrollX||document.documentElement.scrollLeft||document.body.scrollLeft:a.scrollLeft},u.duScrollTop=function(n,t,r){if(angular.isNumber(n))return this.duScrollTo(this.duScrollLeft(),n,t,r);var a=d(this);return l(a)?e.scrollY||document.documentElement.scrollTop||document.body.scrollTop:a.scrollTop},u.duScrollToElementAnimated=function(e,n,t,r){return this.duScrollToElement(e,n,t||o,r)},u.duScrollTopAnimated=function(e,n,t){return this.duScrollTop(e,n||o,t)},u.duScrollLeftAnimated=function(e,n,t){return this.duScrollLeft(e,n||o,t)},angular.forEach(u,function(e,n){angular.element.prototype[n]=e;var t=n.replace(/^duScroll/,"scroll");angular.isUndefined(angular.element.prototype[t])&&(angular.element.prototype[t]=e)})}]),angular.module("duScroll.polyfill",[]).factory("polyfill",["$window",function(e){"use strict";var n=["webkit","moz","o","ms"];return function(t,r){if(e[t])return e[t];for(var a,o=t.substr(0,1).toUpperCase()+t.substr(1),i=0;i<n.length;i++)if(a=n[i]+o,e[a])return e[a];return r}}]),angular.module("duScroll.requestAnimation",["duScroll.polyfill"]).factory("requestAnimation",["polyfill","$timeout",function(e,n){"use strict";var t=0,r=function(e,r){var a=(new Date).getTime(),o=Math.max(0,16-(a-t)),i=n(function(){e(a+o)},o);return t=a+o,i};return e("requestAnimationFrame",r)}]).factory("cancelAnimation",["polyfill","$timeout",function(e,n){"use strict";var t=function(e){n.cancel(e)};return e("cancelAnimationFrame",t)}]),angular.module("duScroll.spyAPI",["duScroll.scrollContainerAPI"]).factory("spyAPI",["$rootScope","$timeout","$window","$document","scrollContainerAPI","duScrollGreedy","duScrollSpyWait","duScrollBottomSpy","duScrollActiveClass",function(e,n,t,r,a,o,i,c,u){"use strict";var l=function(a){var l=!1,s=!1,d=function(){s=!1;var n,i=a.container,l=i[0],d=0;"undefined"!=typeof HTMLElement&&l instanceof HTMLElement||l.nodeType&&l.nodeType===l.ELEMENT_NODE?(d=l.getBoundingClientRect().top,n=Math.round(l.scrollTop+l.clientHeight)>=l.scrollHeight):n=Math.round(t.pageYOffset+t.innerHeight)>=r[0].body.scrollHeight;var p,f,m,g,h,v,y=c&&n?"bottom":"top";for(g=a.spies,f=a.currentlyActive,m=void 0,p=0;p<g.length;p++)h=g[p],v=h.getTargetPosition(),v&&(c&&n||v.top+h.offset-d<20&&(o||-1*v.top+d)<v.height)&&(!m||m[y]<v[y])&&(m={spy:h},m[y]=v[y]);m&&(m=m.spy),f===m||o&&!m||(f&&(f.$element.removeClass(u),e.$broadcast("duScrollspy:becameInactive",f.$element,angular.element(f.getTargetElement()))),m&&(m.$element.addClass(u),e.$broadcast("duScrollspy:becameActive",m.$element,angular.element(m.getTargetElement()))),a.currentlyActive=m)};return i?function(){l?s=!0:(d(),l=n(function(){l=!1,s&&d()},i,!1))}:d},s={},d=function(e){var n=e.$id,t={spies:[]};return t.handler=l(t),s[n]=t,e.$on("$destroy",function(){p(e)}),n},p=function(e){var n=e.$id,t=s[n],r=t.container;r&&r.off("scroll",t.handler),delete s[n]},f=d(e),m=function(e){return s[e.$id]?s[e.$id]:e.$parent?m(e.$parent):s[f]},g=function(e){var n,t,r=e.$scope;if(r)return m(r);for(t in s)if(n=s[t],-1!==n.spies.indexOf(e))return n},h=function(e){for(;e.parentNode;)if(e=e.parentNode,e===document)return!0;return!1},v=function(e){var n=g(e);n&&(n.spies.push(e),n.container&&h(n.container)||(n.container&&n.container.off("scroll",n.handler),n.container=a.getContainer(e.$scope),n.container.on("scroll",n.handler).triggerHandler("scroll")))},y=function(e){var n=g(e);e===n.currentlyActive&&(n.currentlyActive=null);var t=n.spies.indexOf(e);-1!==t&&n.spies.splice(t,1),e.$element=null};return{addSpy:v,removeSpy:y,createContext:d,destroyContext:p,getContextForScope:m}}]),angular.module("duScroll.scrollContainerAPI",[]).factory("scrollContainerAPI",["$document",function(e){"use strict";var n={},t=function(e,t){var r=e.$id;return n[r]=t,r},r=function(e){return n[e.$id]?e.$id:e.$parent?r(e.$parent):void 0},a=function(t){var a=r(t);return a?n[a]:e},o=function(e){var t=r(e);t&&delete n[t]};return{getContainerId:r,getContainer:a,setContainer:t,removeContainer:o}}]),angular.module("duScroll.smoothScroll",["duScroll.scrollHelpers","duScroll.scrollContainerAPI"]).directive("duSmoothScroll",["duScrollDuration","duScrollOffset","scrollContainerAPI",function(e,n,t){"use strict";return{link:function(r,a,o){a.on("click",function(a){if(o.href&&-1!==o.href.indexOf("#")||""!==o.duSmoothScroll){var i=o.href?o.href.replace(/.*(?=#[^\s]+$)/,"").substring(1):o.duSmoothScroll,c=document.getElementById(i)||document.getElementsByName(i)[0];if(c&&c.getBoundingClientRect){a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault();var u=o.offset?parseInt(o.offset,10):n,l=o.duration?parseInt(o.duration,10):e,s=t.getContainer(r);s.duScrollToElement(angular.element(c),isNaN(u)?0:u,isNaN(l)?0:l)}}})}}}]),angular.module("duScroll.spyContext",["duScroll.spyAPI"]).directive("duSpyContext",["spyAPI",function(e){"use strict";return{restrict:"A",scope:!0,compile:function(n,t,r){return{pre:function(n,t,r,a){e.createContext(n)}}}}}]),angular.module("duScroll.scrollContainer",["duScroll.scrollContainerAPI"]).directive("duScrollContainer",["scrollContainerAPI",function(e){"use strict";return{restrict:"A",scope:!0,compile:function(n,t,r){return{pre:function(n,t,r,a){r.$observe("duScrollContainer",function(r){angular.isString(r)&&(r=document.getElementById(r)),r=angular.isElement(r)?angular.element(r):t,e.setContainer(n,r),n.$on("$destroy",function(){e.removeContainer(n)})})}}}}}]),angular.module("duScroll.scrollspy",["duScroll.spyAPI"]).directive("duScrollspy",["spyAPI","duScrollOffset","$timeout","$rootScope",function(e,n,t,r){"use strict";var a=function(e,n,t,r){angular.isElement(e)?this.target=e:angular.isString(e)&&(this.targetId=e),this.$scope=n,this.$element=t,this.offset=r};return a.prototype.getTargetElement=function(){return!this.target&&this.targetId&&(this.target=document.getElementById(this.targetId)||document.getElementsByName(this.targetId)[0]),this.target},a.prototype.getTargetPosition=function(){var e=this.getTargetElement();return e?e.getBoundingClientRect():void 0},a.prototype.flushTargetCache=function(){this.targetId&&(this.target=void 0)},{link:function(o,i,c){var u,l=c.ngHref||c.href;if(l&&-1!==l.indexOf("#")?u=l.replace(/.*(?=#[^\s]+$)/,"").substring(1):c.duScrollspy?u=c.duScrollspy:c.duSmoothScroll&&(u=c.duSmoothScroll),u){var s=t(function(){var t=new a(u,o,i,(-(c.offset?parseInt(c.offset,10):n)));e.addSpy(t),o.$on("$locationChangeSuccess",t.flushTargetCache.bind(t));var l=r.$on("$stateChangeSuccess",t.flushTargetCache.bind(t));o.$on("$destroy",function(){e.removeSpy(t),l()})},0,!1);o.$on("$destroy",function(){t.cancel(s)})}}}}]),!function(){"use strict";angular.module("angular-loading-bar",["cfp.loadingBarInterceptor"]),angular.module("chieffancypants.loadingBar",["cfp.loadingBarInterceptor"]),angular.module("cfp.loadingBarInterceptor",["cfp.loadingBar"]).config(["$httpProvider",function(e){var n=["$q","$cacheFactory","$timeout","$rootScope","$log","cfpLoadingBar",function(n,t,r,a,o,i){function c(){r.cancel(l),i.complete(),d=0,s=0}function u(n){var r,a=t.get("$http"),o=e.defaults;!n.cache&&!o.cache||n.cache===!1||"GET"!==n.method&&"JSONP"!==n.method||(r=angular.isObject(n.cache)?n.cache:angular.isObject(o.cache)?o.cache:a);var i=void 0!==r&&void 0!==r.get(n.url);return void 0!==n.cached&&i!==n.cached?n.cached:(n.cached=i,i)}var l,s=0,d=0,p=i.latencyThreshold;return{request:function(e){return e.ignoreLoadingBar||u(e)||(a.$broadcast("cfpLoadingBar:loading",{url:e.url}),0===s&&(l=r(function(){i.start()},p)),s++,i.set(d/s)),e},response:function(e){return e&&e.config?(e.config.ignoreLoadingBar||u(e.config)||(d++,a.$broadcast("cfpLoadingBar:loaded",{url:e.config.url,result:e}),d>=s?c():i.set(d/s)),e):(o.error("Broken interceptor detected: Config object not supplied in response:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"),e)},responseError:function(e){return e&&e.config?(e.config.ignoreLoadingBar||u(e.config)||(d++,a.$broadcast("cfpLoadingBar:loaded",{url:e.config.url,result:e}),d>=s?c():i.set(d/s)),n.reject(e)):(o.error("Broken interceptor detected: Config object not supplied in rejection:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"),n.reject(e))}}}];e.interceptors.push(n)}]),angular.module("cfp.loadingBar",[]).provider("cfpLoadingBar",function(){this.autoIncrement=!0,this.includeSpinner=!0,this.includeBar=!0,this.latencyThreshold=100,this.startSize=.02,this.parentSelector="body",this.spinnerTemplate='<div id="loading-bar-spinner"><div class="spinner-icon"></div></div>',this.loadingBarTemplate='<div id="loading-bar"><div class="bar"><div class="peg"></div></div></div>',this.$get=["$injector","$document","$timeout","$rootScope",function(e,n,t,r){function a(){s||(s=e.get("$animate"));var a=n.find(f).eq(0);t.cancel(p),v||(r.$broadcast("cfpLoadingBar:started"),v=!0,$&&s.enter(m,a,angular.element(a[0].lastChild)),S&&s.enter(h,a,angular.element(a[0].lastChild)),o(C))}function o(e){if(v){var n=100*e+"%";g.css("width",n),y=e,b&&(t.cancel(d),d=t(function(){i()},250))}}function i(){if(!(c()>=1)){var e=0,n=c();e=n>=0&&.25>n?(3*Math.random()+3)/100:n>=.25&&.65>n?3*Math.random()/100:n>=.65&&.9>n?2*Math.random()/100:n>=.9&&.99>n?.005:0;var t=c()+e;o(t)}}function c(){return y}function u(){y=0,v=!1}function l(){s||(s=e.get("$animate")),r.$broadcast("cfpLoadingBar:completed"),o(1),t.cancel(p),p=t(function(){var e=s.leave(m,u);e&&e.then&&e.then(u),s.leave(h)},500)}var s,d,p,f=this.parentSelector,m=angular.element(this.loadingBarTemplate),g=m.find("div").eq(0),h=angular.element(this.spinnerTemplate),v=!1,y=0,b=this.autoIncrement,S=this.includeSpinner,$=this.includeBar,C=this.startSize;return{start:a,set:o,status:c,inc:i,complete:l,autoIncrement:this.autoIncrement,includeSpinner:this.includeSpinner,latencyThreshold:this.latencyThreshold,parentSelector:this.parentSelector,startSize:this.startSize}}]})}(),function(e){"use strict";angular.module("tmh.dynamicLocale",[]).provider("tmhDynamicLocale",function(){function e(e,n,t,r){var a=document.createElement("script"),o=document.getElementsByTagName("body")[0],i=!1;a.type="text/javascript",a.readyState?a.onreadystatechange=function(){"complete"!==a.readyState&&"loaded"!==a.readyState||(a.onreadystatechange=null,r(function(){i||(i=!0,o.removeChild(a),n())},30,!1))}:(a.onload=function(){i||(i=!0,o.removeChild(a),n())},a.onerror=function(){i||(i=!0,o.removeChild(a),t())}),a.src=e,a.async=!1,o.appendChild(a)}function n(n,t,o,i,l,s,d){function p(e,n){a===o&&(angular.forEach(e,function(t,r){n[r]?angular.isArray(n[r])&&(e[r].length=n[r].length):delete e[r]}),angular.forEach(n,function(t,r){angular.isArray(n[r])||angular.isObject(n[r])?(e[r]||(e[r]=angular.isArray(n[r])?[]:{}),p(e[r],n[r])):e[r]=n[r]}))}if(u[o])return u[o];var f,m=l.defer();return o===a?m.resolve(t):(f=s.get(o))?(a=o,i.$evalAsync(function(){p(t,f),i.$broadcast("$localeChangeSuccess",o,t),r.put(c,o),m.resolve(t)})):(a=o,u[o]=m.promise,e(n,function(){var e=angular.injector(["ngLocale"]),n=e.get("$locale");p(t,n),s.put(o,n),delete u[o],i.$apply(function(){i.$broadcast("$localeChangeSuccess",o,t),r.put(c,o),m.resolve(t)})},function(){delete u[o],i.$apply(function(){i.$broadcast("$localeChangeError",o),m.reject(o)})},d)),m.promise}var t,r,a,o="angular/i18n/angular-locale_{{locale}}.js",i="tmhDynamicLocaleStorageCache",c="tmhDynamicLocale.locale",u={};this.localeLocationPattern=function(e){return e?(o=e,this):o},this.useStorage=function(e){i=e},this.useCookieStorage=function(){this.useStorage("$cookieStore")},this.defaultLocale=function(e){t=e},this.$get=["$rootScope","$injector","$interpolate","$locale","$q","tmhDynamicLocaleCache","$timeout",function(e,a,u,l,s,d,p){var f=u(o);return r=a.get(i),e.$evalAsync(function(){var a;(a=r.get(c)||t)&&n(f({locale:a}),l,a,e,s,d,p)}),{set:function(t){return n(f({locale:t}),l,t,e,s,d,p)}}}]}).provider("tmhDynamicLocaleCache",function(){this.$get=["$cacheFactory",function(e){return e("tmh.dynamicLocales")}]}).provider("tmhDynamicLocaleStorageCache",function(){this.$get=["$cacheFactory",function(e){return e("tmh.dynamicLocales.store")}]}).run(["tmhDynamicLocale",angular.noop])}(window),angular.module("ui.bootstrap",["ui.bootstrap.dropdown","ui.bootstrap.position","ui.bootstrap.modal","ui.bootstrap.stackedMap","ui.bootstrap.typeahead","ui.bootstrap.debounce","ui.bootstrap.alert","ui.bootstrap.collapse","ui.bootstrap.tooltip"]),angular.module("ui.bootstrap.dropdown",["ui.bootstrap.position"]).constant("uibDropdownConfig",{appendToOpenClass:"uib-dropdown-open",openClass:"open"}).service("uibDropdownService",["$document","$rootScope",function(e,n){var t=null;this.open=function(n){t||(e.on("click",r),e.on("keydown",a)),t&&t!==n&&(t.isOpen=!1),t=n},this.close=function(n){t===n&&(t=null,e.off("click",r),e.off("keydown",a))};var r=function(e){if(t&&!(e&&"disabled"===t.getAutoClose()||e&&3===e.which)){var r=t.getToggleElement();if(!(e&&r&&r[0].contains(e.target))){var a=t.getDropdownElement();e&&"outsideClick"===t.getAutoClose()&&a&&a[0].contains(e.target)||(t.isOpen=!1,n.$$phase||t.$apply())}}},a=function(e){27===e.which?(t.focusToggleElement(),r()):t.isKeynavEnabled()&&-1!==[38,40].indexOf(e.which)&&t.isOpen&&(e.preventDefault(),e.stopPropagation(),t.focusDropdownEntry(e.which))}}]).controller("UibDropdownController",["$scope","$element","$attrs","$parse","uibDropdownConfig","uibDropdownService","$animate","$uibPosition","$document","$compile","$templateRequest",function(e,n,t,r,a,o,i,c,u,l,s){var d,p,f=this,m=e.$new(),g=a.appendToOpenClass,h=a.openClass,v=angular.noop,y=t.onToggle?r(t.onToggle):angular.noop,b=!1,S=null,$=!1,C=u.find("body");n.addClass("dropdown"),this.init=function(){if(t.isOpen&&(p=r(t.isOpen),v=p.assign,e.$watch(p,function(e){m.isOpen=!!e})),angular.isDefined(t.dropdownAppendTo)){var a=r(t.dropdownAppendTo)(m);a&&(S=angular.element(a))}b=angular.isDefined(t.dropdownAppendToBody),$=angular.isDefined(t.keyboardNav),b&&!S&&(S=C),S&&f.dropdownMenu&&(S.append(f.dropdownMenu),n.on("$destroy",function(){f.dropdownMenu.remove()}))},this.toggle=function(e){return m.isOpen=arguments.length?!!e:!m.isOpen},this.isOpen=function(){return m.isOpen},m.getToggleElement=function(){return f.toggleElement},m.getAutoClose=function(){return t.autoClose||"always"},m.getElement=function(){return n},m.isKeynavEnabled=function(){return $},m.focusDropdownEntry=function(e){var t=f.dropdownMenu?angular.element(f.dropdownMenu).find("a"):n.find("ul").eq(0).find("a");switch(e){case 40:f.selectedOption=angular.isNumber(f.selectedOption)?f.selectedOption===t.length-1?f.selectedOption:f.selectedOption+1:0;break;case 38:f.selectedOption=angular.isNumber(f.selectedOption)?0===f.selectedOption?0:f.selectedOption-1:t.length-1}t[f.selectedOption].focus()},m.getDropdownElement=function(){return f.dropdownMenu},m.focusToggleElement=function(){f.toggleElement&&f.toggleElement[0].focus()},m.$watch("isOpen",function(t,r){if(S&&f.dropdownMenu){var a,u,p=c.positionElements(n,f.dropdownMenu,"bottom-left",!0);if(a={top:p.top+"px",display:t?"block":"none"},u=f.dropdownMenu.hasClass("dropdown-menu-right"),u?(a.left="auto",a.right=window.innerWidth-(p.left+n.prop("offsetWidth"))+"px"):(a.left=p.left+"px",a.right="auto"),!b){var $=c.offset(S);a.top=p.top-$.top+"px",u?a.right=window.innerWidth-(p.left-$.left+n.prop("offsetWidth"))+"px":a.left=p.left-$.left+"px"}f.dropdownMenu.css(a)}var C=S?S:n;if(i[t?"addClass":"removeClass"](C,S?g:h).then(function(){angular.isDefined(t)&&t!==r&&y(e,{open:!!t})}),t)f.dropdownMenuTemplateUrl&&s(f.dropdownMenuTemplateUrl).then(function(e){d=m.$new(),l(e.trim())(d,function(e){var n=e;f.dropdownMenu.replaceWith(n),f.dropdownMenu=n})}),m.focusToggleElement(),o.open(m);else{if(f.dropdownMenuTemplateUrl){d&&d.$destroy();var w=angular.element('<ul class="dropdown-menu"></ul>');f.dropdownMenu.replaceWith(w),f.dropdownMenu=w}o.close(m),f.selectedOption=null}angular.isFunction(v)&&v(e,t)}),e.$on("$locationChangeSuccess",function(){"disabled"!==m.getAutoClose()&&(m.isOpen=!1)})}]).directive("uibDropdown",function(){return{controller:"UibDropdownController",link:function(e,n,t,r){r.init()}}}).directive("uibDropdownMenu",function(){return{restrict:"A",require:"?^uibDropdown",link:function(e,n,t,r){if(r&&!angular.isDefined(t.dropdownNested)){n.addClass("dropdown-menu");var a=t.templateUrl;a&&(r.dropdownMenuTemplateUrl=a),r.dropdownMenu||(r.dropdownMenu=n)}}}}).directive("uibDropdownToggle",function(){return{require:"?^uibDropdown",link:function(e,n,t,r){if(r){n.addClass("dropdown-toggle"),
r.toggleElement=n;var a=function(a){a.preventDefault(),n.hasClass("disabled")||t.disabled||e.$apply(function(){r.toggle()})};n.bind("click",a),n.attr({"aria-haspopup":!0,"aria-expanded":!1}),e.$watch(r.isOpen,function(e){n.attr("aria-expanded",!!e)}),e.$on("$destroy",function(){n.unbind("click",a)})}}}}),angular.module("ui.bootstrap.position",[]).factory("$uibPosition",["$document","$window",function(e,n){var t,r={normal:/(auto|scroll)/,hidden:/(auto|scroll|hidden)/},a={auto:/\s?auto?\s?/i,primary:/^(top|bottom|left|right)$/,secondary:/^(top|bottom|left|right|center)$/,vertical:/^(top|bottom)$/};return{getRawNode:function(e){return e[0]||e},parseStyle:function(e){return e=parseFloat(e),isFinite(e)?e:0},offsetParent:function(t){function r(e){return"static"===(n.getComputedStyle(e).position||"static")}t=this.getRawNode(t);for(var a=t.offsetParent||e[0].documentElement;a&&a!==e[0].documentElement&&r(a);)a=a.offsetParent;return a||e[0].documentElement},scrollbarWidth:function(){if(angular.isUndefined(t)){var n=angular.element('<div style="position: absolute; top: -9999px; width: 50px; height: 50px; overflow: scroll;"></div>');e.find("body").append(n),t=n[0].offsetWidth-n[0].clientWidth,t=isFinite(t)?t:0,n.remove()}return t},scrollParent:function(t,a){t=this.getRawNode(t);var o=a?r.hidden:r.normal,i=e[0].documentElement,c=n.getComputedStyle(t),u="absolute"===c.position,l=t.parentElement||i;if(l===i||"fixed"===c.position)return i;for(;l.parentElement&&l!==i;){var s=n.getComputedStyle(l);if(u&&"static"!==s.position&&(u=!1),!u&&o.test(s.overflow+s.overflowY+s.overflowX))break;l=l.parentElement}return l},position:function(t,r){t=this.getRawNode(t);var a=this.offset(t);if(r){var o=n.getComputedStyle(t);a.top-=this.parseStyle(o.marginTop),a.left-=this.parseStyle(o.marginLeft)}var i=this.offsetParent(t),c={top:0,left:0};return i!==e[0].documentElement&&(c=this.offset(i),c.top+=i.clientTop-i.scrollTop,c.left+=i.clientLeft-i.scrollLeft),{width:Math.round(angular.isNumber(a.width)?a.width:t.offsetWidth),height:Math.round(angular.isNumber(a.height)?a.height:t.offsetHeight),top:Math.round(a.top-c.top),left:Math.round(a.left-c.left)}},offset:function(t){t=this.getRawNode(t);var r=t.getBoundingClientRect();return{width:Math.round(angular.isNumber(r.width)?r.width:t.offsetWidth),height:Math.round(angular.isNumber(r.height)?r.height:t.offsetHeight),top:Math.round(r.top+(n.pageYOffset||e[0].documentElement.scrollTop)),left:Math.round(r.left+(n.pageXOffset||e[0].documentElement.scrollLeft))}},viewportOffset:function(t,r,a){t=this.getRawNode(t),a=a!==!1;var o=t.getBoundingClientRect(),i={top:0,left:0,bottom:0,right:0},c=r?e[0].documentElement:this.scrollParent(t),u=c.getBoundingClientRect();if(i.top=u.top+c.clientTop,i.left=u.left+c.clientLeft,c===e[0].documentElement&&(i.top+=n.pageYOffset,i.left+=n.pageXOffset),i.bottom=i.top+c.clientHeight,i.right=i.left+c.clientWidth,a){var l=n.getComputedStyle(c);i.top+=this.parseStyle(l.paddingTop),i.bottom-=this.parseStyle(l.paddingBottom),i.left+=this.parseStyle(l.paddingLeft),i.right-=this.parseStyle(l.paddingRight)}return{top:Math.round(o.top-i.top),bottom:Math.round(i.bottom-o.bottom),left:Math.round(o.left-i.left),right:Math.round(i.right-o.right)}},parsePlacement:function(e){var n=a.auto.test(e);return n&&(e=e.replace(a.auto,"")),e=e.split("-"),e[0]=e[0]||"top",a.primary.test(e[0])||(e[0]="top"),e[1]=e[1]||"center",a.secondary.test(e[1])||(e[1]="center"),e[2]=!!n,e},positionElements:function(e,t,r,o){e=this.getRawNode(e),t=this.getRawNode(t);var i=angular.isDefined(t.offsetWidth)?t.offsetWidth:t.prop("offsetWidth"),c=angular.isDefined(t.offsetHeight)?t.offsetHeight:t.prop("offsetHeight");r=this.parsePlacement(r);var u=o?this.offset(e):this.position(e),l={top:0,left:0,placement:""};if(r[2]){var s=this.viewportOffset(e),d=n.getComputedStyle(t),p={width:i+Math.round(Math.abs(this.parseStyle(d.marginLeft)+this.parseStyle(d.marginRight))),height:c+Math.round(Math.abs(this.parseStyle(d.marginTop)+this.parseStyle(d.marginBottom)))};if(r[0]="top"===r[0]&&p.height>s.top&&p.height<=s.bottom?"bottom":"bottom"===r[0]&&p.height>s.bottom&&p.height<=s.top?"top":"left"===r[0]&&p.width>s.left&&p.width<=s.right?"right":"right"===r[0]&&p.width>s.right&&p.width<=s.left?"left":r[0],r[1]="top"===r[1]&&p.height-u.height>s.bottom&&p.height-u.height<=s.top?"bottom":"bottom"===r[1]&&p.height-u.height>s.top&&p.height-u.height<=s.bottom?"top":"left"===r[1]&&p.width-u.width>s.right&&p.width-u.width<=s.left?"right":"right"===r[1]&&p.width-u.width>s.left&&p.width-u.width<=s.right?"left":r[1],"center"===r[1])if(a.vertical.test(r[0])){var f=u.width/2-i/2;s.left+f<0&&p.width-u.width<=s.right?r[1]="left":s.right+f<0&&p.width-u.width<=s.left&&(r[1]="right")}else{var m=u.height/2-p.height/2;s.top+m<0&&p.height-u.height<=s.bottom?r[1]="top":s.bottom+m<0&&p.height-u.height<=s.top&&(r[1]="bottom")}}switch(r[0]){case"top":l.top=u.top-c;break;case"bottom":l.top=u.top+u.height;break;case"left":l.left=u.left-i;break;case"right":l.left=u.left+u.width}switch(r[1]){case"top":l.top=u.top;break;case"bottom":l.top=u.top+u.height-c;break;case"left":l.left=u.left;break;case"right":l.left=u.left+u.width-i;break;case"center":a.vertical.test(r[0])?l.left=u.left+u.width/2-i/2:l.top=u.top+u.height/2-c/2}return l.top=Math.round(l.top),l.left=Math.round(l.left),l.placement="center"===r[1]?r[0]:r[0]+"-"+r[1],l},positionArrow:function(e,t){e=this.getRawNode(e);var r=e.querySelector(".tooltip-inner, .popover-inner");if(r){var o=angular.element(r).hasClass("tooltip-inner"),i=e.querySelector(o?".tooltip-arrow":".arrow");if(i){if(t=this.parsePlacement(t),"center"===t[1])return void angular.element(i).css({top:"",bottom:"",right:"",left:"",margin:""});var c="border-"+t[0]+"-width",u=n.getComputedStyle(i)[c],l="border-";l+=a.vertical.test(t[0])?t[0]+"-"+t[1]:t[1]+"-"+t[0],l+="-radius";var s=n.getComputedStyle(o?r:e)[l],d={top:"auto",bottom:"auto",left:"auto",right:"auto",margin:0};switch(t[0]){case"top":d.bottom=o?"0":"-"+u;break;case"bottom":d.top=o?"0":"-"+u;break;case"left":d.right=o?"0":"-"+u;break;case"right":d.left=o?"0":"-"+u}d[t[1]]=s,angular.element(i).css(d)}}}}}]),angular.module("ui.bootstrap.modal",["ui.bootstrap.stackedMap"]).factory("$$multiMap",function(){return{createNew:function(){var e={};return{entries:function(){return Object.keys(e).map(function(n){return{key:n,value:e[n]}})},get:function(n){return e[n]},hasKey:function(n){return!!e[n]},keys:function(){return Object.keys(e)},put:function(n,t){e[n]||(e[n]=[]),e[n].push(t)},remove:function(n,t){var r=e[n];if(r){var a=r.indexOf(t);-1!==a&&r.splice(a,1),r.length||delete e[n]}}}}}}).provider("$uibResolve",function(){var e=this;this.resolver=null,this.setResolver=function(e){this.resolver=e},this.$get=["$injector","$q",function(n,t){var r=e.resolver?n.get(e.resolver):null;return{resolve:function(e,a,o,i){if(r)return r.resolve(e,a,o,i);var c=[];return angular.forEach(e,function(e){c.push(angular.isFunction(e)||angular.isArray(e)?t.resolve(n.invoke(e)):angular.isString(e)?t.resolve(n.get(e)):t.resolve(e))}),t.all(c).then(function(n){var t={},r=0;return angular.forEach(e,function(e,a){t[a]=n[r++]}),t})}}}]}).directive("uibModalBackdrop",["$animateCss","$injector","$uibModalStack",function(e,n,t){function r(n,r,a){a.modalInClass&&(e(r,{addClass:a.modalInClass}).start(),n.$on(t.NOW_CLOSING_EVENT,function(t,o){var i=o();n.modalOptions.animation?e(r,{removeClass:a.modalInClass}).start().then(i):i()}))}return{replace:!0,templateUrl:"uib/template/modal/backdrop.html",compile:function(e,n){return e.addClass(n.backdropClass),r}}}]).directive("uibModalWindow",["$uibModalStack","$q","$animate","$animateCss","$document",function(e,n,t,r,a){return{scope:{index:"@"},replace:!0,transclude:!0,templateUrl:function(e,n){return n.templateUrl||"uib/template/modal/window.html"},link:function(o,i,c){i.addClass(c.windowClass||""),i.addClass(c.windowTopClass||""),o.size=c.size,o.close=function(n){var t=e.getTop();t&&t.value.backdrop&&"static"!==t.value.backdrop&&n.target===n.currentTarget&&(n.preventDefault(),n.stopPropagation(),e.dismiss(t.key,"backdrop click"))},i.on("click",o.close),o.$isRendered=!0;var u=n.defer();c.$observe("modalRender",function(e){"true"===e&&u.resolve()}),u.promise.then(function(){var u=null;c.modalInClass&&(u=r(i,{addClass:c.modalInClass}).start(),o.$on(e.NOW_CLOSING_EVENT,function(e,n){var a=n();r?r(i,{removeClass:c.modalInClass}).start().then(a):t.removeClass(i,c.modalInClass).then(a)})),n.when(u).then(function(){if(!a[0].activeElement||!i[0].contains(a[0].activeElement)){var e=i[0].querySelector("[autofocus]");e?e.focus():i[0].focus()}});var l=e.getTop();l&&e.modalRendered(l.key)})}}}]).directive("uibModalAnimationClass",function(){return{compile:function(e,n){n.modalAnimation&&e.addClass(n.uibModalAnimationClass)}}}).directive("uibModalTransclude",function(){return{link:function(e,n,t,r,a){a(e.$parent,function(e){n.empty(),n.append(e)})}}}).factory("$uibModalStack",["$animate","$animateCss","$document","$compile","$rootScope","$q","$$multiMap","$$stackedMap",function(e,n,t,r,a,o,i,c){function u(){for(var e=-1,n=b.keys(),t=0;t<n.length;t++)b.get(n[t]).value.backdrop&&(e=t);return e}function l(e,n){var t=b.get(e).value,r=t.appendTo;b.remove(e),p(t.modalDomEl,t.modalScope,function(){var n=t.openedClass||y;S.remove(n,e),r.toggleClass(n,S.hasKey(n)),s(!0)}),d(),n&&n.focus?n.focus():r.focus&&r.focus()}function s(e){var n;b.length()>0&&(n=b.top().value,n.modalDomEl.toggleClass(n.windowTopClass||"",e))}function d(){if(g&&-1===u()){var e=h;p(g,h,function(){e=null}),g=void 0,h=void 0}}function p(e,t,r,a){function i(){i.done||(i.done=!0,n(e,{event:"leave"}).start().then(function(){e.remove(),a&&a.resolve()}),t.$destroy(),r&&r())}var c,u=null,l=function(){return c||(c=o.defer(),u=c.promise),function(){c.resolve()}};return t.$broadcast($.NOW_CLOSING_EVENT,l),o.when(u).then(i)}function f(e){if(e.isDefaultPrevented())return e;var n=b.top();if(n)switch(e.which){case 27:n.value.keyboard&&(e.preventDefault(),a.$apply(function(){$.dismiss(n.key,"escape key press")}));break;case 9:$.loadFocusElementList(n);var t=!1;e.shiftKey?$.isFocusInFirstItem(e)&&(t=$.focusLastFocusableElement()):$.isFocusInLastItem(e)&&(t=$.focusFirstFocusableElement()),t&&(e.preventDefault(),e.stopPropagation())}}function m(e,n,t){return!e.value.modalScope.$broadcast("modal.closing",n,t).defaultPrevented}var g,h,v,y="modal-open",b=c.createNew(),S=i.createNew(),$={NOW_CLOSING_EVENT:"modal.stack.now-closing"},C=0,w="a[href], area[href], input:not([disabled]), button:not([disabled]),select:not([disabled]), textarea:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable=true]";return a.$watch(u,function(e){h&&(h.index=e)}),t.on("keydown",f),a.$on("$destroy",function(){t.off("keydown",f)}),$.open=function(n,o){var i=t[0].activeElement,c=o.openedClass||y;s(!1),b.add(n,{deferred:o.deferred,renderDeferred:o.renderDeferred,closedDeferred:o.closedDeferred,modalScope:o.scope,backdrop:o.backdrop,keyboard:o.keyboard,openedClass:o.openedClass,windowTopClass:o.windowTopClass,animation:o.animation,appendTo:o.appendTo}),S.put(c,n);var l=o.appendTo,d=u();if(!l.length)throw new Error("appendTo element not found. Make sure that the element passed is in DOM.");d>=0&&!g&&(h=a.$new(!0),h.modalOptions=o,h.index=d,g=angular.element('<div uib-modal-backdrop="modal-backdrop"></div>'),g.attr("backdrop-class",o.backdropClass),o.animation&&g.attr("modal-animation","true"),r(g)(h),e.enter(g,l));var p=angular.element('<div uib-modal-window="modal-window"></div>');p.attr({"template-url":o.windowTemplateUrl,"window-class":o.windowClass,"window-top-class":o.windowTopClass,size:o.size,index:b.length()-1,animate:"animate"}).html(o.content),o.animation&&p.attr("modal-animation","true"),e.enter(r(p)(o.scope),l).then(function(){e.addClass(l,c)}),b.top().value.modalDomEl=p,b.top().value.modalOpener=i,$.clearFocusListCache()},$.close=function(e,n){var t=b.get(e);return t&&m(t,n,!0)?(t.value.modalScope.$$uibDestructionScheduled=!0,t.value.deferred.resolve(n),l(e,t.value.modalOpener),!0):!t},$.dismiss=function(e,n){var t=b.get(e);return t&&m(t,n,!1)?(t.value.modalScope.$$uibDestructionScheduled=!0,t.value.deferred.reject(n),l(e,t.value.modalOpener),!0):!t},$.dismissAll=function(e){for(var n=this.getTop();n&&this.dismiss(n.key,e);)n=this.getTop()},$.getTop=function(){return b.top()},$.modalRendered=function(e){var n=b.get(e);n&&n.value.renderDeferred.resolve()},$.focusFirstFocusableElement=function(){return v.length>0&&(v[0].focus(),!0)},$.focusLastFocusableElement=function(){return v.length>0&&(v[v.length-1].focus(),!0)},$.isFocusInFirstItem=function(e){return v.length>0&&(e.target||e.srcElement)===v[0]},$.isFocusInLastItem=function(e){return v.length>0&&(e.target||e.srcElement)===v[v.length-1]},$.clearFocusListCache=function(){v=[],C=0},$.loadFocusElementList=function(e){if((void 0===v||!v.length)&&e){var n=e.value.modalDomEl;n&&n.length&&(v=n[0].querySelectorAll(w))}},$}]).provider("$uibModal",function(){var e={options:{animation:!0,backdrop:!0,keyboard:!0},$get:["$rootScope","$q","$document","$templateRequest","$controller","$uibResolve","$uibModalStack",function(n,t,r,a,o,i,c){function u(e){return e.template?t.when(e.template):a(angular.isFunction(e.templateUrl)?e.templateUrl():e.templateUrl)}var l={},s=null;return l.getPromiseChain=function(){return s},l.open=function(a){function l(){return v}var d=t.defer(),p=t.defer(),f=t.defer(),m=t.defer(),g={result:d.promise,opened:p.promise,closed:f.promise,rendered:m.promise,close:function(e){return c.close(g,e)},dismiss:function(e){return c.dismiss(g,e)}};if(a=angular.extend({},e.options,a),a.resolve=a.resolve||{},a.appendTo=a.appendTo||r.find("body").eq(0),!a.template&&!a.templateUrl)throw new Error("One of template or templateUrl options is required.");var h,v=t.all([u(a),i.resolve(a.resolve,{},null,null)]);return h=s=t.all([s]).then(l,l).then(function(e){var t=a.scope||n,r=t.$new();r.$close=g.close,r.$dismiss=g.dismiss,r.$on("$destroy",function(){r.$$uibDestructionScheduled||r.$dismiss("$uibUnscheduledDestruction")});var i,u={};a.controller&&(u.$scope=r,u.$uibModalInstance=g,angular.forEach(e[1],function(e,n){u[n]=e}),i=o(a.controller,u),a.controllerAs&&(a.bindToController&&(i.$close=r.$close,i.$dismiss=r.$dismiss,angular.extend(i,t)),r[a.controllerAs]=i)),c.open(g,{scope:r,deferred:d,renderDeferred:m,closedDeferred:f,content:e[0],animation:a.animation,backdrop:a.backdrop,keyboard:a.keyboard,backdropClass:a.backdropClass,windowTopClass:a.windowTopClass,windowClass:a.windowClass,windowTemplateUrl:a.windowTemplateUrl,size:a.size,openedClass:a.openedClass,appendTo:a.appendTo}),p.resolve(!0)},function(e){p.reject(e),d.reject(e)}).finally(function(){s===h&&(s=null)}),g},l}]};return e}),angular.module("ui.bootstrap.stackedMap",[]).factory("$$stackedMap",function(){return{createNew:function(){var e=[];return{add:function(n,t){e.push({key:n,value:t})},get:function(n){for(var t=0;t<e.length;t++)if(n===e[t].key)return e[t]},keys:function(){for(var n=[],t=0;t<e.length;t++)n.push(e[t].key);return n},top:function(){return e[e.length-1]},remove:function(n){for(var t=-1,r=0;r<e.length;r++)if(n===e[r].key){t=r;break}return e.splice(t,1)[0]},removeTop:function(){return e.splice(e.length-1,1)[0]},length:function(){return e.length}}}}}),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.debounce","ui.bootstrap.position"]).factory("uibTypeaheadParser",["$parse",function(e){var n=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(t){var r=t.match(n);if(!r)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+t+'".');return{itemName:r[3],source:e(r[4]),viewMapper:e(r[2]||r[1]),modelMapper:e(r[1])}}}}]).controller("UibTypeaheadController",["$scope","$element","$attrs","$compile","$parse","$q","$timeout","$document","$window","$rootScope","$$debounce","$uibPosition","uibTypeaheadParser",function(e,n,t,r,a,o,i,c,u,l,s,d,p){function f(){D.moveInProgress||(D.moveInProgress=!0,D.$digest()),J()}function m(){D.position=A?d.offset(n):d.position(n),D.position.top+=n.prop("offsetHeight")}var g,h,v=[9,13,27,38,40],y=200,b=e.$eval(t.typeaheadMinLength);b||0===b||(b=1);var S=e.$eval(t.typeaheadWaitMs)||0,$=e.$eval(t.typeaheadEditable)!==!1;e.$watch(t.typeaheadEditable,function(e){$=e!==!1});var C,w,k=a(t.typeaheadLoading).assign||angular.noop,_=a(t.typeaheadOnSelect),T=!!angular.isDefined(t.typeaheadSelectOnBlur)&&e.$eval(t.typeaheadSelectOnBlur),E=a(t.typeaheadNoResults).assign||angular.noop,x=t.typeaheadInputFormatter?a(t.typeaheadInputFormatter):void 0,A=!!t.typeaheadAppendToBody&&e.$eval(t.typeaheadAppendToBody),M=t.typeaheadAppendTo?e.$eval(t.typeaheadAppendTo):null,I=e.$eval(t.typeaheadFocusFirst)!==!1,P=!!t.typeaheadSelectOnExact&&e.$eval(t.typeaheadSelectOnExact),O=a(t.typeaheadIsOpen).assign||angular.noop,N=e.$eval(t.typeaheadShowHint)||!1,L=a(t.ngModel),q=a(t.ngModel+"($$$p)"),j=function(n,t){return angular.isFunction(L(e))&&h&&h.$options&&h.$options.getterSetter?q(n,{$$$p:t}):L.assign(n,t)},B=p.parse(t.uibTypeahead),D=e.$new(),U=e.$on("$destroy",function(){D.$destroy()});D.$on("$destroy",U);var F="typeahead-"+D.$id+"-"+Math.floor(1e4*Math.random());n.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":F});var R,z;N&&(R=angular.element("<div></div>"),R.css("position","relative"),n.after(R),z=n.clone(),z.attr("placeholder",""),z.val(""),z.css({position:"absolute",top:"0px",left:"0px","border-color":"transparent","box-shadow":"none",opacity:1,background:"none 0% 0% / auto repeat scroll padding-box border-box rgb(255, 255, 255)",color:"#999"}),n.css({position:"relative","vertical-align":"top","background-color":"transparent"}),R.append(z),z.after(n));var V=angular.element("<div uib-typeahead-popup></div>");V.attr({id:F,matches:"matches",active:"activeIdx",select:"select(activeIdx, evt)","move-in-progress":"moveInProgress",query:"query",position:"position","assign-is-open":"assignIsOpen(isOpen)",debounce:"debounceUpdate"}),angular.isDefined(t.typeaheadTemplateUrl)&&V.attr("template-url",t.typeaheadTemplateUrl),angular.isDefined(t.typeaheadPopupTemplateUrl)&&V.attr("popup-template-url",t.typeaheadPopupTemplateUrl);var G=function(){N&&z.val("")},H=function(){D.matches=[],D.activeIdx=-1,n.attr("aria-expanded",!1),G()},W=function(e){return F+"-option-"+e};D.$watch("activeIdx",function(e){0>e?n.removeAttr("aria-activedescendant"):n.attr("aria-activedescendant",W(e))});var K=function(e,n){return!!(D.matches.length>n&&e)&&e.toUpperCase()===D.matches[n].label.toUpperCase()},Y=function(t,r){var a={$viewValue:t};k(e,!0),E(e,!1),o.when(B.source(e,a)).then(function(o){var i=t===g.$viewValue;if(i&&C)if(o&&o.length>0){D.activeIdx=I?0:-1,E(e,!1),D.matches.length=0;for(var c=0;c<o.length;c++)a[B.itemName]=o[c],D.matches.push({id:W(c),label:B.viewMapper(D,a),model:o[c]});if(D.query=t,m(),n.attr("aria-expanded",!0),P&&1===D.matches.length&&K(t,0)&&(angular.isNumber(D.debounceUpdate)||angular.isObject(D.debounceUpdate)?s(function(){D.select(0,r)},angular.isNumber(D.debounceUpdate)?D.debounceUpdate:D.debounceUpdate.default):D.select(0,r)),N){var u=D.matches[0].label;z.val(t.length>0&&u.slice(0,t.length).toUpperCase()===t.toUpperCase()?t+u.slice(t.length):"")}}else H(),E(e,!0);i&&k(e,!1)},function(){H(),k(e,!1),E(e,!0)})};A&&(angular.element(u).on("resize",f),c.find("body").on("scroll",f));var J=s(function(){D.matches.length&&m(),D.moveInProgress=!1},y);D.moveInProgress=!1,D.query=void 0;var Q,Z=function(e){Q=i(function(){Y(e)},S)},X=function(){Q&&i.cancel(Q)};H(),D.assignIsOpen=function(n){O(e,n)},D.select=function(r,a){var o,c,u={};w=!0,u[B.itemName]=c=D.matches[r].model,o=B.modelMapper(e,u),j(e,o),g.$setValidity("editable",!0),g.$setValidity("parse",!0),_(e,{$item:c,$model:o,$label:B.viewMapper(e,u),$event:a}),H(),D.$eval(t.typeaheadFocusOnSelect)!==!1&&i(function(){n[0].focus()},0,!1)},n.on("keydown",function(e){if(0!==D.matches.length&&-1!==v.indexOf(e.which)){if(-1===D.activeIdx&&(9===e.which||13===e.which))return H(),void D.$digest();e.preventDefault();var n;switch(e.which){case 9:case 13:D.$apply(function(){angular.isNumber(D.debounceUpdate)||angular.isObject(D.debounceUpdate)?s(function(){D.select(D.activeIdx,e)},angular.isNumber(D.debounceUpdate)?D.debounceUpdate:D.debounceUpdate.default):D.select(D.activeIdx,e)});break;case 27:e.stopPropagation(),H(),D.$digest();break;case 38:D.activeIdx=(D.activeIdx>0?D.activeIdx:D.matches.length)-1,D.$digest(),n=V.find("li")[D.activeIdx],n.parentNode.scrollTop=n.offsetTop;break;case 40:D.activeIdx=(D.activeIdx+1)%D.matches.length,D.$digest(),n=V.find("li")[D.activeIdx],n.parentNode.scrollTop=n.offsetTop}}}),n.bind("focus",function(e){C=!0,0!==b||g.$viewValue||i(function(){Y(g.$viewValue,e)},0)}),n.bind("blur",function(e){T&&D.matches.length&&-1!==D.activeIdx&&!w&&(w=!0,D.$apply(function(){angular.isObject(D.debounceUpdate)&&angular.isNumber(D.debounceUpdate.blur)?s(function(){D.select(D.activeIdx,e)},D.debounceUpdate.blur):D.select(D.activeIdx,e)})),!$&&g.$error.editable&&(g.$viewValue="",n.val("")),C=!1,w=!1});var ee=function(e){n[0]!==e.target&&3!==e.which&&0!==D.matches.length&&(H(),l.$$phase||D.$digest())};c.on("click",ee),e.$on("$destroy",function(){c.off("click",ee),(A||M)&&ne.remove(),A&&(angular.element(u).off("resize",f),c.find("body").off("scroll",f)),V.remove(),N&&R.remove()});var ne=r(V)(D);A?c.find("body").append(ne):M?angular.element(M).eq(0).append(ne):n.after(ne),this.init=function(n,t){g=n,h=t,D.debounceUpdate=g.$options&&a(g.$options.debounce)(e),g.$parsers.unshift(function(n){return C=!0,0===b||n&&n.length>=b?S>0?(X(),Z(n)):Y(n):(k(e,!1),X(),H()),$?n:n?void g.$setValidity("editable",!1):(g.$setValidity("editable",!0),null)}),g.$formatters.push(function(n){var t,r,a={};return $||g.$setValidity("editable",!0),x?(a.$model=n,x(e,a)):(a[B.itemName]=n,t=B.viewMapper(e,a),a[B.itemName]=void 0,r=B.viewMapper(e,a),t!==r?t:n)})}}]).directive("uibTypeahead",function(){return{controller:"UibTypeaheadController",require:["ngModel","^?ngModelOptions","uibTypeahead"],link:function(e,n,t,r){r[2].init(r[0],r[1])}}}).directive("uibTypeaheadPopup",["$$debounce",function(e){return{scope:{matches:"=",query:"=",active:"=",position:"&",moveInProgress:"=",select:"&",assignIsOpen:"&",debounce:"&"},replace:!0,templateUrl:function(e,n){return n.popupTemplateUrl||"uib/template/typeahead/typeahead-popup.html"},link:function(n,t,r){n.templateUrl=r.templateUrl,n.isOpen=function(){var e=n.matches.length>0;return n.assignIsOpen({isOpen:e}),e},n.isActive=function(e){return n.active===e},n.selectActive=function(e){n.active=e},n.selectMatch=function(t,r){var a=n.debounce();angular.isNumber(a)||angular.isObject(a)?e(function(){n.select({activeIdx:t,evt:r})},angular.isNumber(a)?a:a.default):n.select({activeIdx:t,evt:r})}}}}]).directive("uibTypeaheadMatch",["$templateRequest","$compile","$parse",function(e,n,t){return{scope:{index:"=",match:"=",query:"="},link:function(r,a,o){var i=t(o.templateUrl)(r.$parent)||"uib/template/typeahead/typeahead-match.html";e(i).then(function(e){var t=angular.element(e.trim());a.replaceWith(t),n(t)(r)})}}}]).filter("uibTypeaheadHighlight",["$sce","$injector","$log",function(e,n,t){function r(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function a(e){return/<.*>/g.test(e)}var o;return o=n.has("$sanitize"),function(n,i){return!o&&a(n)&&t.warn("Unsafe use of typeahead please use ngSanitize"),n=i?(""+n).replace(new RegExp(r(i),"gi"),"<strong>$&</strong>"):n,o||(n=e.trustAsHtml(n)),n}}]),angular.module("ui.bootstrap.debounce",[]).factory("$$debounce",["$timeout",function(e){return function(n,t){var r;return function(){var a=this,o=Array.prototype.slice.call(arguments);r&&e.cancel(r),r=e(function(){n.apply(a,o)},t)}}}]),angular.module("ui.bootstrap.alert",[]).controller("UibAlertController",["$scope","$attrs","$interpolate","$timeout",function(e,n,t,r){e.closeable=!!n.close;var a=angular.isDefined(n.dismissOnTimeout)?t(n.dismissOnTimeout)(e.$parent):null;a&&r(function(){e.close()},parseInt(a,10))}]).directive("uibAlert",function(){return{controller:"UibAlertController",controllerAs:"alert",templateUrl:function(e,n){return n.templateUrl||"uib/template/alert/alert.html"},transclude:!0,replace:!0,scope:{type:"@",close:"&"}}}),angular.module("ui.bootstrap.collapse",[]).directive("uibCollapse",["$animate","$q","$parse","$injector",function(e,n,t,r){var a=r.has("$animateCss")?r.get("$animateCss"):null;return{link:function(r,o,i){function c(){o.hasClass("collapse")&&o.hasClass("in")||n.resolve(d(r)).then(function(){o.removeClass("collapse").addClass("collapsing").attr("aria-expanded",!0).attr("aria-hidden",!1),a?a(o,{addClass:"in",easing:"ease",to:{height:o[0].scrollHeight+"px"}}).start().finally(u):e.addClass(o,"in",{to:{height:o[0].scrollHeight+"px"}}).then(u)})}function u(){o.removeClass("collapsing").addClass("collapse").css({height:"auto"}),p(r)}function l(){return o.hasClass("collapse")||o.hasClass("in")?void n.resolve(f(r)).then(function(){o.css({height:o[0].scrollHeight+"px"}).removeClass("collapse").addClass("collapsing").attr("aria-expanded",!1).attr("aria-hidden",!0),a?a(o,{removeClass:"in",to:{height:"0"}}).start().finally(s):e.removeClass(o,"in",{to:{height:"0"}}).then(s)}):s()}function s(){o.css({height:"0"}),o.removeClass("collapsing").addClass("collapse"),m(r)}var d=t(i.expanding),p=t(i.expanded),f=t(i.collapsing),m=t(i.collapsed);r.$eval(i.uibCollapse)||o.addClass("in").addClass("collapse").attr("aria-expanded",!0).attr("aria-hidden",!1).css({height:"auto"}),r.$watch(i.uibCollapse,function(e){e?l():c()})}}}]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.stackedMap"]).provider("$uibTooltip",function(){function e(e){var n=/[A-Z]/g,t="-";return e.replace(n,function(e,n){return(n?t:"")+e.toLowerCase()})}var n={placement:"top",placementClassPrefix:"",animation:!0,popupDelay:0,popupCloseDelay:0,useContentExp:!1},t={mouseenter:"mouseleave",click:"click",outsideClick:"outsideClick",focus:"blur",none:""},r={};this.options=function(e){angular.extend(r,e)},this.setTriggers=function(e){angular.extend(t,e)},this.$get=["$window","$compile","$timeout","$document","$uibPosition","$interpolate","$rootScope","$parse","$$stackedMap",function(a,o,i,c,u,l,s,d,p){function f(e){if(27===e.which){var n=m.top();n&&(n.value.close(),m.removeTop(),n=null)}}var m=p.createNew();return c.on("keypress",f),s.$on("$destroy",function(){c.off("keypress",f)}),function(a,s,p,f){function g(e){var n=(e||f.trigger||p).split(" "),r=n.map(function(e){return t[e]||e});return{show:n,hide:r}}f=angular.extend({},n,r,f);var h=e(a),v=l.startSymbol(),y=l.endSymbol(),b="<div "+h+'-popup title="'+v+"title"+y+'" '+(f.useContentExp?'content-exp="contentExp()" ':'content="'+v+"content"+y+'" ')+'placement="'+v+"placement"+y+'" popup-class="'+v+"popupClass"+y+'" animation="animation" is-open="isOpen"origin-scope="origScope" style="visibility: hidden; display: block; top: -9999px; left: -9999px;"></div>';return{compile:function(){var e=o(b);return function(n,t,r){function o(){j.isOpen?p():l()}function l(){(!q||n.$eval(r[s+"Enable"]))&&(b(),C(),j.popupDelay?I||(I=i(h,j.popupDelay,!1)):h())}function p(){v(),j.popupCloseDelay?P||(P=i(y,j.popupCloseDelay,!1)):y()}function h(){return v(),b(),j.content?(S(),void j.$evalAsync(function(){j.isOpen=!0,w(!0),R()})):angular.noop}function v(){I&&(i.cancel(I),I=null),O&&(i.cancel(O),O=null)}function y(){j&&j.$evalAsync(function(){j&&(j.isOpen=!1,w(!1),j.animation?M||(M=i($,150,!1)):$())})}function b(){P&&(i.cancel(P),P=null),M&&(i.cancel(M),M=null)}function S(){x||(A=j.$new(),x=e(A,function(e){N?c.find("body").append(e):t.after(e)}),k())}function $(){v(),b(),_(),x&&(x.remove(),x=null),A&&(A.$destroy(),A=null)}function C(){j.title=r[s+"Title"],j.content=U?U(n):r[a],j.popupClass=r[s+"Class"],j.placement=angular.isDefined(r[s+"Placement"])?r[s+"Placement"]:f.placement;var e=parseInt(r[s+"PopupDelay"],10),t=parseInt(r[s+"PopupCloseDelay"],10);j.popupDelay=isNaN(e)?f.popupDelay:e,j.popupCloseDelay=isNaN(t)?f.popupCloseDelay:t}function w(e){D&&angular.isFunction(D.assign)&&D.assign(n,e)}function k(){F.length=0,U?(F.push(n.$watch(U,function(e){j.content=e,!e&&j.isOpen&&y()})),F.push(A.$watch(function(){B||(B=!0,A.$$postDigest(function(){B=!1,j&&j.isOpen&&R()}))}))):F.push(r.$observe(a,function(e){j.content=e,!e&&j.isOpen?y():R()})),F.push(r.$observe(s+"Title",function(e){j.title=e,j.isOpen&&R()})),F.push(r.$observe(s+"Placement",function(e){j.placement=e?e:f.placement,j.isOpen&&R()}))}function _(){F.length&&(angular.forEach(F,function(e){e()}),F.length=0)}function T(e){j&&j.isOpen&&x&&(t[0].contains(e.target)||x[0].contains(e.target)||p())}function E(){var e=r[s+"Trigger"];z(),L=g(e),"none"!==L.show&&L.show.forEach(function(e,n){"outsideClick"===e?(t.on("click",o),c.on("click",T)):e===L.hide[n]?t.on(e,o):e&&(t.on(e,l),t.on(L.hide[n],p)),t.on("keypress",function(e){27===e.which&&p()})})}var x,A,M,I,P,O,N=!!angular.isDefined(f.appendToBody)&&f.appendToBody,L=g(void 0),q=angular.isDefined(r[s+"Enable"]),j=n.$new(!0),B=!1,D=!!angular.isDefined(r[s+"IsOpen"])&&d(r[s+"IsOpen"]),U=!!f.useContentExp&&d(r[a]),F=[],R=function(){x&&x.html()&&(O||(O=i(function(){x.css({top:0,left:0});var e=u.positionElements(t,x,j.placement,N);x.css({top:e.top+"px",left:e.left+"px",visibility:"visible"}),f.placementClassPrefix&&x.removeClass("top bottom left right"),x.removeClass(f.placementClassPrefix+"top "+f.placementClassPrefix+"top-left "+f.placementClassPrefix+"top-right "+f.placementClassPrefix+"bottom "+f.placementClassPrefix+"bottom-left "+f.placementClassPrefix+"bottom-right "+f.placementClassPrefix+"left "+f.placementClassPrefix+"left-top "+f.placementClassPrefix+"left-bottom "+f.placementClassPrefix+"right "+f.placementClassPrefix+"right-top "+f.placementClassPrefix+"right-bottom");var n=e.placement.split("-");x.addClass(n[0]+" "+f.placementClassPrefix+e.placement),u.positionArrow(x,e.placement),O=null},0,!1)))};j.origScope=n,j.isOpen=!1,m.add(j,{close:y}),j.contentExp=function(){return j.content},r.$observe("disabled",function(e){e&&v(),e&&j.isOpen&&y()}),D&&n.$watch(D,function(e){j&&!e===j.isOpen&&o()});var z=function(){L.show.forEach(function(e){"outsideClick"===e?t.off("click",o):(t.off(e,l),t.off(e,o))}),L.hide.forEach(function(e){"outsideClick"===e?c.off("click",T):t.off(e,p)})};E();var V=n.$eval(r[s+"Animation"]);j.animation=angular.isDefined(V)?!!V:f.animation;var G,H=s+"AppendToBody";G=H in r&&void 0===r[H]||n.$eval(r[H]),N=angular.isDefined(G)?G:N,N&&n.$on("$locationChangeSuccess",function(){j.isOpen&&y()}),n.$on("$destroy",function(){z(),$(),m.remove(j),j=null})}}}}}]}).directive("uibTooltipTemplateTransclude",["$animate","$sce","$compile","$templateRequest",function(e,n,t,r){return{link:function(a,o,i){var c,u,l,s=a.$eval(i.tooltipTemplateTranscludeScope),d=0,p=function(){u&&(u.remove(),u=null),c&&(c.$destroy(),c=null),l&&(e.leave(l).then(function(){u=null}),u=l,l=null)};a.$watch(n.parseAsResourceUrl(i.uibTooltipTemplateTransclude),function(n){var i=++d;n?(r(n,!0).then(function(r){if(i===d){var a=s.$new(),u=r,f=t(u)(a,function(n){p(),e.enter(n,o)});c=a,l=f,c.$emit("$includeContentLoaded",n)}},function(){i===d&&(p(),a.$emit("$includeContentError",n))}),a.$emit("$includeContentRequested",n)):p()}),a.$on("$destroy",p)}}}]).directive("uibTooltipClasses",["$uibPosition",function(e){return{restrict:"A",link:function(n,t,r){if(n.placement){var a=e.parsePlacement(n.placement);t.addClass(a[0])}else t.addClass("top");n.popupClass&&t.addClass(n.popupClass),n.animation()&&t.addClass(r.tooltipAnimationClass)}}}]).directive("uibTooltipPopup",function(){return{replace:!0,scope:{content:"@",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"uib/template/tooltip/tooltip-popup.html"}}).directive("uibTooltip",["$uibTooltip",function(e){return e("uibTooltip","tooltip","mouseenter")}]).directive("uibTooltipTemplatePopup",function(){
return{replace:!0,scope:{contentExp:"&",placement:"@",popupClass:"@",animation:"&",isOpen:"&",originScope:"&"},templateUrl:"uib/template/tooltip/tooltip-template-popup.html"}}).directive("uibTooltipTemplate",["$uibTooltip",function(e){return e("uibTooltipTemplate","tooltip","mouseenter",{useContentExp:!0})}]).directive("uibTooltipHtmlPopup",function(){return{replace:!0,scope:{contentExp:"&",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"uib/template/tooltip/tooltip-html-popup.html"}}).directive("uibTooltipHtml",["$uibTooltip",function(e){return e("uibTooltipHtml","tooltip","mouseenter",{useContentExp:!0})}]),angular.module("ui.bootstrap.typeahead").run(function(){!angular.$$csp().noInlineStyle&&angular.element(document).find("head").prepend('<style type="text/css">[uib-typeahead-popup].dropdown-menu{display:block;}</style>')}),function(){function e(e){function n(n,t,r,a,o,i){for(;o>=0&&i>o;o+=e){var c=a?a[o]:o;r=t(r,n[c],c,n)}return r}return function(t,r,a,o){r=b(r,o,4);var i=!T(t)&&y.keys(t),c=(i||t).length,u=e>0?0:c-1;return arguments.length<3&&(a=t[i?i[u]:u],u+=e),n(t,r,a,i,u,c)}}function n(e){return function(n,t,r){t=S(t,r);for(var a=_(n),o=e>0?0:a-1;o>=0&&a>o;o+=e)if(t(n[o],o,n))return o;return-1}}function t(e,n,t){return function(r,a,o){var i=0,c=_(r);if("number"==typeof o)e>0?i=o>=0?o:Math.max(o+c,i):c=o>=0?Math.min(o+1,c):o+c+1;else if(t&&o&&c)return o=t(r,a),r[o]===a?o:-1;if(a!==a)return o=n(s.call(r,i,c),y.isNaN),o>=0?o+i:-1;for(o=e>0?i:c-1;o>=0&&c>o;o+=e)if(r[o]===a)return o;return-1}}function r(e,n){var t=I.length,r=e.constructor,a=y.isFunction(r)&&r.prototype||c,o="constructor";for(y.has(e,o)&&!y.contains(n,o)&&n.push(o);t--;)o=I[t],o in e&&e[o]!==a[o]&&!y.contains(n,o)&&n.push(o)}var a=this,o=a._,i=Array.prototype,c=Object.prototype,u=Function.prototype,l=i.push,s=i.slice,d=c.toString,p=c.hasOwnProperty,f=Array.isArray,m=Object.keys,g=u.bind,h=Object.create,v=function(){},y=function(e){return e instanceof y?e:this instanceof y?void(this._wrapped=e):new y(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=y),exports._=y):a._=y,y.VERSION="1.8.3";var b=function(e,n,t){if(void 0===n)return e;switch(null==t?3:t){case 1:return function(t){return e.call(n,t)};case 2:return function(t,r){return e.call(n,t,r)};case 3:return function(t,r,a){return e.call(n,t,r,a)};case 4:return function(t,r,a,o){return e.call(n,t,r,a,o)}}return function(){return e.apply(n,arguments)}},S=function(e,n,t){return null==e?y.identity:y.isFunction(e)?b(e,n,t):y.isObject(e)?y.matcher(e):y.property(e)};y.iteratee=function(e,n){return S(e,n,1/0)};var $=function(e,n){return function(t){var r=arguments.length;if(2>r||null==t)return t;for(var a=1;r>a;a++)for(var o=arguments[a],i=e(o),c=i.length,u=0;c>u;u++){var l=i[u];n&&void 0!==t[l]||(t[l]=o[l])}return t}},C=function(e){if(!y.isObject(e))return{};if(h)return h(e);v.prototype=e;var n=new v;return v.prototype=null,n},w=function(e){return function(n){return null==n?void 0:n[e]}},k=Math.pow(2,53)-1,_=w("length"),T=function(e){var n=_(e);return"number"==typeof n&&n>=0&&k>=n};y.each=y.forEach=function(e,n,t){n=b(n,t);var r,a;if(T(e))for(r=0,a=e.length;a>r;r++)n(e[r],r,e);else{var o=y.keys(e);for(r=0,a=o.length;a>r;r++)n(e[o[r]],o[r],e)}return e},y.map=y.collect=function(e,n,t){n=S(n,t);for(var r=!T(e)&&y.keys(e),a=(r||e).length,o=Array(a),i=0;a>i;i++){var c=r?r[i]:i;o[i]=n(e[c],c,e)}return o},y.reduce=y.foldl=y.inject=e(1),y.reduceRight=y.foldr=e(-1),y.find=y.detect=function(e,n,t){var r;return r=T(e)?y.findIndex(e,n,t):y.findKey(e,n,t),void 0!==r&&r!==-1?e[r]:void 0},y.filter=y.select=function(e,n,t){var r=[];return n=S(n,t),y.each(e,function(e,t,a){n(e,t,a)&&r.push(e)}),r},y.reject=function(e,n,t){return y.filter(e,y.negate(S(n)),t)},y.every=y.all=function(e,n,t){n=S(n,t);for(var r=!T(e)&&y.keys(e),a=(r||e).length,o=0;a>o;o++){var i=r?r[o]:o;if(!n(e[i],i,e))return!1}return!0},y.some=y.any=function(e,n,t){n=S(n,t);for(var r=!T(e)&&y.keys(e),a=(r||e).length,o=0;a>o;o++){var i=r?r[o]:o;if(n(e[i],i,e))return!0}return!1},y.contains=y.includes=y.include=function(e,n,t,r){return T(e)||(e=y.values(e)),("number"!=typeof t||r)&&(t=0),y.indexOf(e,n,t)>=0},y.invoke=function(e,n){var t=s.call(arguments,2),r=y.isFunction(n);return y.map(e,function(e){var a=r?n:e[n];return null==a?a:a.apply(e,t)})},y.pluck=function(e,n){return y.map(e,y.property(n))},y.where=function(e,n){return y.filter(e,y.matcher(n))},y.findWhere=function(e,n){return y.find(e,y.matcher(n))},y.max=function(e,n,t){var r,a,o=-1/0,i=-1/0;if(null==n&&null!=e){e=T(e)?e:y.values(e);for(var c=0,u=e.length;u>c;c++)r=e[c],r>o&&(o=r)}else n=S(n,t),y.each(e,function(e,t,r){a=n(e,t,r),(a>i||a===-1/0&&o===-1/0)&&(o=e,i=a)});return o},y.min=function(e,n,t){var r,a,o=1/0,i=1/0;if(null==n&&null!=e){e=T(e)?e:y.values(e);for(var c=0,u=e.length;u>c;c++)r=e[c],o>r&&(o=r)}else n=S(n,t),y.each(e,function(e,t,r){a=n(e,t,r),(i>a||1/0===a&&1/0===o)&&(o=e,i=a)});return o},y.shuffle=function(e){for(var n,t=T(e)?e:y.values(e),r=t.length,a=Array(r),o=0;r>o;o++)n=y.random(0,o),n!==o&&(a[o]=a[n]),a[n]=t[o];return a},y.sample=function(e,n,t){return null==n||t?(T(e)||(e=y.values(e)),e[y.random(e.length-1)]):y.shuffle(e).slice(0,Math.max(0,n))},y.sortBy=function(e,n,t){return n=S(n,t),y.pluck(y.map(e,function(e,t,r){return{value:e,index:t,criteria:n(e,t,r)}}).sort(function(e,n){var t=e.criteria,r=n.criteria;if(t!==r){if(t>r||void 0===t)return 1;if(r>t||void 0===r)return-1}return e.index-n.index}),"value")};var E=function(e){return function(n,t,r){var a={};return t=S(t,r),y.each(n,function(r,o){var i=t(r,o,n);e(a,r,i)}),a}};y.groupBy=E(function(e,n,t){y.has(e,t)?e[t].push(n):e[t]=[n]}),y.indexBy=E(function(e,n,t){e[t]=n}),y.countBy=E(function(e,n,t){y.has(e,t)?e[t]++:e[t]=1}),y.toArray=function(e){return e?y.isArray(e)?s.call(e):T(e)?y.map(e,y.identity):y.values(e):[]},y.size=function(e){return null==e?0:T(e)?e.length:y.keys(e).length},y.partition=function(e,n,t){n=S(n,t);var r=[],a=[];return y.each(e,function(e,t,o){(n(e,t,o)?r:a).push(e)}),[r,a]},y.first=y.head=y.take=function(e,n,t){return null==e?void 0:null==n||t?e[0]:y.initial(e,e.length-n)},y.initial=function(e,n,t){return s.call(e,0,Math.max(0,e.length-(null==n||t?1:n)))},y.last=function(e,n,t){return null==e?void 0:null==n||t?e[e.length-1]:y.rest(e,Math.max(0,e.length-n))},y.rest=y.tail=y.drop=function(e,n,t){return s.call(e,null==n||t?1:n)},y.compact=function(e){return y.filter(e,y.identity)};var x=function(e,n,t,r){for(var a=[],o=0,i=r||0,c=_(e);c>i;i++){var u=e[i];if(T(u)&&(y.isArray(u)||y.isArguments(u))){n||(u=x(u,n,t));var l=0,s=u.length;for(a.length+=s;s>l;)a[o++]=u[l++]}else t||(a[o++]=u)}return a};y.flatten=function(e,n){return x(e,n,!1)},y.without=function(e){return y.difference(e,s.call(arguments,1))},y.uniq=y.unique=function(e,n,t,r){y.isBoolean(n)||(r=t,t=n,n=!1),null!=t&&(t=S(t,r));for(var a=[],o=[],i=0,c=_(e);c>i;i++){var u=e[i],l=t?t(u,i,e):u;n?(i&&o===l||a.push(u),o=l):t?y.contains(o,l)||(o.push(l),a.push(u)):y.contains(a,u)||a.push(u)}return a},y.union=function(){return y.uniq(x(arguments,!0,!0))},y.intersection=function(e){for(var n=[],t=arguments.length,r=0,a=_(e);a>r;r++){var o=e[r];if(!y.contains(n,o)){for(var i=1;t>i&&y.contains(arguments[i],o);i++);i===t&&n.push(o)}}return n},y.difference=function(e){var n=x(arguments,!0,!0,1);return y.filter(e,function(e){return!y.contains(n,e)})},y.zip=function(){return y.unzip(arguments)},y.unzip=function(e){for(var n=e&&y.max(e,_).length||0,t=Array(n),r=0;n>r;r++)t[r]=y.pluck(e,r);return t},y.object=function(e,n){for(var t={},r=0,a=_(e);a>r;r++)n?t[e[r]]=n[r]:t[e[r][0]]=e[r][1];return t},y.findIndex=n(1),y.findLastIndex=n(-1),y.sortedIndex=function(e,n,t,r){t=S(t,r,1);for(var a=t(n),o=0,i=_(e);i>o;){var c=Math.floor((o+i)/2);t(e[c])<a?o=c+1:i=c}return o},y.indexOf=t(1,y.findIndex,y.sortedIndex),y.lastIndexOf=t(-1,y.findLastIndex),y.range=function(e,n,t){null==n&&(n=e||0,e=0),t=t||1;for(var r=Math.max(Math.ceil((n-e)/t),0),a=Array(r),o=0;r>o;o++,e+=t)a[o]=e;return a};var A=function(e,n,t,r,a){if(!(r instanceof n))return e.apply(t,a);var o=C(e.prototype),i=e.apply(o,a);return y.isObject(i)?i:o};y.bind=function(e,n){if(g&&e.bind===g)return g.apply(e,s.call(arguments,1));if(!y.isFunction(e))throw new TypeError("Bind must be called on a function");var t=s.call(arguments,2),r=function(){return A(e,r,n,this,t.concat(s.call(arguments)))};return r},y.partial=function(e){var n=s.call(arguments,1),t=function(){for(var r=0,a=n.length,o=Array(a),i=0;a>i;i++)o[i]=n[i]===y?arguments[r++]:n[i];for(;r<arguments.length;)o.push(arguments[r++]);return A(e,t,this,this,o)};return t},y.bindAll=function(e){var n,t,r=arguments.length;if(1>=r)throw new Error("bindAll must be passed function names");for(n=1;r>n;n++)t=arguments[n],e[t]=y.bind(e[t],e);return e},y.memoize=function(e,n){var t=function(r){var a=t.cache,o=""+(n?n.apply(this,arguments):r);return y.has(a,o)||(a[o]=e.apply(this,arguments)),a[o]};return t.cache={},t},y.delay=function(e,n){var t=s.call(arguments,2);return setTimeout(function(){return e.apply(null,t)},n)},y.defer=y.partial(y.delay,y,1),y.throttle=function(e,n,t){var r,a,o,i=null,c=0;t||(t={});var u=function(){c=t.leading===!1?0:y.now(),i=null,o=e.apply(r,a),i||(r=a=null)};return function(){var l=y.now();c||t.leading!==!1||(c=l);var s=n-(l-c);return r=this,a=arguments,0>=s||s>n?(i&&(clearTimeout(i),i=null),c=l,o=e.apply(r,a),i||(r=a=null)):i||t.trailing===!1||(i=setTimeout(u,s)),o}},y.debounce=function(e,n,t){var r,a,o,i,c,u=function(){var l=y.now()-i;n>l&&l>=0?r=setTimeout(u,n-l):(r=null,t||(c=e.apply(o,a),r||(o=a=null)))};return function(){o=this,a=arguments,i=y.now();var l=t&&!r;return r||(r=setTimeout(u,n)),l&&(c=e.apply(o,a),o=a=null),c}},y.wrap=function(e,n){return y.partial(n,e)},y.negate=function(e){return function(){return!e.apply(this,arguments)}},y.compose=function(){var e=arguments,n=e.length-1;return function(){for(var t=n,r=e[n].apply(this,arguments);t--;)r=e[t].call(this,r);return r}},y.after=function(e,n){return function(){return--e<1?n.apply(this,arguments):void 0}},y.before=function(e,n){var t;return function(){return--e>0&&(t=n.apply(this,arguments)),1>=e&&(n=null),t}},y.once=y.partial(y.before,2);var M=!{toString:null}.propertyIsEnumerable("toString"),I=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];y.keys=function(e){if(!y.isObject(e))return[];if(m)return m(e);var n=[];for(var t in e)y.has(e,t)&&n.push(t);return M&&r(e,n),n},y.allKeys=function(e){if(!y.isObject(e))return[];var n=[];for(var t in e)n.push(t);return M&&r(e,n),n},y.values=function(e){for(var n=y.keys(e),t=n.length,r=Array(t),a=0;t>a;a++)r[a]=e[n[a]];return r},y.mapObject=function(e,n,t){n=S(n,t);for(var r,a=y.keys(e),o=a.length,i={},c=0;o>c;c++)r=a[c],i[r]=n(e[r],r,e);return i},y.pairs=function(e){for(var n=y.keys(e),t=n.length,r=Array(t),a=0;t>a;a++)r[a]=[n[a],e[n[a]]];return r},y.invert=function(e){for(var n={},t=y.keys(e),r=0,a=t.length;a>r;r++)n[e[t[r]]]=t[r];return n},y.functions=y.methods=function(e){var n=[];for(var t in e)y.isFunction(e[t])&&n.push(t);return n.sort()},y.extend=$(y.allKeys),y.extendOwn=y.assign=$(y.keys),y.findKey=function(e,n,t){n=S(n,t);for(var r,a=y.keys(e),o=0,i=a.length;i>o;o++)if(r=a[o],n(e[r],r,e))return r},y.pick=function(e,n,t){var r,a,o={},i=e;if(null==i)return o;y.isFunction(n)?(a=y.allKeys(i),r=b(n,t)):(a=x(arguments,!1,!1,1),r=function(e,n,t){return n in t},i=Object(i));for(var c=0,u=a.length;u>c;c++){var l=a[c],s=i[l];r(s,l,i)&&(o[l]=s)}return o},y.omit=function(e,n,t){if(y.isFunction(n))n=y.negate(n);else{var r=y.map(x(arguments,!1,!1,1),String);n=function(e,n){return!y.contains(r,n)}}return y.pick(e,n,t)},y.defaults=$(y.allKeys,!0),y.create=function(e,n){var t=C(e);return n&&y.extendOwn(t,n),t},y.clone=function(e){return y.isObject(e)?y.isArray(e)?e.slice():y.extend({},e):e},y.tap=function(e,n){return n(e),e},y.isMatch=function(e,n){var t=y.keys(n),r=t.length;if(null==e)return!r;for(var a=Object(e),o=0;r>o;o++){var i=t[o];if(n[i]!==a[i]||!(i in a))return!1}return!0};var P=function(e,n,t,r){if(e===n)return 0!==e||1/e===1/n;if(null==e||null==n)return e===n;e instanceof y&&(e=e._wrapped),n instanceof y&&(n=n._wrapped);var a=d.call(e);if(a!==d.call(n))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e==""+n;case"[object Number]":return+e!==+e?+n!==+n:0===+e?1/+e===1/n:+e===+n;case"[object Date]":case"[object Boolean]":return+e===+n}var o="[object Array]"===a;if(!o){if("object"!=typeof e||"object"!=typeof n)return!1;var i=e.constructor,c=n.constructor;if(i!==c&&!(y.isFunction(i)&&i instanceof i&&y.isFunction(c)&&c instanceof c)&&"constructor"in e&&"constructor"in n)return!1}t=t||[],r=r||[];for(var u=t.length;u--;)if(t[u]===e)return r[u]===n;if(t.push(e),r.push(n),o){if(u=e.length,u!==n.length)return!1;for(;u--;)if(!P(e[u],n[u],t,r))return!1}else{var l,s=y.keys(e);if(u=s.length,y.keys(n).length!==u)return!1;for(;u--;)if(l=s[u],!y.has(n,l)||!P(e[l],n[l],t,r))return!1}return t.pop(),r.pop(),!0};y.isEqual=function(e,n){return P(e,n)},y.isEmpty=function(e){return null==e||(T(e)&&(y.isArray(e)||y.isString(e)||y.isArguments(e))?0===e.length:0===y.keys(e).length)},y.isElement=function(e){return!(!e||1!==e.nodeType)},y.isArray=f||function(e){return"[object Array]"===d.call(e)},y.isObject=function(e){var n=typeof e;return"function"===n||"object"===n&&!!e},y.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){y["is"+e]=function(n){return d.call(n)==="[object "+e+"]"}}),y.isArguments(arguments)||(y.isArguments=function(e){return y.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(y.isFunction=function(e){return"function"==typeof e||!1}),y.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},y.isNaN=function(e){return y.isNumber(e)&&e!==+e},y.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===d.call(e)},y.isNull=function(e){return null===e},y.isUndefined=function(e){return void 0===e},y.has=function(e,n){return null!=e&&p.call(e,n)},y.noConflict=function(){return a._=o,this},y.identity=function(e){return e},y.constant=function(e){return function(){return e}},y.noop=function(){},y.property=w,y.propertyOf=function(e){return null==e?function(){}:function(n){return e[n]}},y.matcher=y.matches=function(e){return e=y.extendOwn({},e),function(n){return y.isMatch(n,e)}},y.times=function(e,n,t){var r=Array(Math.max(0,e));n=b(n,t,1);for(var a=0;e>a;a++)r[a]=n(a);return r},y.random=function(e,n){return null==n&&(n=e,e=0),e+Math.floor(Math.random()*(n-e+1))},y.now=Date.now||function(){return(new Date).getTime()};var O={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},N=y.invert(O),L=function(e){var n=function(n){return e[n]},t="(?:"+y.keys(e).join("|")+")",r=RegExp(t),a=RegExp(t,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(a,n):e}};y.escape=L(O),y.unescape=L(N),y.result=function(e,n,t){var r=null==e?void 0:e[n];return void 0===r&&(r=t),y.isFunction(r)?r.call(e):r};var q=0;y.uniqueId=function(e){var n=++q+"";return e?e+n:n},y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var j=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\u2028|\u2029/g,U=function(e){return"\\"+B[e]};y.template=function(e,n,t){!n&&t&&(n=t),n=y.defaults({},n,y.templateSettings);var r=RegExp([(n.escape||j).source,(n.interpolate||j).source,(n.evaluate||j).source].join("|")+"|$","g"),a=0,o="__p+='";e.replace(r,function(n,t,r,i,c){return o+=e.slice(a,c).replace(D,U),a=c+n.length,t?o+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":r?o+="'+\n((__t=("+r+"))==null?'':__t)+\n'":i&&(o+="';\n"+i+"\n__p+='"),n}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var i=new Function(n.variable||"obj","_",o)}catch(e){throw e.source=o,e}var c=function(e){return i.call(this,e,y)},u=n.variable||"obj";return c.source="function("+u+"){\n"+o+"}",c},y.chain=function(e){var n=y(e);return n._chain=!0,n};var F=function(e,n){return e._chain?y(n).chain():n};y.mixin=function(e){y.each(y.functions(e),function(n){var t=y[n]=e[n];y.prototype[n]=function(){var e=[this._wrapped];return l.apply(e,arguments),F(this,t.apply(y,e))}})},y.mixin(y),y.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var n=i[e];y.prototype[e]=function(){var t=this._wrapped;return n.apply(t,arguments),"shift"!==e&&"splice"!==e||0!==t.length||delete t[0],F(this,t)}}),y.each(["concat","join","slice"],function(e){var n=i[e];y.prototype[e]=function(){return F(this,n.apply(this._wrapped,arguments))}}),y.prototype.value=function(){return this._wrapped},y.prototype.valueOf=y.prototype.toJSON=y.prototype.value,y.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return y})}.call(this),app.directive("updateCart",["CartService",function(e){return{restrict:"A",require:"^form",scope:{cart:"=updateCart",params:"=?",error:"=?",onSubmit:"=?",onSuccess:"=?",onError:"=?"},link:function(n,t,r,a){t.bind("click",function(){n.onSubmit&&n.onSubmit(),n.error=null;var t=n.params||r.params;t=utils.mergeParams(t,null,null),e.update(n.cart,n.params).then(function(e){n.cart=e,n.onSuccess&&n.onSuccess(e)},function(e){n.error=e,n.onError&&n.onError(e)})})}}}]),app.directive("updateInvoice",["InvoiceService",function(e){return{restrict:"A",require:"^form",scope:{invoice:"=updateInvoice",params:"=?",error:"=?",onSubmit:"=?",onSuccess:"=?",onError:"=?"},link:function(n,t,r,a){t.bind("click",function(){n.onSubmit&&n.onSubmit(),n.error=null;var t=n.params||r.params;t=utils.mergeParams(t,null,null),e.update(n.invoice,n.params).then(function(e){n.invoice=e,n.onSuccess&&n.onSuccess(e)},function(e){n.error=e,n.onError&&n.onError(e)})})}}}]),app.directive("addToCart",["CartService","gettextCatalog",function(e,n){return{restrict:"A",require:"^form",scope:{product:"=addToCart",params:"=?",quantity:"=?",error:"=?",onSubmit:"=?",onSuccess:"=?",onError:"=?"},link:function(t,r,a,o){r.bind("click",function(){if(t.onSubmit&&t.onSubmit(),1==o.$invalid)return void t.$apply(function(){t.error={type:"bad_request",reference:"AWu1twY",code:"invalid_input",message:n.getString("There was a problem with some of the information you supplied. Please review for errors and try again."),status:400}});t.error=null;var r={product_id:t.product.product_id};t.quantity&&(r.quantity=t.quantity);var i=t.params||a.params;i=utils.mergeParams(i,null,null),e.addItem(r,t.params).then(function(e){t.item=e,t.onSuccess&&t.onSuccess(e)},function(e){t.error=e,t.onError&&t.onError(e)})})}}}]),app.directive("submitPayment",["CartService","InvoiceService","gettextCatalog",function(e,n,t){return{restrict:"A",require:"^form",scope:{paymentMethod:"=submitPayment",cart:"=?",invoice:"=?",params:"=?",error:"=?",onSubmit:"=?",onSuccess:"=?",onError:"=?",shippingIsBilling:"=?"},link:function(r,a,o,i){a.bind("click",function(){if(r.onSubmit&&r.onSubmit(),1==i.$invalid&&"paypal"!=r.paymentMethod.type)return r.$apply(function(){r.error={type:"bad_request",reference:"kI1ETNz",code:"invalid_input",message:t.getString("There was a problem with some of the information you supplied. Please review for errors and try again."),status:400}}),void(r.onError&&r.onError(error));a.prop("disabled",!0),r.error=null;var c=r.params||o.params;c=utils.mergeParams(c,null,"order"),r.cart&&(r.shippingIsBilling&&delete r.cart.customer.shipping_address,e.pay(r.cart,r.paymentMethod,c).then(function(e){r.onSuccess&&r.onSuccess(e),a.prop("disabled",null)},function(e){r.error=e,r.onError&&r.onError(e),a.prop("disabled",null)})),r.invoice&&n.pay(r.invoice,r.paymentMethod,c).then(function(e){r.onSuccess&&r.onSuccess(e),a.prop("disabled",null)},function(e){r.error=e,r.onError&&r.onError(e),a.prop("disabled",null)})})}}}]),app.directive("capturePayment",["CartService","InvoiceService","PaymentService","gettextCatalog",function(e,n,t,r){return{restrict:"A",require:"^form",scope:{paymentId:"=capturePayment",paymentMethod:"=?",sale:"=?",invoice:"=?",params:"=?",error:"=?",onSubmit:"=?",onSuccess:"=?",onError:"=?"},link:function(n,a,o,i){a.bind("click",function(){if(n.onSubmit&&n.onSubmit(),1==i.$invalid)return n.$apply(function(){n.error={type:"bad_request",reference:"eS9G9MA",code:"invalid_input",message:r.getString("There was a problem with some of the information you supplied. Please review for errors and try again."),status:400}}),void(n.onError&&n.onError(error));a.prop("disabled",!0),n.error=null;var c=n.params||o.params;c=utils.mergeParams(c,null,"order");var u=function(e,r,o){t.capture(e,r,o).then(function(e){n.onSuccess&&n.onSuccess(e),a.prop("disabled",null)},function(e){n.error=e,n.onError&&n.onError(e),a.prop("disabled",null)})};"cart"==o.saleType?e.update(n.sale).then(function(e){u(n.paymentId,n.paymentMethod,c)},function(e){n.error=e,n.onError&&n.onError(e),a.prop("disabled",null)}):u(n.paymentId,n.paymentMethod,c)})}}}]),app.directive("currencySelect",["CurrencyService","CartService","InvoiceService","ProductService","SettingsService","$timeout","$rootScope",function(e,n,t,r,a,o,i){return{restrict:"A",scope:{currency:"=selectCurrency",cart:"=?",invoice:"=?",products:"=?",params:"=?",onSuccess:"=?",onError:"=?",error:"=?"},link:function(n,t,c){var u=a.get();if(utils.hasProperty(c,"asDropdown")){var l=angular.element(t[0]);_.each(u.account.currencies,function(e){var t='<li><a class="pointer">'+e.name+"</a></li>";optionNg=angular.element(t),l.append(optionNg),optionNg.bind("click",function(t){n.error=null,o(function(){p(n,e.code,c)})})});var s=angular.element(t.parent().children()),d=s.find("span");d&&d.text(e.getCurrencyName()),i.$on("currencyChanged",function(n,r){var a=angular.element(t.parent().children()),o=a.find("span");o&&o.text(e.getCurrencyName())})}else{var l=angular.element(t[0]);_.each(u.account.currencies,function(n){var t='<option value="'+n.code+'"';n.code==e.getCurrency()&&(t+=" selected"),t+=">"+n.name+"</option>",l.append(t)}),t.bind("change",function(e){n.error=null;var r=angular.element(t[0]).val();o(function(){p(n,r,c)})}),i.$on("currencyChanged",function(e,n){l[0].value=n})}var p=function(n,t,a){var o=n.params||a.params;o=utils.mergeParams(o,null,null),e.setCurrency(t,n.params).then(function(e){if(e.cart){var a=null;n.cart&&(a=n.cart.customer),n.cart=e.cart,a&&(n.cart.customer=a)}if(e.invoice){var a=null;n.invoice&&(a=n.invoice.customer),n.invoice=e.invoice,a&&(n.invoice.customer=a)}if(n.products){utils.getQueryParameters(n.products.current_page_url);o.currency=t,r.getList(n.params).then(function(e){n.products=e},function(e){n.error=e,n.onError&&n.onError(e)})}if(n.product){utils.getQueryParameters(n.product.url);n.params.currency=t,r.get(n.product.product_id,n.params).then(function(e){n.product=e},function(e){n.error=e,n.onError&&n.onError(e)})}n.onSuccess&&n.onSuccess(t)},function(e){n.error=e,n.onError&&n.onError(e)})}}}}]),app.directive("languageSelect",["LanguageService","$timeout","$rootScope",function(e,n,t){return{restrict:"A",link:function(r,a,o){var i=e.getLanguages();if(utils.hasProperty(o,"asDropdown")){var c=angular.element(a[0]);_.each(i,function(t){var r='<li><a class="pointer">'+t.name+"</a></li>";optionNg=angular.element(r),c.append(optionNg),optionNg.bind("click",function(r){n(function(){e.setLanguage(t.code)})})});var u=angular.element(a.parent().children()),l=u.find("span");l&&l.text(e.getSelectedLanguage().name),t.$on("languageChanged",function(n,t){var r=angular.element(a.parent().children()),o=r.find("span");o&&o.text(e.getSelectedLanguage().name)})}else{var c=angular.element(a[0]);_.each(i,function(n){var t='<option value="'+n.code+'"';n.code==e.getSelectedLanguage().code&&(t+=" selected"),t+=">"+n.name+"</option>",c.append(t)}),a.bind("change",function(t){var r=angular.element(a[0]).val();n(function(){e.setLanguage(r)})}),t.$on("languageChanged",function(e,n){c[0].value=n})}}}}]),app.directive("shippingSelect",["CartService","InvoiceService","$timeout",function(e,n,t){return{restrict:"A",scope:{sale:"=?",shippingQuotes:"=?",params:"=?",onSuccess:"=?",onError:"=?",error:"=?"},link:function(r,a,o){r.$watch("shippingQuotes",function(e,n){if(e){var t=null;r.sale.shipping_item&&(t=r.sale.shipping_item.item_id);var o=angular.element(a[0]);o.html(""),_.each(r.shippingQuotes,function(e){var n='<option value="'+e.method_id+'"';e.method_id==t&&(n+=" selected"),n+=">"+e.description+" ("+e.formatted.price+")</option>",o.append(n)})}}),a.bind("change",function(i){r.error=null;var c=angular.element(a[0]).val(),u=r.params||o.params;u=utils.mergeParams(u,null,null),t(function(){var t={shipping_method_id:c};"cart"==o.saleType&&e.update(t,r.params).then(function(e){e.customer=r.sale.customer,r.sale=e,r.onSuccess&&r.onSuccess(selectedCurrency)},function(e){r.error=e,r.onError&&r.onError(e)}),"invoice"==o.saleType&&n.update(t,r.params).then(function(e){e.customer=r.sale.customer,r.sale=e,r.onSuccess&&r.onSuccess(selectedCurrency)},function(e){r.error=e,r.onError&&r.onError(e)})})})}}}]),app.directive("shippingRadio",["CartService","InvoiceService","$timeout",function(e,n,t){return{restrict:"A",scope:{sale:"=?",shippingQuotes:"=?",params:"=?",onSuccess:"=?",onError:"=?",error:"=?"},link:function(r,a,o){a.bind("change",function(a){r.error=null;var i=o.shippingRadio,c=r.params||o.params;c=utils.mergeParams(c,null,null),t(function(){var t={shipping_method_id:i};"cart"==o.saleType&&e.update(t,r.params).then(function(e){r.sale&&(e.customer=r.sale.customer),r.sale=e,r.onSuccess&&r.onSuccess(selectedCurrency)},function(e){r.error=e,r.onError&&r.onError(e)}),"invoice"==o.saleType&&n.update(t,r.params).then(function(e){r.sale&&(e.customer=r.sale.customer),r.sale=e,r.onSuccess&&r.onSuccess(selectedCurrency)},function(e){r.error=e,r.onError&&r.onError(e)})})})}}}]),app.directive("customerCountries",["GeoService","$timeout",function(e,n){return{restrict:"A",require:"ngModel",link:function(n,t,r,a){n.$watch(r.customerCountries,function(n,r){if(n){var o=angular.element(t[0]);o.html("");var i=e.getData().countries;i=_.filter(i,function(e){return n.indexOf(e.code)>-1}),o.append("<option></option>");var c=a.$viewValue||a.$modelValue,u=!1;_.each(i,function(e){var n='<option value="'+e.code+'"';e.code==c&&(n+=" selected",u=!0),n+=">"+e.name+"</option>",o.append(n)}),0==u&&a.$setViewValue(null)}})}}}]),app.directive("showErrors",["$timeout","SettingsService",function(e,n){return{restrict:"A",require:"^form",link:function(t,r,a,o){var i=function(){e(function(){var e=r[0].querySelector("[name]"),i=r[0].querySelector("label"),c=angular.element(r[0].querySelector(".error-block")),u=angular.element(e),l=angular.element(i),s=angular.element(c);r.removeClass("has-error"),s.addClass("hidden");var d=u.attr("name");t.$watch(a.showErrors,function(n,t){n&&e&&(e.required?l&&l.addClass("required"):l.removeClass("required"))});var p="blur";e&&("checkbox"!=e.type&&"radio"!=e.type||(p="change")),u.bind(p,function(){var e=n.get(),t=e.app.error_notifications||"moderate";"moderate"==t&&r.toggleClass("has-error",o[d].$invalid),"aggressive"==t&&(r.toggleClass("has-error",o[d].$invalid),s.toggleClass("hidden",!o[d].$invalid)),0==o[d].$invalid&&s.toggleClass("hidden",!0)}),t.$on("show-errors-check-validity",function(){o[d]&&(r.toggleClass("has-error",o[d].$invalid),s.toggleClass("hidden",!o[d].$invalid))})})};i(),a.refreshOnChange&&t.$watch(a.refreshOnChange,function(e,n){i()})}}}]),app.directive("conversion",["SettingsService","StorageService",function(e,n){return{restrict:"A",scope:{conversion:"@"},link:function(t,r,a,o){var i=function(){a.$observe("conversion",function(e){if(0==utils.isNullOrEmpty(e)){var t=n.get("conv");if(t!=e){var r=document.getElementsByTagName("head")[0],a=document.createElement("script");a.id="app_conversionload",a.type="text/javascript",a.src="analytics/conversion.js",a.setAttribute("data-order-id",e),null!=document.getElementById("app_conversionload")&&r.removeChild(document.getElementById("app_conversionload")),r.appendChild(a),n.set("conv",e,864e3)}}})},c=e.get();1!=c.config.development&&i()}}}]),app.directive("validateOnSubmit",function(){return{restrict:"A",require:"^form",link:function(e,n,t,r){n.bind("click",function(){e.$broadcast("show-errors-check-validity")})}}}),app.directive("validateExpMonth",function(){return{restrict:"A",require:"ngModel",link:function(e,n,t,r){r.$parsers.unshift(function(e){return 0==utils.isValidInteger(e)?void r.$setValidity("month",!1):e>12?void r.$setValidity("month",!1):e<1?void r.$setValidity("month",!1):(r.$setValidity("month",!0),e)})}}}),app.directive("validateExpYear",function(){return{restrict:"A",require:"ngModel",link:function(e,n,t,r){r.$parsers.unshift(function(e){return 0==utils.isValidInteger(e)?void r.$setValidity("year",!1):e.length>4?void r.$setValidity("year",!1):e.length<2?void r.$setValidity("year",!1):(r.$setValidity("year",!0),e)})}}}),app.directive("validateCvv",function(){return{restrict:"A",require:"ngModel",link:function(e,n,t,r){r.$parsers.unshift(function(e){var n,a=t.validateCvv;return a&&(n="3"==a.substring(0,1).toString()?4:3),0==utils.isValidInteger(e)?void r.$setValidity("cvv",!1):e.length<3?void r.$setValidity("cvv",!1):e.length>4?void r.$setValidity("cvv",!1):n&&e.length!=n?void r.$setValidity("cvv",!1):(r.$setValidity("cvv",!0),e)})}}}),app.directive("validateCard",function(){return{restrict:"A",require:"ngModel",link:function(e,n,t,r){r.$parsers.unshift(function(e){return e=utils.removeWhitespace(e),utils.isNullOrEmpty(e)?void r.$setValidity("card",!1):0==/^\d+$/.test(e)?void r.$setValidity("card",!1):e.length<14?void r.$setValidity("card",!1):e.length>19?void r.$setValidity("card",!1):0==utils.luhnCheck(e)?void r.$setValidity("card",!1):(r.$setValidity("card",!0),e)})}}}),app.directive("isValidInteger",function(){return{restrict:"A",require:"ngModel",link:function(e,n,t,r){r.$validators.characters=function(e,n){var r=e||n;return"true"==t.allowEmptyValue&&(""==r||null==r)||0!=utils.isValidInteger(r)&&(!(t.max&&r>t.max)&&(!(t.lessThan&&r>=t.lessThan)&&(!(t.min&&r<t.min)&&!(t.greaterThan&&r<=t.greaterThan))))}}}}),app.directive("isValidNumber",function(){return{restrict:"A",require:"ngModel",link:function(e,n,t,r){r.$validators.characters=function(e,n){var r=e||n;return"true"==t.allowEmptyValue&&(""==r||null==r)||0!=utils.isValidNumber(r)&&(!(t.max&&r>t.max)&&(!(t.lessThan&&r>=t.lessThan)&&(!(t.min&&r<t.min)&&!(t.greaterThan&&r<=t.greaterThan))))}}}}),app.directive("promoCode",["CartService","$timeout",function(e,n){return{restrict:"A",scope:{cart:"=?",params:"=?",error:"=?",onAdd:"=?",onRemove:"=?",onError:"=?"},link:function(t,r,a,o){var i=angular.element(r[0].querySelector(".ask-promo-code")),c=angular.element(r[0].querySelector(".supply-promo-code")),u=angular.element(r[0].querySelector(".applied-promo-code")),l=angular.element(r.find("input")),s=angular.element(r[0].querySelector(".apply-promo-code")),d=angular.element(r[0].querySelector(".remove-promo-code"));c.addClass("hidden"),u.addClass("hidden"),t.$watch("cart",function(e,n){e&&(e.promotion_code?(i.addClass("hidden"),u.removeClass("hidden")):u.addClass("hidden"))}),i.bind("click",function(){i.addClass("hidden"),c.removeClass("hidden"),n(function(){r.find("input")[0].focus()})}),s.bind("click",function(){var n=l.val();if(!utils.isNullOrEmpty(n)){t.error=null;var r={promotion_code:n},o=t.params||a.params;o=utils.mergeParams(o,null,null),e.update(r,t.params).then(function(e){t.cart=e,t.onAdd&&t.onAdd(e),c.addClass("hidden"),u.removeClass("hidden")},function(e){t.error=e,t.onError&&t.onError(e)})}}),d.bind("click",function(){l.val(""),t.error=null;var n={promotion_code:null},r=t.params||a.params;r=utils.mergeParams(r,null,null),e.update(n,t.params).then(function(e){t.cart=e,t.onRemove&&t.onRemove(e),i.removeClass("hidden"),
u.addClass("hidden")},function(e){t.error=e,t.onError&&t.onError(e)})}),l.bind("blur",function(){utils.isNullOrEmpty(l.val())&&(c.addClass("hidden"),u.addClass("hidden"),i.removeClass("hidden"),n(function(){t.error=null}))})}}}]),app.directive("customerSignin",["CartService","$timeout",function(e,n){return{restrict:"A",scope:{cart:"=",paymentMethod:"=?",options:"=?",params:"=?",error:"=?",onSigninSubmit:"=?",onSignoutSubmit:"=?",onSigninSuccess:"=?",onSignoutSuccess:"=?",onSigninError:"=?",onSignoutError:"=?"},link:function(t,r,a){var o=angular.element(r[0].querySelector(".ask-signin")),i=angular.element(r[0].querySelector(".show-signin")),c=angular.element(r[0].querySelector(".supply-signin")),u=angular.element(r[0].querySelector(".signin-username")),l=angular.element(r[0].querySelector(".signin-password")),s=angular.element(r[0].querySelector(".submit-signin")),d=angular.element(r[0].querySelector(".cancel-signin")),p=angular.element(r[0].querySelector(".signed-in")),f=angular.element(r[0].querySelector(".submit-signout")),m=function(){o.addClass("hidden"),c.addClass("hidden"),p.addClass("hidden")};r.addClass("hidden"),m(),t.$watchGroup(["options","cart"],function(e,n){var t=e[0],a=e[1];t&&t.customer_optional_fields&&t.customer_optional_fields.indexOf("username")>=0&&(m(),r.removeClass("hidden"),o.removeClass("hidden")),a&&a.customer&&(m(),a.customer.username?p.removeClass("hidden"):o.removeClass("hidden"))},!0),i.bind("click",function(){o.addClass("hidden"),c.removeClass("hidden"),n(function(){r.find("input")[0].focus()})}),l.bind("keydown",function(e){13==e.which&&g()}),u.bind("keydown",function(e){13==e.which&&g()}),s.bind("click",function(e){g()}),f.bind("click",function(){t.onSignoutSubmit&&t.onSignoutSubmit();var n=t.params||a.params;n=utils.mergeParams(n,null,"customer.payment_methods"),e.logout(t.params).then(function(e){t.cart=e,delete t.paymentMethod.payment_method_id,t.onSignoutSuccess&&t.onSignoutSuccess(e)},function(e){t.error=e,t.onSignoutError&&t.onSignoutError(e)})}),d.bind("click",function(){u.val(""),l.val(""),t.error=null,m(),o.removeClass("hidden")});var g=function(){var n=u.val(),r=l.val();if(!utils.isNullOrEmpty(n)&&!utils.isNullOrEmpty(r)){t.error=null,t.onSigninSubmit&&t.onSigninSubmit();var o={username:n,password:r},i=t.params||a.params;i=utils.mergeParams(i,null,"customer.payment_methods"),e.login(o,t.params).then(function(e){if(t.cart=e,u.val(""),l.val(""),e.customer.payment_methods.data.length>0&&t.paymentMethod){var n=_.findWhere(e.customer.payment_methods.data,{is_default:!0}).payment_method_id;t.paymentMethod.payment_method_id=n}t.onSigninSuccess&&t.onSigninSuccess(e)},function(e){t.error=e,t.onSigninError&&t.onSigninError(e)})}}}}}]),app.directive("createAccount",["CustomerService","$timeout",function(e,n){return{restrict:"A",scope:{customer:"=",options:"=?",params:"=?",error:"=?",onSubmit:"=?",onSuccess:"=?",onError:"=?"},link:function(n,t,r){var a=angular.element(t[0].querySelector(".supply-credentials")),o=angular.element(t[0].querySelector(".create-account-username")),i=angular.element(t[0].querySelector(".create-account-password")),c=angular.element(t[0].querySelector(".submit-create-account")),u=angular.element(t[0].querySelector(".account-created"));t.addClass("hidden"),u.addClass("hidden"),n.$watchGroup(["options","customer"],function(e,n){var r=e[0],a=e[1];r&&a&&r.customer_optional_fields&&r.customer_optional_fields.indexOf("username")>=0&&!a.username&&t.removeClass("hidden")}),i.bind("keydown",function(e){13==e.which&&l()}),o.bind("keydown",function(e){13==e.which&&l()}),c.bind("click",function(e){l()});var l=function(){var t=o.val(),c=i.val();if(!utils.isNullOrEmpty(t)&&!utils.isNullOrEmpty(c)){n.error=null,n.onSubmit&&n.onSubmit(),n.customer.username=t,n.customer.password=c;var l=n.params||r.params;l=utils.mergeParams(l,null,"customer.payment_methods"),e.createAccount(n.customer,n.params).then(function(e){n.customer=e,o.val(""),i.val(""),u.removeClass("hidden"),a.addClass("hidden"),n.onSuccess&&n.onSuccess(e)},function(e){n.error=e,n.onError&&n.onError(e)})}}}}}]),app.directive("selectStateProv",["GeoService","$timeout",function(e,n){return{restrict:"A",require:"ngModel",link:function(n,t,r,a){n.$watch(r.country,function(n,r){if(n){var o=e.getStatesProvs(n),i=angular.element(t[0]);i.html(""),i.append("<option></option>");var c=a.$viewValue||a.$modelValue,u=!1;_.each(o,function(e){var n='<option value="'+e.code+'"';c==e.code&&(n+=" selected",u=!0),n+=">"+e.name+"</option>",i.append(n)}),0==u&&a.$setViewValue(null)}})}}}]),app.directive("customerBackgroundSave",["CartService","$timeout",function(e,n){return{restrict:"A",scope:{cart:"=customerBackgroundSave",params:"=?",error:"=?"},link:function(t,r,a,o){var i=document.querySelectorAll(".customer-background-save");_.each(i,function(r){var o="blur";"SELECT"==r.nodeName&&(o="change");var i,c=angular.element(r);c.bind(o,function(){i&&n.cancel(i),i=n(function(){var n=angular.copy(t.cart);utils.undefinedToNull(n);var o=t.params||a.params;if(o=utils.mergeParams(o,null,null),t.cart){var i=r.getAttribute("ng-model");i=i.split("customer.")[1],t.cart.customer[i]=c.val(),e.update(n,t.params,!0).then(function(e){t.cart&&(e.customer=t.cart.customer),t.cart=e},function(e){t.error=e})}},25)})})}}}]),app.directive("creditCardImage",[function(){return{restrict:"A",link:function(e,n,t){e.$watch(t.creditCardImage,function(e){if(e){var t=e.replace(" ","").toLowerCase()+".png",r='<img src="images/'+t+'" />',a=angular.element(n);a.empty(),a.html(r)}})}}}]),app.directive("creditCards",["CartService",function(e){return{restrict:"A",link:function(e,n,t){e.$watch(t.creditCards,function(e){if(_.isArray(e)){var t="";_.each(e,function(e){var n=e.replace(" ","").toLowerCase()+".png";t+='<img src="images/'+n+'" title="'+e+'" />'});var r=angular.element(n);r.empty(),r.html(t)}})}}}]),app.directive("stateProvInput",["GeoService","$compile",function(e,n){return{restrict:"E",terminal:!0,link:function(t,r,a){a.$observe("country",function(o){if(o){var i=e.getStatesProvs(a.country);if("select"==a.type){var c=r[0].querySelector("select").outerHTML;if(null==i){c=c.replace("ng-model","suspend-model");var u=angular.element(c);r.empty(),r.append(u),n(u)(t)}else{c=c.replace("suspend-model","ng-model");var u=angular.element(c);r.empty(),r.append(u),n(u)(t)}}if("input"==a.type){var c=r[0].querySelector("input").outerHTML;if(null!=i){c=c.replace("ng-model","suspend-model");var u=angular.element(c);r.empty(),r.append(u),n(u)(t)}else{c=c.replace("suspend-model","ng-model");var u=angular.element(c);r.empty(),r.append(u),n(u)(t)}}}})}}}]),app.directive("selectOnClick",function(){return{restrict:"A",link:function(e,n,t){n.on("click",function(){this.select()})}}}),app.directive("fields",["CartService","InvoiceService","$timeout","$rootScope","LanguageService",function(e,n,t,r,a){return{restrict:"AE",templateUrl:"app/templates/fields.html",scope:{fieldlist:"=",sale:"="},link:function(t,o,i,c){t.fields=[];var u=function(e){var n=[];if("string"==typeof e&&0==utils.isNullOrEmpty(e))try{n=JSON.parse(e)}catch(e){n=[],console.log("The JSON provided for custom fields is not valid JSON. As a result, no custom fields will display. Error message: "+e)}n=l(n);var t=a.getSelectedLanguage().code;return _.each(n,function(e){e.languages&&e.languages[t]&&(e.languages[t].label&&(e.label=e.languages[t].label),e.languages[t].description&&(e.description=e.languages[t].description),e.languages[t].section&&(e.section=e.languages[t].section),e.languages[t].options&&(e.options=e.languages[t].options))}),n},l=function(e){var n=[],t=[];return _.each(e,function(r){if(t.indexOf(r.section)==-1){var a=_.where(e,{section:r.section});a&&(n=n.concat(a),t.push(r.section))}}),n},s=function(e,n){for(var r in e)e.hasOwnProperty(r)&&null==t.sale.meta[e[r].name]&&(t.sale.meta[e[r].name]=e[r].default_value)};t.fields=u(t.fieldlist);var d=t.$watch("sale.meta",function(e,n){null!=t.sale&&(null==t.sale.meta&&(t.sale.meta={}),s(t.fields,t.sale.meta),d())},!0);r.$on("languageChanged",function(e,n){t.fields=u(t.fieldlist)}),t.pushToProperty=function(e,n,r){0==t.isInProperty(e,n)?null==t.sale.meta[e]?(t.sale.meta[e]=[],t.sale.meta[e].push(n)):t.sale.meta[e].push(n):t.sale.meta[e]=_.without(t.sale.meta[e],n),r&&t.record()},t.isInProperty=function(e,n){return null!=t.sale&&(null!=t.sale.meta&&(null!=t.sale.meta[e]&&_.indexOf(t.sale.meta[e],n)>=0))},t.isNewSection=function(e,n){if(0==n)return!0;var r=t.fields[n-1];return null!=r&&r.section!=e.section},t.record=function(){var r={meta:t.sale.meta};"invoice"==t.sale.object?n.update(r):e.update(r)}}}}]),app.directive("validateField",["gettextCatalog","$timeout",function(e,n){return{restrict:"A",require:"ngModel",scope:{field:"=validateField",error:"=?"},link:function(n,t,r,a){var o=(n.error,n.field);utils.isNullOrEmpty(t[0].value)&&1==o.required&&(n.error=e.getString("Please provide a value.")),"boolean"==o.type&&1==o.required&&(n.error=e.getString("Please make a selection")),"toggle"==o.type&&1==o.required&&(n.error=e.getString("Please confirm")),a.$parsers.unshift(function(t){var r=null;if(null!=t||1==o.required){switch(o.type){case"integer":utils.isValidInteger(t)||(r=e.getString("Please supply a number without decimals"));break;case"decimal":utils.isValidNumber(t)||(r=e.getString("Please supply a number"))}null!=o.options&&utils.isNullOrEmpty(t)&&(r=e.getString("Please make a selection")),null==r&&(null!=o.options&&null==_.where(o.options,{value:t})&&(r=e.getString("Please provide one of the available options")),"integer"!=o.type&&"decimal"!=o.type||(o.min_value&&t<o.min_value&&(r=e.getPlural(o.min_value,"The value you provide must be greater than {{$count}}","The value you provide must be greater than {{$count}}",{})),o.max_value&&t>o.max_value&&(r=e.getPlural(o.max_value,"The value you provide must be less than {{$count}}","The value you provide must be less than {{$count}}",{}))),"string"!=o.type&&"text"!=o.type||(o.min_length&&t.length<o.min_length&&(r=e.getPlural(o.min_length,"The value must be at least one character","The value must be at least {{$count}} characters",{})),o.max_length&&t.length>o.max_length&&(r=e.getPlural(o.max_length,"The value must be less than one character","The value must be less than {{$count}} characters",{}))))}return null!=r?(a.$setValidity("field",!1),void(n.error=r)):(a.$setValidity("field",!0),t)})}}}]),app.factory("appCache",["$cacheFactory",function(e){return e("appCache")}]),app.filter("range",function(){return function(e,n,t,r){function r(e,n){var t=String(e);return t.length<n&&(t=utils.repeat(0,n-e.toString().length)+t),t}n=parseInt(n),t=parseInt(t);for(var a=n;a<=t;a++)r?e.push(r(a,t.toString().length)):e.push(a);return e}}),app.service("ApiService",["$http","$q","$location","SettingsService","HelperService","StorageService","$rootScope","gettextCatalog",function(e,n,t,r,a,o,i,c){function u(e){var n=360;return null!=e&&0==isNaN(e)&&(n=e/60),n-=10}function l(){var t=n.defer(),a=o.get("token");if(null!=a)return t.resolve(a),t.promise;var i={},c=r.get();c.account.account_id&&1==c.config.development&&(i={account_id:c.account.account_id});var u=g("/auths/limited",c),l=e({ignoreLoadingBar:!1,method:"post",url:u+"?timezone=UTC",params:i,timeout:15e3,headers:{"Content-Type":"application/json"}});return l.then(function(e){o.set("token",e.data.token,e.headers("X-Token-Expires-In-Seconds")),o.remove("cart_id"),o.remove("invoice_id"),t.resolve(e.data.token)},function(e){t.reject({type:"internal_server_error",reference:"6lnOOW1",code:"unspecified_error",message:"There was a problem obtaining authorization for this session. Please reload the page to try your request again.",status:e.status})}),t.promise}function s(t,a,o,i){var c=n.defer();return l().then(function(n){null==t&&(t=void 0);var u=r.get(),l=g(a,u),s=e({ignoreLoadingBar:i,method:"post",data:angular.toJson(t),url:l+"?timezone=UTC",params:o,timeout:65e3,headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"}});s.then(function(e){v(e,c)},function(e){y(e,c)})},function(e){c.reject(e)}),c.promise}function d(t,a,o){var i=n.defer();return l().then(function(n){var c=r.get(),u=g(t,c),l=e({ignoreLoadingBar:o,method:"get",url:u+"?timezone=UTC",params:a,timeout:15e3,headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"}});l.then(function(e){v(e,i)},function(e){y(e,i)})},function(e){i.reject(e)}),i.promise}function p(t,a,o){var i=n.defer();return l().then(function(n){var c=r.get(),u=g(t,c),l=utils.getQueryParameters(t);_.each(a,function(e,n){null!=l[n]&&delete l[n]}),t.indexOf("?")>0&&(t=t.substring(0,t.indexOf("?"))),t=utils.appendParams(t,l);var s=e({ignoreLoadingBar:o,method:"get",url:u,params:a,timeout:25e3,headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"}});s.then(function(e){v(e,i)},function(e){y(e,i)})},function(e){i.reject(e)}),i.promise}function f(t,a,o,i){var c=n.defer();return l().then(function(n){var u=r.get(),l=g(a,u);null==t&&(t=void 0);var s=e({ignoreLoadingBar:i,method:"post",data:angular.toJson(h(t)),url:l+"?timezone=UTC",params:o,timeout:25e3,headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"}});s.then(function(e){v(e,c)},function(e){y(e,c)})},function(e){c.reject(e)}),c.promise}function m(t,a,o){var i=n.defer();return l().then(function(n){var c=r.get(),u=g(t,c),l=e({ignoreLoadingBar:o,method:"delete",url:u+"?timezone=UTC",params:a,timeout:15e3,headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"}});l.then(function(e){v(e,i)},function(e){y(e,i)})},function(e){i.reject(e)}),i.promise}function g(e,n){return"http://"==e.substring(0,7)||"https://"==e.substring(0,8)?e:n.config.apiPrefix+e}function h(e){if(null!=e&&"object"==typeof e){var n=JSON.parse(JSON.stringify(e));"cart"==n.object&&(delete n.options,delete n.shipping_item,delete n.payments,_.each(n.items,function(e){delete e.subscription_terms,delete e.url,delete e.date_created,delete e.date_modified,delete e.formatted,delete e.product,delete e.subscription_plan}),delete n.customer.url,delete n.customer.payments,delete n.customer.refunds,delete n.customer.orders,delete n.customer.subscriptions,delete n.customer.invoices,delete n.promotion),delete n.date_created,delete n.date_modified,delete n.object,delete n.url,delete n.test,delete n.account_id,delete n.formatted}return n}function v(e,n){return o.get("token")&&o.set("token",o.get("token"),e.headers("X-Token-Expires-In-Seconds")),n.resolve(e)}function y(e,n){var t={};e.data&&e.data.error&&(t=e.data.error);var r,o,i,u;if(t&&(t.type&&(r=t.type),t.code&&(i=t.code),t.reference&&(o=t.reference),t.message&&(u=t.message)),401==e.status&&"invalid_login"!=i&&"account_locked"!=i&&a.newSessionRedirect(!0,"Performing session reset due to invalid token in the cookie / request."),403==e.status&&(u="There was a problem establishing your session. Please reload the page to try again."),!u)switch(e.status){case 404:r="not_found",o="4jnJPb7",i="resource_not_found",u=c.getString("The item you are trying to access could not be found.");break;default:r="internal_server_error",o="XEnf9FY",i="unspecified_error",u=c.getString("An error occured while attempting to process your request. Please try your request again. If the problem persists, please contact support.")}t.type=r,t.reference=o,t.code=i,t.message=u,t.status=e.status,n.reject(t)}return{create:s,getItem:d,getList:p,update:f,remove:m,getToken:l,getTokenExpiration:u}}]),app.service("CartService",["$http","$q","$rootScope","ApiService","PaymentService","SettingsService","HelperService","StorageService",function(e,n,t,r,a,o,i,c){function u(e,t,a){var o=n.defer();t=y(t);var i=c.get("currency");i&&(e.currency=i);var u="/carts";return r.create(e,u,t,a).then(function(e){var n=e.data;c.set("cart_id",n.cart_id,e.headers("X-Token-Expires-In-Seconds")),v(n.currency),o.resolve(n)},function(e){o.reject(e)}),o.promise}function l(e,t){var a=n.defer();e=y(e);var o=c.get("cart_id"),u={billing_address:{},shipping_address:{}},l={items:[],customer:u};if(o){var s="/carts/"+o;r.getItem(s,e,t).then(function(e){var n=e.data;null==n.customer&&(n.customer=u),null==n.customer.billing_address.country&&(n.customer.billing_address.country=n.customer_ip_country),null==n.customer.shipping_address.country&&(n.customer.shipping_address.country=n.customer_ip_country),v(n.currency),a.resolve(n)},function(e){404==e.status&&i.newSessionRedirect(!0,"Performing a session reset due to an invalid cart_id in the cookie / request. (404 - cart not found)"),a.reject(e)})}else a.resolve(l);return a.promise}function s(e,t,a){var o=n.defer();t=y(t);var l=c.get("cart_id");if(l){var s="/carts/"+l;return r.update(e,s,t,a).then(function(e){var n=e.data;c.set("cart_id",n.cart_id,e.headers("X-Token-Expires-In-Seconds")),v(n.currency),o.resolve(n)},function(e){404==e.status&&i.newSessionRedirect(!0,"Performing a session reset due to an invalid cart_id in the cookie / request. (404 - cart not found)"),"invalid_state"==e.code&&(c.remove("cart_id"),i.newSessionRedirect(!1,"Performing a cart_id reset due to an invalid cart_id in the cookie / request. (422 - invalid state): "+e.message)),o.reject(e)}),o.promise}return u(e,t,a)}function d(e,t,a){var o=n.defer();t=y(t);var u=c.get("cart_id"),l="/carts/"+u+"/login";return r.update(e,l,t,a).then(function(e){var n=e.data;c.set("cart_id",n.cart_id,e.headers("X-Token-Expires-In-Seconds")),v(n.currency),o.resolve(n)},function(e){404==e.status&&i.newSessionRedirect(!0,"Performing a session reset due to an invalid cart_id in the cookie / request. (404 - cart not found)"),o.reject(e)}),o.promise}function p(e,t){var a=n.defer();e=y(e);var o=c.get("cart_id"),u="/carts/"+o+"/logout";return r.update(null,u,e,t).then(function(e){var n=e.data;c.set("cart_id",n.cart_id,e.headers("X-Token-Expires-In-Seconds")),v(n.currency),a.resolve(n)},function(e){404==e.status&&i.newSessionRedirect(!0,"Performing a session reset due to an invalid cart_id in the cookie / request. (404 - cart not found)"),a.reject(e)}),a.promise}function f(e,t,a){var o=n.defer();return null==e?(o.reject({type:"bad_request",reference:"vbVcrcF",code:"invalid_input",message:"You must supply an item to add to the cart.",status:400}),o.promise):(t=y(t),l(t).then(function(n){if(n.url){var i=_.findWhere(n.items,e);null!=i?r.update(e,i.url,t,a).then(function(e){var n=e.data;v(n.currency),o.resolve(n)},function(e){o.reject(e)}):r.create(e,n.url+"/items",t,a).then(function(e){var n=e.data;v(n.currency),o.resolve(n)},function(e){o.reject(e)})}else n.items.push(e),u(n,t,a).then(function(n){o.resolve(_.findWhere(n.items,{item_id:e.product_id}))},function(e){o.reject(e)})},function(e){o.reject(e)}),o.promise)}function m(e,n){return l(e,n).then(function(e){v(e.currency),deferred.resolve(e.items)},function(e){deferred.reject(e)}),deferred.promise}function g(e,t,r,o){var i=n.defer();r=y(r);var l=function(n,t){var u="/carts/"+e.cart_id+"/payments";a.create(t,u,r,o).then(function(e){("completed"==e.status||"pending"==e.status&&"credit_card"==e.payment_method.type)&&c.remove("cart_id"),i.resolve(e)},function(e){i.reject(e)})};return null==e.cart_id?u(e,r,o).then(function(e){l(e.cart_id,t)},function(e){i.reject(e)}):s(e,r,o).then(function(e){l(e.cart_id,t)},function(e){i.reject(e)}),i.promise}function h(e,n){var t=n.search();utils.stringToBool(t.empty_cart)&&(e.items=[],n.search("empty_cart",null));for(var r in t)if(t.hasOwnProperty(r)&&"product_id:"==utils.left(r,11)){var a={product_id:r.substring(11)};0==utils.isValidInteger(t[r])?a.quantity=1:a.quantity=t[r];var o=_.find(e.items,function(e){return e.product_id==a.product_id});null!=o&&(e.items=_.reject(e.items,function(e){return e.product_id==a.product_id})),e.items.push(a),n.search(r,null)}t.promotion_code&&(e.promotion_code=t.promotion_code,n.search("promotion_code",null)),t.currency&&(e.currency=t.currency,n.search("currency",null)),t.name&&(e.customer.name=t.name,n.search("name",null)),t.email&&(utils.isValidEmail(t.email)&&(e.customer.email=t.email),n.search("email",null)),t.referrer&&(e.referrer=t.referrer,n.search("referrer",null)),t.affiliate_id&&(e.affiliate_id=t.affiliate_id,n.search("affiliate_id",null)),0==_.size(e.customer)&&delete e.customer;var t=n.search();for(var r in t)t.hasOwnProperty(r)&&(null==e.meta&&(e.meta={}),e.meta[r]=t[r]);return e}function v(e){var n=c.get("currency");e!=n&&(c.set("currency",e),t.$emit("currencyChanged",e))}function y(e,n){var t=angular.copy(e);return t?(t.formatted=!0,delete t.show,t):{formatted:!0,options:!0}}return{create:u,get:l,update:s,addItem:f,getItems:m,pay:g,login:d,logout:p,fromParams:h}}]),app.service("InvoiceService",["$http","$q","$rootScope","ApiService","PaymentService","SettingsService","HelperService","StorageService",function(e,n,t,r,a,o,i,c){function u(e,t){var a=n.defer();e=p(e);var o=c.get("invoice_id"),u="/invoices/"+o;return r.getItem(u,e,t).then(function(e){var n=e.data;d(n.currency),a.resolve(n)},function(e){404==e.status&&i.newSessionRedirect(!0,"Performing a session reset due to an invalid invoice_id in the cookie / request. (404 - invoice not found)"),a.reject(e)}),a.promise}function l(e,t,a){var o=n.defer();t=p(t);var u=c.get("invoice_id"),l="/invoices/"+u;return r.update(e,l,t,a).then(function(e){var n=e.data;c.set("invoice_id",n.invoice_id,e.headers("X-Token-Expires-In-Seconds")),d(n.currency),o.resolve(n)},function(e){404==e.status&&i.newSessionRedirect(!0,"Performing a session reset due to an invalid invoice_id in the cookie / request. (404 - invoice not found)"),o.reject(e)}),o.promise}function s(e,t,r,o){var i=n.defer();r=p(r);var c=function(n,t){var c="/invoices/"+e.invoice_id+"/payments";a.create(t,c,r,o).then(function(e){i.resolve(e)},function(e){i.reject(e)})};return c(e.invoice_id,t),i.promise}function d(e){var n=c.get("currency");e!=n&&(c.set("currency",e),t.$emit("currencyChanged",e))}function p(e,n){var t=angular.copy(e);return t?(t.formatted=!0,delete t.show,t):{formatted:!0,options:!0}}return{get:u,update:l,pay:s}}]),app.service("PaymentService",["$http","$q","ApiService","SettingsService","StorageService",function(e,n,t,r,a){function o(e,r,a,o){var i=n.defer();a=u(a);var c={payment_method:e};return t.create(c,r,a,o).then(function(e){var n=e.data;i.resolve(n)},function(e){i.reject(e)}),i.promise}function i(e,r,a){var o=n.defer();if(r=u(r),e){var i="/payments/"+e;t.getItem(i,r,a).then(function(e){var n=e.data;o.resolve(n)},function(e){o.reject(e)})}else o.reject({type:"bad_request",reference:"HdPWrih",code:"invalid_input",message:"You request contained invalid data and could not be processed.",status:400}),console.log("Your request for a payment must include a payment_id.");return o.promise}function c(e,r,o,i){var c="/payments/"+e+"/capture",l=n.defer();return o=u(o),t.create(r,c,o,i).then(function(e){var n=e.data;("completed"==n.status||"pending"==n.status&&"credit_card"==n.payment_method.type)&&(a.remove("cart_id"),a.remove("invoice_id")),l.resolve(n)},function(e){l.reject(e)}),l.promise}function u(e,n){return e?(e.formatted=!0,null==e.expand?e.expand="response_data,payment_method":("-1"==e.expand.indexOf("response_data")&&(e.expand+=",response_data"),"-1"==e.expand.indexOf("payment_method")&&(e.expand+=",payment_method")),e):{formatted:!0,expand:"response_data,payment_method"}}return{create:o,get:i,capture:c}}]),app.service("OrderService",["$http","$q","ApiService",function(e,n,t){function r(e,r,o){var i=n.defer();if(r=a(r),e){var c="/orders/"+e;t.getItem(c,r,o).then(function(e){var n=e.data;i.resolve(n)},function(e){i.reject(e)})}else i.reject({type:"bad_request",reference:"HdPWrih",code:"invalid_input",message:"The order you are trying to view cannot be found.",status:400}),console.log("The order_id was not provided.");return i.promise}function a(e,n){return e?(e.formatted=!0,e):{formatted:!0}}return{get:r}}]),app.service("CustomerService",["$http","$q","ApiService",function(e,n,t){function r(e,r,a){var o=n.defer();if(e.customer_id){var i="/customers/"+e.customer_id;t.update(e,i,r,a).then(function(e){o.resolve(e.data)},function(e){o.reject(e)})}else o.reject({type:"bad_request",reference:"8b1oMYs",code:"invalid_input",message:"The request could not be completed.",status:400}),console.log("The customer object in the account creation request did not contain a customer_id.");return o.promise}return{createAccount:r}}]),app.service("ProductService",["$http","$q","ApiService","CurrencyService",function(e,n,t,r){function a(e,a,o){var c=n.defer();if(a=i(a),e){var u="/products/"+e;t.getItem(u,a,o).then(function(e){var n=e.data;null==r.getCurrency()&&r.setCurrency(n.currency),c.resolve(n)},function(e){c.reject(e)})}else c.reject({type:"bad_request",reference:"IrUQTRv",code:"invalid_input",message:"The product you are trying to view cannot be found.",status:400}),console.log("The product_id was not provided.");return c.promise}function o(e,a){var o=n.defer();e=i(e);var c="/products";return t.getList(c,e,a).then(function(e){var n=e.data;null==r.getCurrency()&&n.data[0]&&r.setCurrency(n.data[0].currency),o.resolve(n)},function(e){o.reject(e)}),o.promise}function i(e,n){return e?(e.formatted=!0,e):{formatted:!0}}return{get:a,getList:o}}]),app.service("GeoService",[function(){function e(){var e={};return e.countries=[{name:"Afghanistan",code:"AF"},{name:"Albania",code:"AL"},{name:"Algeria",code:"DZ"},{name:"American Samoa",code:"AS"},{name:"Andorra",code:"AD"},{name:"Angola",code:"AO"},{name:"Anguilla",code:"AI"},{name:"Antarctica",code:"AQ"},{name:"Antigua and Barbuda",code:"AG"},{name:"Argentina",code:"AR"},{name:"Armenia",code:"AM"},{name:"Aruba",code:"AW"},{name:"Australia",code:"AU"},{name:"Austria",code:"AT"},{name:"Azerbaijan",code:"AZ"},{name:"Bahamas",code:"BS"},{name:"Bahrain",code:"BH"},{name:"Bangladesh",code:"BD"},{name:"Barbados",code:"BB"},{name:"Belarus",code:"BY"},{name:"Belgium",code:"BE"},{name:"Belize",code:"BZ"},{name:"Benin",code:"BJ"},{name:"Bermuda",code:"BM"},{name:"Bhutan",code:"BT"},{name:"Bolivia, Plurinational State of",code:"BO"},{name:"Bonaire, Sint Eustatius and Saba",code:"BQ"},{name:"Bosnia and Herzegovina",code:"BA"},{name:"Botswana",code:"BW"},{name:"Bouvet Island",code:"BV"},{name:"Brazil",code:"BR"},{name:"British Indian Ocean Territory",code:"IO"},{name:"Brunei Darussalam",code:"BN"},{name:"Bulgaria",code:"BG"},{name:"Burkina Faso",code:"BF"},{name:"Burundi",code:"BI"},{name:"Cambodia",code:"KH"},{name:"Cameroon",code:"CM"},{name:"Canada",code:"CA"},{name:"Cape Verde",code:"CV"},{name:"Cayman Islands",code:"KY"},{name:"Central African Republic",code:"CF"},{name:"Chad",code:"TD"},{name:"Chile",code:"CL"},{name:"China",code:"CN"},{name:"Christmas Island",code:"CX"},{name:"Cocos (Keeling) Islands",code:"CC"},{name:"Colombia",code:"CO"},{name:"Comoros",code:"KM"},{name:"Congo",code:"CG"},{name:"Congo, the Democratic Republic of the",code:"CD"},{name:"Cook Islands",code:"CK"},{name:"Costa Rica",code:"CR"},{name:"Cote d Ivoire",code:"CI"},{name:"Croatia",code:"HR"},{name:"Cuba",code:"CU"},{name:"Curacao",code:"CW"},{name:"Cyprus",code:"CY"},{name:"Czech Republic",code:"CZ"},{name:"Denmark",code:"DK"},{name:"Djibouti",code:"DJ"},{name:"Dominica",code:"DM"},{name:"Dominican Republic",code:"DO"},{name:"Ecuador",code:"EC"},{name:"Egypt",code:"EG"},{name:"El Salvador",code:"SV"},{name:"Equatorial Guinea",code:"GQ"},{name:"Eritrea",code:"ER"},{name:"Estonia",code:"EE"},{name:"Ethiopia",code:"ET"},{name:"Falkland Islands",code:"AX"},{name:"Falkland Islands (Malvinas)",code:"FK"},{name:"Faroe Islands",code:"FO"},{name:"Fiji",code:"FJ"},{name:"Finland",code:"FI"},{name:"France",code:"FR"},{name:"French Guiana",code:"GF"},{name:"French Polynesia",code:"PF"},{name:"French Southern Territories",code:"TF"},{name:"Gabon",code:"GA"},{name:"Gambia",code:"GM"},{name:"Georgia",code:"GE"},{name:"Germany",code:"DE"},{name:"Ghana",code:"GH"},{name:"Gibraltar",code:"GI"},{name:"Greece",code:"GR"},{name:"Greenland",code:"GL"},{name:"Grenada",code:"GD"},{name:"Guadeloupe",code:"GP"},{name:"Guam",code:"GU"},{name:"Guatemala",code:"GT"},{name:"Guernsey",code:"GG"},{name:"Guinea",code:"GN"},{name:"Guine Bissau",code:"GW"},{name:"Guyana",code:"GY"},{name:"Haiti",code:"HT"},{name:"Heard Island and McDonald Islands",code:"HM"},{name:"Holy See (Vatican City State)",code:"VA"},{name:"Honduras",code:"HN"},{name:"Hong Kong",code:"HK"},{name:"Hungary",code:"HU"},{name:"Iceland",code:"IS"},{name:"India",code:"IN"},{name:"Indonesia",code:"ID"},{name:"Iran",code:"IR"},{name:"Iraq",code:"IQ"},{name:"Ireland",code:"IE"},{name:"Isle of Man",code:"IM"},{name:"Israel",code:"IL"},{name:"Italy",code:"IT"},{name:"Jamaica",code:"JM"},{name:"Japan",code:"JP"},{name:"Jersey",code:"JE"},{name:"Jordan",code:"JO"},{name:"Kazakhstan",code:"KZ"},{name:"Kenya",code:"KE"},{name:"Kiribati",code:"KI"},{name:"Korea",code:"KR"},{name:"Kuwait",code:"KW"},{name:"Kyrgyzstan",code:"KG"},{name:"Lao Peoples Democratic Republic",code:"LA"},{name:"Latvia",code:"LV"},{name:"Lebanon",code:"LB"},{name:"Lesotho",code:"LS"},{name:"Liberia",code:"LR"},{name:"Libya",code:"LY"},{name:"Liechtenstein",code:"LI"},{name:"Lithuania",code:"LT"},{name:"Luxembourg",code:"LU"},{name:"Macao",code:"MO"},{name:"Macedonia",code:"MK"},{name:"Madagascar",code:"MG"},{name:"Malawi",code:"MW"},{name:"Malaysia",code:"MY"},{name:"Maldives",code:"MV"},{name:"Mali",code:"ML"},{name:"Malta",code:"MT"},{name:"Marshall Islands",code:"MH"},{name:"Martinique",code:"MQ"},{name:"Mauritania",code:"MR"},{name:"Mauritius",code:"MU"},{name:"Mayotte",code:"YT"},{name:"Mexico",code:"MX"},{name:"Micronesia",code:"FM"},{name:"Moldova",code:"MD"},{name:"Monaco",code:"MC"},{name:"Mongolia",code:"MN"},{name:"Montenegro",code:"ME"},{name:"Montserrat",code:"MS"},{name:"Morocco",code:"MA"},{name:"Mozambique",code:"MZ"},{name:"Myanmar",code:"MM"},{name:"Namibia",code:"NA"},{name:"Nauru",code:"NR"},{name:"Nepal",code:"NP"},{name:"Netherlands",code:"NL"},{name:"New Caledonia",code:"NC"},{name:"New Zealand",code:"NZ"},{name:"Nicaragua",code:"NI"},{name:"Niger",code:"NE"},{name:"Nigeria",code:"NG"},{name:"Niue",code:"NU"},{name:"Norfolk Island",code:"NF"},{name:"Northern Mariana Islands",code:"MP"},{name:"Norway",code:"NO"},{name:"Oman",code:"OM"},{name:"Pakistan",code:"PK"},{name:"Palau",code:"PW"},{name:"Panama",code:"PA"},{name:"Papua New Guinea",code:"PG"},{name:"Paraguay",code:"PY"},{name:"Peru",code:"PE"},{name:"Philippines",code:"PH"},{name:"Pitcairn",code:"PN"},{name:"Poland",code:"PL"},{name:"Portugal",code:"PT"},{name:"Puerto Rico",code:"PR"},{name:"Qatar",code:"QA"},{name:"Reunion",code:"RE"},{name:"Romania",code:"RO"},{name:"Russian Federation",code:"RU"},{name:"Rwanda",code:"RW"},{name:"Saint Barthlemy",code:"BL"},{name:"Saint Helena",code:"SH"},{name:"Saint Kitts and Nevis",code:"KN"},{name:"Saint Lucia",code:"LC"},{name:"Saint Martin French",code:"MF"},{name:"Saint Pierre and Miquelon",code:"PM"},{name:"Saint Vincent and the Grenadines",code:"VC"},{name:"Samoa",code:"WS"},{name:"San Marino",code:"SM"},{name:"Sao Tome and Principe",code:"ST"},{name:"Saudi Arabia",code:"SA"},{name:"Senegal",code:"SN"},{name:"Serbia",code:"RS"},{name:"Seychelles",code:"SC"},{name:"Sierra Leone",code:"SL"},{name:"Singapore",code:"SG"},{name:"Sint Maarten Dutch",code:"SX"},{name:"Slovakia",code:"SK"},{name:"Slovenia",code:"SI"},{name:"Solomon Islands",code:"SB"},{name:"Somalia",code:"SO"},{name:"South Africa",code:"ZA"},{name:"South Sudan",code:"SS"},{name:"Spain",code:"ES"},{name:"Sri Lanka",code:"LK"},{name:"Sudan",code:"SD"},{name:"Suriname",code:"SR"},{name:"Svalbard and Jan Mayen",code:"SJ"},{name:"Swaziland",code:"SZ"},{name:"Sweden",code:"SE"},{name:"Switzerland",code:"CH"},{name:"Syrian Arab Republic",code:"SY"},{name:"Taiwan",code:"TW"},{name:"Tajikistan",code:"TJ"},{name:"Tanzania",code:"TZ"},{name:"Thailand",code:"TH"},{name:"Timor Leste",code:"TL"},{name:"Togo",code:"TG"},{name:"Tokelau",code:"TK"},{name:"Tonga",code:"TO"},{name:"Trinidad and Tobago",code:"TT"},{name:"Tunisia",code:"TN"},{name:"Turkey",code:"TR"},{name:"Turkmenistan",code:"TM"},{name:"Turks and Caicos Islands",
code:"TC"},{name:"Tuvalu",code:"TV"},{name:"Uganda",code:"UG"},{name:"Ukraine",code:"UA"},{name:"United Arab Emirates",code:"AE"},{name:"United Kingdom",code:"GB"},{name:"United States",code:"US"},{name:"United States Minor Outlying Islands",code:"UM"},{name:"Uruguay",code:"UY"},{name:"Uzbekistan",code:"UZ"},{name:"Vanuatu",code:"VU"},{name:"Venezuela",code:"VE"},{name:"Viet Nam",code:"VN"},{name:"Virgin Islands British",code:"VG"},{name:"Virgin Islands U.S.",code:"VI"},{name:"Wallis and Futuna",code:"WF"},{name:"Western Sahara",code:"EH"},{name:"Yemen",code:"YE"},{name:"Zambia",code:"ZM"},{name:"Zimbabwe",code:"ZW"}],e.usStates=[{name:"Alabama",code:"AL"},{name:"Alaska",code:"AK"},{name:"American Samoa",code:"AS"},{name:"Arizona",code:"AZ"},{name:"Arkansas",code:"AR"},{name:"California",code:"CA"},{name:"Colorado",code:"CO"},{name:"Connecticut",code:"CT"},{name:"Delaware",code:"DE"},{name:"District Of Columbia",code:"DC"},{name:"Federated States Of Micronesia",code:"FM"},{name:"Florida",code:"FL"},{name:"Georgia",code:"GA"},{name:"Guam",code:"GU"},{name:"Hawaii",code:"HI"},{name:"Idaho",code:"ID"},{name:"Illinois",code:"IL"},{name:"Indiana",code:"IN"},{name:"Iowa",code:"IA"},{name:"Kansas",code:"KS"},{name:"Kentucky",code:"KY"},{name:"Louisiana",code:"LA"},{name:"Maine",code:"ME"},{name:"Marshall Islands",code:"MH"},{name:"Maryland",code:"MD"},{name:"Massachusetts",code:"MA"},{name:"Michigan",code:"MI"},{name:"Minnesota",code:"MN"},{name:"Mississippi",code:"MS"},{name:"Missouri",code:"MO"},{name:"Montana",code:"MT"},{name:"Nebraska",code:"NE"},{name:"Nevada",code:"NV"},{name:"New Hampshire",code:"NH"},{name:"New Jersey",code:"NJ"},{name:"New Mexico",code:"NM"},{name:"New York",code:"NY"},{name:"North Carolina",code:"NC"},{name:"North Dakota",code:"ND"},{name:"Northern Mariana Islands",code:"MP"},{name:"Ohio",code:"OH"},{name:"Oklahoma",code:"OK"},{name:"Oregon",code:"OR"},{name:"Palau",code:"PW"},{name:"Pennsylvania",code:"PA"},{name:"Puerto Rico",code:"PR"},{name:"Rhode Island",code:"RI"},{name:"South Carolina",code:"SC"},{name:"South Dakota",code:"SD"},{name:"Tennessee",code:"TN"},{name:"Texas",code:"TX"},{name:"Utah",code:"UT"},{name:"Vermont",code:"VT"},{name:"Virgin Islands",code:"VI"},{name:"Virginia",code:"VA"},{name:"Washington",code:"WA"},{name:"West Virginia",code:"WV"},{name:"Wisconsin",code:"WI"},{name:"Wyoming",code:"WY"},{name:"U.S. Armed Forces Americas",code:"AA"},{name:"U.S. Armed Forces Europe",code:"AE"},{name:"U.S. Armed Forces Pacific",code:"AP"}],e.caProvinces=[{code:"AB",name:"Alberta"},{code:"BC",name:"British Columbia"},{code:"LB",name:"Labrador"},{code:"MB",name:"Manitoba"},{code:"NB",name:"New Brunswick"},{code:"NL",name:"Newfoundland"},{code:"NS",name:"Nova Scotia"},{code:"NU",name:"Nunavut"},{code:"NW",name:"Northwest Territories"},{code:"ON",name:"Ontario"},{code:"PE",name:"Prince Edward Island"},{code:"QC",name:"Quebec"},{code:"SK",name:"Saskatchewen"},{code:"YT",name:"Yukon"}],e}function n(n){var t=e();return"US"==n?t.usStates:"CA"==n?t.caProvinces:null}function t(e){var n=["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE","GB"];return n.indexOf(e)>-1}return{getData:e,getStatesProvs:n,isEu:t}}]),app.service("CurrencyService",["$q","$rootScope","SettingsService","CartService","InvoiceService","StorageService","ApiService",function(e,n,t,r,a,o,i){function c(){return o.get("currency")}function u(){var e=c(),n=t.get(),r=null;return _.each(n.account.currencies,function(n){n.code==e&&(r=n.name)}),r}function l(t,i){var c=e.defer();return o.get("cart_id")?r.update({currency:t},i).then(function(e){o.set("currency",t),n.$emit("currencyChanged",t),c.resolve({cart:e})},function(e){c.reject(e)}):o.get("invoice_id")?a.update({currency:t},i).then(function(e){o.set("currency",t),c.resolve({invoice:e})},function(e){c.reject(e)}):(o.set("currency",t),n.$emit("currencyChanged",t),c.resolve({})),c.promise}return{getCurrency:c,getCurrencyName:u,setCurrency:l}}]),app.service("LanguageService",["$q","$rootScope","SettingsService","StorageService","gettextCatalog","ApiService",function(e,n,t,r,a,o){function i(){return n.languages?n.languages:[{code:"en",name:"English"}]}function c(){var e=i(),n=r.get("language"),n=_.findWhere(e,{code:n});return n?n:{name:null,code:null}}function u(e){var n=i();return!(null==_.findWhere(n,{code:e}))}function l(e){0!=u(e)&&null!=e&&(r.set("language",e),a.setCurrentLanguage(e),n.$emit("languageChanged",e),"en"!=e&&a.loadRemote("languages/"+e+"/"+e+".json"))}function s(){var r=e.defer();if(!n.languages)return r.resolve("en"),r.promise;var a=c();if(a.code)r.resolve(a.code);else{t.get();o.getItem("/browser_info",null,!0).then(function(e){r.resolve(e.data.language)},function(e){r.resolve(null)})}return r.promise}function d(){s().then(function(e){null==e&&(e="en"),l(e)})}return{getSelectedLanguage:c,getLanguages:i,setLanguage:l,establishLanguage:d}}]),app.service("SettingsService",[function(e,n){function t(){var e=function(){var e={};window.__settings&&window.__settings.account&&(e=window.__settings.account),e.date_utc||(e.date_utc=utils.getCurrentIsoDate(!0));var n=new Date(e.date_utc);return e.year=n.getFullYear(),e.month=n.getMonth(),e.date=n.getDate(),e},n=function(){var e={};return window.__settings&&window.__settings.app&&(e=window.__settings.app),e},t={account:e(),app:n(),config:{}};return t.config.apiPrefix="/api/v1",t.config.development=!1,(t.account.development||t.app.development)&&(t.config.development=!0,t.config.apiPrefix="https://api.comecero.com"+t.config.apiPrefix),t}return{get:t}}]),app.service("HelperService",["SettingsService","StorageService","$location",function(e,n,t){function r(e,n,t){if(!e||!n)return!1;var r=!1;return"shipping_address."==e.substring(0,17)&&(e="billing_address."+e.substring(17),r=!0),"billing_address.name"==e&&(e="name"),t!==!0&&(!!n.customer_required_fields&&n.customer_required_fields.indexOf(e)>=0)}function a(e,n,t){if(!e||!n)return!1;var r=!1;return"shipping_address."==e.substring(0,17)&&(e="billing_address."+e.substring(17),r=!0),"billing_address.name"==e&&(e="name"),t!==!0&&(!!n.customer_optional_fields&&n.customer_optional_fields.indexOf(e)>=0)}function o(e,n,t){return!(!e||!n)&&(!(!n.customer_required_fields||!r(e,n,t))||!(!n.customer_optional_fields||!a(e,n,t)))}function i(e){return!(!e||(e.shipping_address,!e.shipping_address.address_1))}function c(r,a){console.log(a),r===!0&&(n.remove("cart_id"),n.remove("invoice_id"),n.remove("token"));var o=e.get().app;o.main_shopping_url?window.location.replace(o.main_shopping_url):"/"!=t.path()?(t.path("/"),t.replace()):window.location.reload()}function u(){var n=e.get().app;return null==n.main_shopping_url?window.location.href.substring(0,window.location.href.indexOf("#"))+"#/":n.main_shopping_url}function l(e){return null!=_.find(e,function(e){return null!=e.subscription_plan})}function s(e){return null!=_.find(e,function(e){return"physical"==e.type})}function d(e,n){return!(!e||!n)&&null!=_.find(n.payment_methods,function(n){return n.payment_method_type==e})}return{isRequiredCustomerField:r,isOptionalCustomerField:a,isCustomerField:o,hasShippingAddress:i,newSessionRedirect:c,getShoppingUrl:u,hasSubscription:l,hasPhysical:s,supportsPaymentMethod:d}}]),app.service("StorageService",["appCache",function(e){function n(n){var t=e.get(n);return null==t&&(t=utils.getCookie(n)),t}function t(n,t,r){e.put(n,t),null==r&&(r=1209600),utils.setCookie(n,t,r/60)}function r(n){e.remove(n),utils.deleteCookie(n)}return{get:n,set:t,remove:r}}]);