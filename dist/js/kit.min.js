var utils=function(){function e(e,n,t){if(t){var r=new Date;r.setTime(r.getTime()+60*t*1e3);var o="; expires="+r.toUTCString()}else var o="";document.cookie=e+"="+n+o+"; path=/"}function n(e){return document.cookie.length>0&&(c_start=document.cookie.indexOf(e+"="),c_start!=-1)?(c_start=c_start+e.length+1,c_end=document.cookie.indexOf(";",c_start),c_end==-1&&(c_end=document.cookie.length),unescape(document.cookie.substring(c_start,c_end))):null}function t(n){e(n,"",-60)}function r(t,r){var o=n(t);null!=o&&e(t,o,r)}function o(){return a(window.location.href)}function a(e){var n={};if(e.indexOf("#")==-1)return n;for(var t,r=/\+/g,o=/([^&;=]+)=?([^&;]*)/g,a=function(e){return decodeURIComponent(e.replace(r," "))},i=e.substring(e.indexOf("#")+1);t=o.exec(i);)n[a(t[1])]=a(t[2]);return n}function c(){return u(window.location.href)}function u(e){return e.indexOf("?")==-1?{}:(q=e.substring(e.indexOf("?")+1),q.indexOf("#")>0&&(q=q.substring(0,q.indexOf("#"))),s(q))}function s(e){var n={};if(b(e))return n;for(var t,r=/\+/g,o=/([^&;=]+)=?([^&;]*)/g,a=function(e){return decodeURIComponent(e.replace(r," "))},n={};t=o.exec(e);)n[a(t[1])]=a(t[2]);return n}function l(e,n){return 0==n.length?e:(e+="?",_.each(n,function(n,t){e+=t+"="+n+"&"}),e=e.substring(0,e.length-1))}function d(e,n){return n<=0?"":n>String(e).length?e:String(e).substring(0,n)}function p(e,n){if(n<=0)return"";if(n>String(e).length)return e;var t=String(e).length;return String(e).substring(t,t-n)}function f(e){return!isNaN(parseFloat(e))&&isFinite(e)}function m(e){if(0==f(e))return!1;e=parseFloat(e);var n=e===(0|parseInt(e));return n}function g(e){return/\S+@\S+\.\S+/.test(e)}function h(){return Math.floor(1e7*Math.random()+1)}function v(e,n){if(null!=e){var t=e.__proto__||e.constructor.prototype;return n in e&&(!(n in t)||t[n]!==e[n])}return!1}function y(e,n){var t=0;return _.each(e,function(e){v(e,n)&&(t+=e[n])}),t}function S(){for(var e=arguments.length,n=1;n<e;n++)if(null==arguments[n]||arguments[n]!=arguments[n-1])return!1;return!0}function b(e){return null==e||void 0==e||(""==e||null==$(e))}function w(e){for(var n in e)e.hasOwnProperty(n)&&("false"===e[n]&&(e[n]=!1),"true"===e[n]&&(e[n]=!0))}function C(e){return"true"==e}function $(e){return e.replace(/ /g,"")}function k(e,n){return Math.round(e*n*100)/100}function E(e){var n=0,t=0,r=!1;e=e.replace(/\D/g,"");for(var o=e.length-1;o>=0;o--){var a=e.charAt(o),t=parseInt(a,10);r&&(t*=2)>9&&(t-=9),n+=t,r=!r}return n%10==0}function T(e){for(var n in e)if(e.hasOwnProperty(n)){if("[object Object]"===Object.prototype.toString.call(e[n])&&T(e[n]),"[object Array]"===Object.prototype.toString.call(e[n]))for(var t in e[n])T(t);void 0===e[n]&&(e[n]=null)}}function A(e,n,t){for(var r=[];e;e=e.nextSibling)1==e.nodeType&&e!=n&&(t?t.toUpperCase()==e.nodeName.toUpperCase()&&r.push(e):r.push(e));return r}function M(e,n){return A(e.parentNode.firstChild,e,n)}function I(e){function n(e){var n=String(e);return 1===n.length&&(n="0"+n),n}var t=new Date,r="00",o="00",a="00";return e||(r=t.getUTCHours(),o=t.getUTCMinutes(),a=t.getUTCSeconds()),t.getUTCFullYear()+"-"+n(t.getUTCMonth()+1)+"-"+n(t.getUTCDate())+"T"+n(r)+":"+n(o)+":"+n(a)+"Z"}function x(e,n){var t="";for(i=0;i<n;i++)t+=e;return t}function O(e,n,t){_.isString(e)&&(e=s(e)),e=e||{};var r=String(e.hide||"").split(","),o=String(e.expand||"").split(","),a=String(n||"").split(","),i=String(t||"").split(",");return r=_.reject(r,function(e){return a.indexOf(e)>=0}),o=o.concat(i),o=_.uniq(o),e.hide=r.join(","),e.expand=o.join(","),e.hide=B(e.hide,","),e.expand=B(e.expand,","),e}function N(e,n){return e&&e.substring(0,1)==n&&(e=e.substring(1)),e}function P(e,n){return e&&"/"==e.charAt(e.length-1)&&(e=e.substr(0,e.length-1)),e}function L(e){var n=e.split(","),t=_.uniq(n);return t.join(",")}function B(e,n){return P(N(e,n),n)}function j(e){var n=[];return n.push("af-na","af-za","af","ar-ae","ar-bh","ar-dj","ar-dz","ar-eg","ar-eh","ar-er","ar-il","ar-iq","ar-jo","ar-km","ar-kw","ar-lb","ar-ly","ar-ma","ar-mr","ar-om","ar-ps","ar-qa","ar-sa","ar-sd","ar-so","ar-ss","ar-sy","ar-td","ar-tn","ar-ye","ar","az-cyrl-az","az-cyrl","az-latn-az","az-latn","az","bg-bg","bg","bo-cn","bo-in","bo","cs-cz","cs","da-dk","da-gl","da","dav-ke","dav","de-at","de-be","de-ch","de-de","de-li","de-lu","de","el-cy","el-gr","el","en-ag","en-ai","en-as","en-au","en-bb","en-be","en-bm","en-bs","en-bw","en-bz","en-ca","en-cc","en-ck","en-cm","en-cx","en-dg","en-dm","en-dsrt-us","en-dsrt","en-er","en-fj","en-fk","en-fm","en-gb","en-gd","en-gg","en-gh","en-gi","en-gm","en-gu","en-gy","en-hk","en-ie","en-im","en-in","en-io","en-iso","en-je","en-jm","en-ke","en-ki","en-kn","en-ky","en-lc","en-lr","en-ls","en-mg","en-mh","en-mo","en-mp","en-ms","en-mt","en-mu","en-mw","en-na","en-nf","en-ng","en-nr","en-nu","en-nz","en-pg","en-ph","en-pk","en-pn","en-pr","en-pw","en-rw","en-sb","en-sc","en-sd","en-sg","en-sh","en-sl","en-ss","en-sx","en-sz","en-tc","en-tk","en-to","en-tt","en-tv","en-tz","en-ug","en-um","en-us","en-vc","en-vg","en-vi","en-vu","en-ws","en-za","en-zm","en-zw","en","es-ar","es-bo","es-cl","es-co","es-cr","es-cu","es-do","es-ea","es-ec","es-es","es-gq","es-gt","es-hn","es-ic","es-mx","es-ni","es-pa","es-pe","es-ph","es-pr","es-py","es-sv","es-us","es-uy","es-ve","es","et-ee","et","eu-es","eu","fa-af","fa-ir","fa","fi-fi","fi","fil-ph","fil","fr-be","fr-bf","fr-bi","fr-bj","fr-bl","fr-ca","fr-cd","fr-cf","fr-cg","fr-ch","fr-ci","fr-cm","fr-dj","fr-dz","fr-fr","fr-ga","fr-gf","fr-gn","fr-gp","fr-gq","fr-ht","fr-km","fr-lu","fr-ma","fr-mc","fr-mf","fr-mg","fr-ml","fr-mq","fr-mr","fr-mu","fr-nc","fr-ne","fr-pf","fr-pm","fr-re","fr-rw","fr-sc","fr-sn","fr-sy","fr-td","fr-tg","fr-tn","fr-vu","fr-wf","fr-yt","fr","hi-in","hi","hr-ba","hr-hr","hr","hu-hu","hu","hy-am","hy","is-is","is","it-ch","it-it","it-sm","it","ja-jp","ja","ka-ge","ka","kab-dz","kab","kam-ke","kam","kk-cyrl-kz","kk-cyrl","kk","kkj-cm","kkj","kl-gl","kl","kln-ke","kln","km-kh","km","ko-kp","ko-kr","ko","kok-in","kok","lo-la","lo","lt-lt","lt","mg-mg","mg","mgh-mz","mgh","mgo-cm","mgo","mk-mk","mk","mn-cyrl-mn","mn-cyrl","mn","ms-bn","ms-latn-bn","ms-latn-my","ms-latn-sg","ms-latn","ms-my","ms","mt-mt","mt","ne-in","ne-np","ne","nl-aw","nl-be","nl-bq","nl-cw","nl-nl","nl-sr","nl-sx","nl","no-no","no","pl-pl","pl","pt-ao","pt-br","pt-cv","pt-gw","pt-mo","pt-mz","pt-pt","pt-st","pt-tl","pt","ro-md","ro-ro","ro","rof-tz","rof","ru-by","ru-kg","ru-kz","ru-md","ru-ru","ru-ua","ru","shi-latn-ma","shi-latn","shi-tfng-ma","shi-tfng","shi","sk-sk","sk","sl-si","sl","sq-al","sq-mk","sq-xk","sq","sr-cyrl-ba","sr-cyrl-me","sr-cyrl-rs","sr-cyrl-xk","sr-cyrl","sr-latn-ba","sr-latn-me","sr-latn-rs","sr-latn-xk","sr-latn","sr","sv-ax","sv-fi","sv-se","sv","th-th","th","tl","to-to","to","tr-cy","tr-tr","tr","uk-ua","uk","uz-arab-af","uz-arab","uz-cyrl-uz","uz-cyrl","uz-latn-uz","uz-latn","uz","vi-vn","vi","zh-cn","zh-hans-cn","zh-hans-hk","zh-hans-mo","zh-hans-sg","zh-hans","zh-hant-hk","zh-hant-mo","zh-hant-tw","zh-hant","zh-hk","zh-tw","zh"),n.indexOf(localStorage.getItem("locale"))>=0?localStorage.getItem("locale"):e}return{setCookie:e,getCookie:n,deleteCookie:t,getPageHashParameters:o,getHashParameters:a,getPageQueryParameters:c,getQueryParameters:u,appendParams:l,left:d,right:p,isValidNumber:f,isValidInteger:m,getRandom:h,stringsToBool:w,stringToBool:C,hasProperty:v,areEqual:S,sumProperties:y,isNullOrEmpty:b,resetCookieExpiration:r,removeWhitespace:$,luhnCheck:E,undefinedToNull:T,parseQueryParameters:s,isValidEmail:g,getChildrenElements:A,getSiblingElements:M,convert:k,getCurrentIsoDate:I,repeat:x,mergeParams:O,deDuplicateCsv:L,getLocale:j}}();String.prototype.replaceAll=function(e,n){return this.split(e).join(n)},app.run(["$rootScope","$http","SettingsService","StorageService","LanguageService","ApiService",function(e,n,t,r,o,a){var i=t.get();i.config.development&&(n.defaults.useXDomain=!0),o.establishLanguage(e.languagesPath)}]);var saveAs=saveAs||function(e){"use strict";if(!("undefined"==typeof e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var n=e.document,t=function(){return e.URL||e.webkitURL||e},r=n.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in r,a=function(e){var n=new MouseEvent("click");e.dispatchEvent(n)},i=/constructor/i.test(e.HTMLElement),c=function(n){(e.setImmediate||e.setTimeout)(function(){throw n},0)},u="application/octet-stream",s=4e4,l=function(e){var n=function(){"string"==typeof e?t().revokeObjectURL(e):e.remove()};setTimeout(n,s)},d=function(e,n,t){n=[].concat(n);for(var r=n.length;r--;){var o=e["on"+n[r]];if("function"==typeof o)try{o.call(e,t||e)}catch(e){c(e)}}},p=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},f=function(n,c,s){s||(n=p(n));var f,m=this,g=n.type,h=g===u,v=function(){d(m,"writestart progress write writeend".split(" "))},y=function(){if(h&&i&&e.FileReader){var r=new FileReader;return r.onloadend=function(){var n=r.result;e.location.href="data:attachment/file"+n.slice(n.search(/[,;]/)),m.readyState=m.DONE,v()},r.readAsDataURL(n),void(m.readyState=m.INIT)}if(f||(f=t().createObjectURL(n)),h)e.location.href=f;else{var o=e.open(f,"_blank");o||(e.location.href=f)}m.readyState=m.DONE,v(),l(f)};return m.readyState=m.INIT,o?(f=t().createObjectURL(n),void setTimeout(function(){r.href=f,r.download=c,a(r),v(),l(f),m.readyState=m.DONE})):void y()},m=f.prototype,g=function(e,n,t){return new f(e,n||e.name||"download",t)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,n,t){return n=n||e.name||"download",t||(e=p(e)),navigator.msSaveOrOpenBlob(e,n)}:(m.abort=function(){},m.readyState=m.INIT=0,m.WRITING=1,m.DONE=2,m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null,g)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof module&&module.exports?module.exports.saveAs=saveAs:"undefined"!=typeof define&&null!==define&&null!==define.amd&&define([],function(){return saveAs}),function(){function e(e){function n(n,t,r,o,a,i){for(;a>=0&&i>a;a+=e){var c=o?o[a]:a;r=t(r,n[c],c,n)}return r}return function(t,r,o,a){r=S(r,a,4);var i=!E(t)&&y.keys(t),c=(i||t).length,u=e>0?0:c-1;return arguments.length<3&&(o=t[i?i[u]:u],u+=e),n(t,r,o,i,u,c)}}function n(e){return function(n,t,r){t=b(t,r);for(var o=k(n),a=e>0?0:o-1;a>=0&&o>a;a+=e)if(t(n[a],a,n))return a;return-1}}function t(e,n,t){return function(r,o,a){var i=0,c=k(r);if("number"==typeof a)e>0?i=a>=0?a:Math.max(a+c,i):c=a>=0?Math.min(a+1,c):a+c+1;else if(t&&a&&c)return a=t(r,o),r[a]===o?a:-1;if(o!==o)return a=n(l.call(r,i,c),y.isNaN),a>=0?a+i:-1;for(a=e>0?i:c-1;a>=0&&c>a;a+=e)if(r[a]===o)return a;return-1}}function r(e,n){var t=x.length,r=e.constructor,o=y.isFunction(r)&&r.prototype||c,a="constructor";for(y.has(e,a)&&!y.contains(n,a)&&n.push(a);t--;)a=x[t],a in e&&e[a]!==o[a]&&!y.contains(n,a)&&n.push(a)}var o=this,a=o._,i=Array.prototype,c=Object.prototype,u=Function.prototype,s=i.push,l=i.slice,d=c.toString,p=c.hasOwnProperty,f=Array.isArray,m=Object.keys,g=u.bind,h=Object.create,v=function(){},y=function(e){return e instanceof y?e:this instanceof y?void(this._wrapped=e):new y(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=y),exports._=y):o._=y,y.VERSION="1.8.3";var S=function(e,n,t){if(void 0===n)return e;switch(null==t?3:t){case 1:return function(t){return e.call(n,t)};case 2:return function(t,r){return e.call(n,t,r)};case 3:return function(t,r,o){return e.call(n,t,r,o)};case 4:return function(t,r,o,a){return e.call(n,t,r,o,a)}}return function(){return e.apply(n,arguments)}},b=function(e,n,t){return null==e?y.identity:y.isFunction(e)?S(e,n,t):y.isObject(e)?y.matcher(e):y.property(e)};y.iteratee=function(e,n){return b(e,n,1/0)};var w=function(e,n){return function(t){var r=arguments.length;if(2>r||null==t)return t;for(var o=1;r>o;o++)for(var a=arguments[o],i=e(a),c=i.length,u=0;c>u;u++){var s=i[u];n&&void 0!==t[s]||(t[s]=a[s])}return t}},C=function(e){if(!y.isObject(e))return{};if(h)return h(e);v.prototype=e;var n=new v;return v.prototype=null,n},$=function(e){return function(n){return null==n?void 0:n[e]}},_=Math.pow(2,53)-1,k=$("length"),E=function(e){var n=k(e);return"number"==typeof n&&n>=0&&_>=n};y.each=y.forEach=function(e,n,t){n=S(n,t);var r,o;if(E(e))for(r=0,o=e.length;o>r;r++)n(e[r],r,e);else{var a=y.keys(e);for(r=0,o=a.length;o>r;r++)n(e[a[r]],a[r],e)}return e},y.map=y.collect=function(e,n,t){n=b(n,t);for(var r=!E(e)&&y.keys(e),o=(r||e).length,a=Array(o),i=0;o>i;i++){var c=r?r[i]:i;a[i]=n(e[c],c,e)}return a},y.reduce=y.foldl=y.inject=e(1),y.reduceRight=y.foldr=e(-1),y.find=y.detect=function(e,n,t){var r;return r=E(e)?y.findIndex(e,n,t):y.findKey(e,n,t),void 0!==r&&r!==-1?e[r]:void 0},y.filter=y.select=function(e,n,t){var r=[];return n=b(n,t),y.each(e,function(e,t,o){n(e,t,o)&&r.push(e)}),r},y.reject=function(e,n,t){return y.filter(e,y.negate(b(n)),t)},y.every=y.all=function(e,n,t){n=b(n,t);for(var r=!E(e)&&y.keys(e),o=(r||e).length,a=0;o>a;a++){var i=r?r[a]:a;if(!n(e[i],i,e))return!1}return!0},y.some=y.any=function(e,n,t){n=b(n,t);for(var r=!E(e)&&y.keys(e),o=(r||e).length,a=0;o>a;a++){var i=r?r[a]:a;if(n(e[i],i,e))return!0}return!1},y.contains=y.includes=y.include=function(e,n,t,r){return E(e)||(e=y.values(e)),("number"!=typeof t||r)&&(t=0),y.indexOf(e,n,t)>=0},y.invoke=function(e,n){var t=l.call(arguments,2),r=y.isFunction(n);return y.map(e,function(e){var o=r?n:e[n];return null==o?o:o.apply(e,t)})},y.pluck=function(e,n){return y.map(e,y.property(n))},y.where=function(e,n){return y.filter(e,y.matcher(n))},y.findWhere=function(e,n){return y.find(e,y.matcher(n))},y.max=function(e,n,t){var r,o,a=-1/0,i=-1/0;if(null==n&&null!=e){e=E(e)?e:y.values(e);for(var c=0,u=e.length;u>c;c++)r=e[c],r>a&&(a=r)}else n=b(n,t),y.each(e,function(e,t,r){o=n(e,t,r),(o>i||o===-1/0&&a===-1/0)&&(a=e,i=o)});return a},y.min=function(e,n,t){var r,o,a=1/0,i=1/0;if(null==n&&null!=e){e=E(e)?e:y.values(e);for(var c=0,u=e.length;u>c;c++)r=e[c],a>r&&(a=r)}else n=b(n,t),y.each(e,function(e,t,r){o=n(e,t,r),(i>o||1/0===o&&1/0===a)&&(a=e,i=o)});return a},y.shuffle=function(e){for(var n,t=E(e)?e:y.values(e),r=t.length,o=Array(r),a=0;r>a;a++)n=y.random(0,a),n!==a&&(o[a]=o[n]),o[n]=t[a];return o},y.sample=function(e,n,t){return null==n||t?(E(e)||(e=y.values(e)),e[y.random(e.length-1)]):y.shuffle(e).slice(0,Math.max(0,n))},y.sortBy=function(e,n,t){return n=b(n,t),y.pluck(y.map(e,function(e,t,r){return{value:e,index:t,criteria:n(e,t,r)}}).sort(function(e,n){var t=e.criteria,r=n.criteria;if(t!==r){if(t>r||void 0===t)return 1;if(r>t||void 0===r)return-1}return e.index-n.index}),"value")};var T=function(e){return function(n,t,r){var o={};return t=b(t,r),y.each(n,function(r,a){var i=t(r,a,n);e(o,r,i)}),o}};y.groupBy=T(function(e,n,t){y.has(e,t)?e[t].push(n):e[t]=[n]}),y.indexBy=T(function(e,n,t){e[t]=n}),y.countBy=T(function(e,n,t){y.has(e,t)?e[t]++:e[t]=1}),y.toArray=function(e){return e?y.isArray(e)?l.call(e):E(e)?y.map(e,y.identity):y.values(e):[]},y.size=function(e){return null==e?0:E(e)?e.length:y.keys(e).length},y.partition=function(e,n,t){n=b(n,t);var r=[],o=[];return y.each(e,function(e,t,a){(n(e,t,a)?r:o).push(e)}),[r,o]},y.first=y.head=y.take=function(e,n,t){return null==e?void 0:null==n||t?e[0]:y.initial(e,e.length-n)},y.initial=function(e,n,t){return l.call(e,0,Math.max(0,e.length-(null==n||t?1:n)))},y.last=function(e,n,t){return null==e?void 0:null==n||t?e[e.length-1]:y.rest(e,Math.max(0,e.length-n))},y.rest=y.tail=y.drop=function(e,n,t){return l.call(e,null==n||t?1:n)},y.compact=function(e){return y.filter(e,y.identity)};var A=function(e,n,t,r){for(var o=[],a=0,i=r||0,c=k(e);c>i;i++){var u=e[i];if(E(u)&&(y.isArray(u)||y.isArguments(u))){n||(u=A(u,n,t));var s=0,l=u.length;for(o.length+=l;l>s;)o[a++]=u[s++]}else t||(o[a++]=u)}return o};y.flatten=function(e,n){return A(e,n,!1)},y.without=function(e){return y.difference(e,l.call(arguments,1))},y.uniq=y.unique=function(e,n,t,r){y.isBoolean(n)||(r=t,t=n,n=!1),null!=t&&(t=b(t,r));for(var o=[],a=[],i=0,c=k(e);c>i;i++){var u=e[i],s=t?t(u,i,e):u;n?(i&&a===s||o.push(u),a=s):t?y.contains(a,s)||(a.push(s),o.push(u)):y.contains(o,u)||o.push(u)}return o},y.union=function(){return y.uniq(A(arguments,!0,!0))},y.intersection=function(e){for(var n=[],t=arguments.length,r=0,o=k(e);o>r;r++){var a=e[r];if(!y.contains(n,a)){for(var i=1;t>i&&y.contains(arguments[i],a);i++);i===t&&n.push(a)}}return n},y.difference=function(e){var n=A(arguments,!0,!0,1);return y.filter(e,function(e){return!y.contains(n,e)})},y.zip=function(){return y.unzip(arguments)},y.unzip=function(e){for(var n=e&&y.max(e,k).length||0,t=Array(n),r=0;n>r;r++)t[r]=y.pluck(e,r);return t},y.object=function(e,n){for(var t={},r=0,o=k(e);o>r;r++)n?t[e[r]]=n[r]:t[e[r][0]]=e[r][1];return t},y.findIndex=n(1),y.findLastIndex=n(-1),y.sortedIndex=function(e,n,t,r){t=b(t,r,1);for(var o=t(n),a=0,i=k(e);i>a;){var c=Math.floor((a+i)/2);t(e[c])<o?a=c+1:i=c}return a},y.indexOf=t(1,y.findIndex,y.sortedIndex),y.lastIndexOf=t(-1,y.findLastIndex),y.range=function(e,n,t){null==n&&(n=e||0,e=0),t=t||1;for(var r=Math.max(Math.ceil((n-e)/t),0),o=Array(r),a=0;r>a;a++,e+=t)o[a]=e;return o};var M=function(e,n,t,r,o){if(!(r instanceof n))return e.apply(t,o);var a=C(e.prototype),i=e.apply(a,o);return y.isObject(i)?i:a};y.bind=function(e,n){if(g&&e.bind===g)return g.apply(e,l.call(arguments,1));if(!y.isFunction(e))throw new TypeError("Bind must be called on a function");var t=l.call(arguments,2),r=function(){return M(e,r,n,this,t.concat(l.call(arguments)))};return r},y.partial=function(e){var n=l.call(arguments,1),t=function(){for(var r=0,o=n.length,a=Array(o),i=0;o>i;i++)a[i]=n[i]===y?arguments[r++]:n[i];for(;r<arguments.length;)a.push(arguments[r++]);return M(e,t,this,this,a)};return t},y.bindAll=function(e){var n,t,r=arguments.length;if(1>=r)throw new Error("bindAll must be passed function names");for(n=1;r>n;n++)t=arguments[n],e[t]=y.bind(e[t],e);return e},y.memoize=function(e,n){var t=function(r){var o=t.cache,a=""+(n?n.apply(this,arguments):r);return y.has(o,a)||(o[a]=e.apply(this,arguments)),o[a]};return t.cache={},t},y.delay=function(e,n){var t=l.call(arguments,2);return setTimeout(function(){return e.apply(null,t)},n)},y.defer=y.partial(y.delay,y,1),y.throttle=function(e,n,t){var r,o,a,i=null,c=0;t||(t={});var u=function(){c=t.leading===!1?0:y.now(),i=null,a=e.apply(r,o),i||(r=o=null)};return function(){var s=y.now();c||t.leading!==!1||(c=s);var l=n-(s-c);return r=this,o=arguments,0>=l||l>n?(i&&(clearTimeout(i),i=null),c=s,a=e.apply(r,o),i||(r=o=null)):i||t.trailing===!1||(i=setTimeout(u,l)),a}},y.debounce=function(e,n,t){var r,o,a,i,c,u=function(){var s=y.now()-i;n>s&&s>=0?r=setTimeout(u,n-s):(r=null,t||(c=e.apply(a,o),r||(a=o=null)))};return function(){a=this,o=arguments,i=y.now();var s=t&&!r;return r||(r=setTimeout(u,n)),s&&(c=e.apply(a,o),a=o=null),c}},y.wrap=function(e,n){return y.partial(n,e)},y.negate=function(e){return function(){return!e.apply(this,arguments)}},y.compose=function(){var e=arguments,n=e.length-1;return function(){for(var t=n,r=e[n].apply(this,arguments);t--;)r=e[t].call(this,r);return r}},y.after=function(e,n){return function(){return--e<1?n.apply(this,arguments):void 0}},y.before=function(e,n){var t;return function(){return--e>0&&(t=n.apply(this,arguments)),1>=e&&(n=null),t}},y.once=y.partial(y.before,2);var I=!{toString:null}.propertyIsEnumerable("toString"),x=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];y.keys=function(e){if(!y.isObject(e))return[];if(m)return m(e);var n=[];for(var t in e)y.has(e,t)&&n.push(t);return I&&r(e,n),n},y.allKeys=function(e){if(!y.isObject(e))return[];var n=[];for(var t in e)n.push(t);return I&&r(e,n),n},y.values=function(e){for(var n=y.keys(e),t=n.length,r=Array(t),o=0;t>o;o++)r[o]=e[n[o]];return r},y.mapObject=function(e,n,t){n=b(n,t);for(var r,o=y.keys(e),a=o.length,i={},c=0;a>c;c++)r=o[c],i[r]=n(e[r],r,e);return i},y.pairs=function(e){for(var n=y.keys(e),t=n.length,r=Array(t),o=0;t>o;o++)r[o]=[n[o],e[n[o]]];return r},y.invert=function(e){for(var n={},t=y.keys(e),r=0,o=t.length;o>r;r++)n[e[t[r]]]=t[r];return n},y.functions=y.methods=function(e){var n=[];for(var t in e)y.isFunction(e[t])&&n.push(t);return n.sort()},y.extend=w(y.allKeys),y.extendOwn=y.assign=w(y.keys),y.findKey=function(e,n,t){n=b(n,t);for(var r,o=y.keys(e),a=0,i=o.length;i>a;a++)if(r=o[a],n(e[r],r,e))return r},y.pick=function(e,n,t){var r,o,a={},i=e;if(null==i)return a;y.isFunction(n)?(o=y.allKeys(i),r=S(n,t)):(o=A(arguments,!1,!1,1),r=function(e,n,t){return n in t},i=Object(i));for(var c=0,u=o.length;u>c;c++){var s=o[c],l=i[s];r(l,s,i)&&(a[s]=l)}return a},y.omit=function(e,n,t){if(y.isFunction(n))n=y.negate(n);else{var r=y.map(A(arguments,!1,!1,1),String);n=function(e,n){return!y.contains(r,n)}}return y.pick(e,n,t)},y.defaults=w(y.allKeys,!0),y.create=function(e,n){var t=C(e);return n&&y.extendOwn(t,n),t},y.clone=function(e){return y.isObject(e)?y.isArray(e)?e.slice():y.extend({},e):e},y.tap=function(e,n){return n(e),e},y.isMatch=function(e,n){var t=y.keys(n),r=t.length;if(null==e)return!r;for(var o=Object(e),a=0;r>a;a++){var i=t[a];if(n[i]!==o[i]||!(i in o))return!1}return!0};var O=function(e,n,t,r){if(e===n)return 0!==e||1/e===1/n;if(null==e||null==n)return e===n;e instanceof y&&(e=e._wrapped),n instanceof y&&(n=n._wrapped);var o=d.call(e);if(o!==d.call(n))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+e==""+n;case"[object Number]":return+e!==+e?+n!==+n:0===+e?1/+e===1/n:+e===+n;case"[object Date]":case"[object Boolean]":return+e===+n}var a="[object Array]"===o;if(!a){if("object"!=typeof e||"object"!=typeof n)return!1;var i=e.constructor,c=n.constructor;if(i!==c&&!(y.isFunction(i)&&i instanceof i&&y.isFunction(c)&&c instanceof c)&&"constructor"in e&&"constructor"in n)return!1}t=t||[],r=r||[];for(var u=t.length;u--;)if(t[u]===e)return r[u]===n;if(t.push(e),r.push(n),a){if(u=e.length,u!==n.length)return!1;for(;u--;)if(!O(e[u],n[u],t,r))return!1}else{var s,l=y.keys(e);if(u=l.length,y.keys(n).length!==u)return!1;for(;u--;)if(s=l[u],!y.has(n,s)||!O(e[s],n[s],t,r))return!1}return t.pop(),r.pop(),!0};y.isEqual=function(e,n){return O(e,n)},y.isEmpty=function(e){return null==e||(E(e)&&(y.isArray(e)||y.isString(e)||y.isArguments(e))?0===e.length:0===y.keys(e).length)},y.isElement=function(e){return!(!e||1!==e.nodeType)},y.isArray=f||function(e){return"[object Array]"===d.call(e)},y.isObject=function(e){var n=typeof e;return"function"===n||"object"===n&&!!e},y.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(e){y["is"+e]=function(n){return d.call(n)==="[object "+e+"]"}}),y.isArguments(arguments)||(y.isArguments=function(e){return y.has(e,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(y.isFunction=function(e){return"function"==typeof e||!1}),y.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},y.isNaN=function(e){return y.isNumber(e)&&e!==+e},y.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===d.call(e)},y.isNull=function(e){return null===e},y.isUndefined=function(e){return void 0===e},y.has=function(e,n){return null!=e&&p.call(e,n)},y.noConflict=function(){return o._=a,this},y.identity=function(e){return e},y.constant=function(e){return function(){return e}},y.noop=function(){},y.property=$,y.propertyOf=function(e){return null==e?function(){}:function(n){return e[n]}},y.matcher=y.matches=function(e){return e=y.extendOwn({},e),function(n){return y.isMatch(n,e)}},y.times=function(e,n,t){var r=Array(Math.max(0,e));n=S(n,t,1);for(var o=0;e>o;o++)r[o]=n(o);return r},y.random=function(e,n){return null==n&&(n=e,e=0),e+Math.floor(Math.random()*(n-e+1))},y.now=Date.now||function(){return(new Date).getTime()};var N={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},P=y.invert(N),L=function(e){var n=function(n){return e[n]},t="(?:"+y.keys(e).join("|")+")",r=RegExp(t),o=RegExp(t,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(o,n):e}};y.escape=L(N),y.unescape=L(P),y.result=function(e,n,t){var r=null==e?void 0:e[n];return void 0===r&&(r=t),y.isFunction(r)?r.call(e):r};var B=0;y.uniqueId=function(e){var n=++B+"";return e?e+n:n},y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var j=/(.)^/,q={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\u2028|\u2029/g,F=function(e){return"\\"+q[e]};y.template=function(e,n,t){!n&&t&&(n=t),n=y.defaults({},n,y.templateSettings);var r=RegExp([(n.escape||j).source,(n.interpolate||j).source,(n.evaluate||j).source].join("|")+"|$","g"),o=0,a="__p+='";e.replace(r,function(n,t,r,i,c){return a+=e.slice(o,c).replace(D,F),o=c+n.length,t?a+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":r?a+="'+\n((__t=("+r+"))==null?'':__t)+\n'":i&&(a+="';\n"+i+"\n__p+='"),n}),a+="';\n",n.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{var i=new Function(n.variable||"obj","_",a)}catch(e){throw e.source=a,e}var c=function(e){return i.call(this,e,y)},u=n.variable||"obj";return c.source="function("+u+"){\n"+a+"}",c},y.chain=function(e){var n=y(e);return n._chain=!0,n};var R=function(e,n){return e._chain?y(n).chain():n};y.mixin=function(e){y.each(y.functions(e),function(n){var t=y[n]=e[n];y.prototype[n]=function(){var e=[this._wrapped];return s.apply(e,arguments),R(this,t.apply(y,e))}})},y.mixin(y),y.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var n=i[e];y.prototype[e]=function(){var t=this._wrapped;return n.apply(t,arguments),"shift"!==e&&"splice"!==e||0!==t.length||delete t[0],R(this,t)}}),y.each(["concat","join","slice"],function(e){var n=i[e];y.prototype[e]=function(){return R(this,n.apply(this._wrapped,arguments))}}),y.prototype.value=function(){return this._wrapped},y.prototype.valueOf=y.prototype.toJSON=y.prototype.value,y.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return y})}.call(this),angular.module("gettext",[]),angular.module("gettext").constant("gettext",function(e){return e}),angular.module("gettext").factory("gettextCatalog",["gettextPlurals","gettextFallbackLanguage","$http","$cacheFactory","$interpolate","$rootScope",function(e,n,t,r,o,a){function i(){a.$broadcast("gettextLanguageChanged")}var c,u="$$noContext",s='<span id="test" title="test" class="tested">test</span>',l=angular.element("<span>"+s+"</span>").html()!==s,d=function(e){return c.debug&&c.currentLanguage!==c.baseLanguage?c.debugPrefix+e:e},p=function(e){return c.showTranslatedMarkers?c.translatedMarkerPrefix+e+c.translatedMarkerSuffix:e};return c={debug:!1,debugPrefix:"[MISSING]: ",showTranslatedMarkers:!1,translatedMarkerPrefix:"[",translatedMarkerSuffix:"]",strings:{},baseLanguage:"en",currentLanguage:"en",cache:r("strings"),setCurrentLanguage:function(e){this.currentLanguage=e,i()},getCurrentLanguage:function(){return this.currentLanguage},setStrings:function(e,n){this.strings[e]||(this.strings[e]={});for(var t in n){var r=n[t];if(l&&(t=angular.element("<span>"+t+"</span>").html()),angular.isString(r)||angular.isArray(r)){var o={};o[u]=r,r=o}for(var a in r){var c=r[a];r[a]=angular.isArray(c)?c:[c]}this.strings[e][t]=r}i()},getStringFormFor:function(n,t,r,o){if(!n)return null;var a=this.strings[n]||{},i=a[t]||{},c=i[o||u]||[];return c[e(n,r)]},getString:function(e,t,r){var a=n(this.currentLanguage);return e=this.getStringFormFor(this.currentLanguage,e,1,r)||this.getStringFormFor(a,e,1,r)||d(e),e=t?o(e)(t):e,p(e)},getPlural:function(e,t,r,a,i){var c=n(this.currentLanguage);return t=this.getStringFormFor(this.currentLanguage,t,e,i)||this.getStringFormFor(c,t,e,i)||d(1===e?t:r),a&&(a.$count=e,t=o(t)(a)),p(t)},loadRemote:function(e){return t({method:"GET",url:e,cache:c.cache}).then(function(e){var n=e.data;for(var t in n)c.setStrings(t,n[t]);return e})}}}]),angular.module("gettext").directive("translate",["gettextCatalog","$parse","$animate","$compile","$window",function(e,n,t,r,o){function a(e,n,t){if(!e)throw new Error("You should add a "+n+" attribute whenever you add a "+t+" attribute.")}var i=function(){return String.prototype.trim?function(e){return"string"==typeof e?e.trim():e}:function(e){return"string"==typeof e?e.replace(/^\s*/,"").replace(/\s*$/,""):e}}(),c=parseInt((/msie (\d+)/.exec(angular.lowercase(o.navigator.userAgent))||[])[1],10);return{restrict:"AE",terminal:!0,compile:function(o,u){a(!u.translatePlural||u.translateN,"translate-n","translate-plural"),a(!u.translateN||u.translatePlural,"translate-plural","translate-n");var s=i(o.html()),l=u.translatePlural,d=u.translateContext;return 8>=c&&"<!--IE fix-->"===s.slice(-13)&&(s=s.slice(0,-13)),{post:function(o,a,c){function u(){var n;l?(o=f||(f=o.$new()),o.$count=p(o),n=e.getPlural(o.$count,s,l,null,d)):n=e.getString(s,null,d);var c=a.contents();if(0!==c.length){if(n===i(c.html()))return void(m&&r(c)(o));var u=angular.element("<span>"+n+"</span>");r(u.contents())(o);var g=u.contents();t.enter(g,a),t.leave(c)}}var p=n(c.translateN),f=null,m=!0;c.translateN&&o.$watch(c.translateN,u),o.$on("gettextLanguageChanged",u),u(),m=!1}}}}}]),angular.module("gettext").factory("gettextFallbackLanguage",function(){var e={},n=/([^_]+)_[^_]+$/;return function(t){if(e[t])return e[t];var r=n.exec(t);return r?(e[t]=r[1],r[1]):null}}),angular.module("gettext").filter("translate",["gettextCatalog",function(e){function n(n,t){return e.getString(n,null,t)}return n.$stateful=!0,n}]),angular.module("gettext").factory("gettextPlurals",function(){return function(e,n){switch(e){case"ay":case"bo":case"cgg":case"dz":case"fa":case"id":case"ja":case"jbo":case"ka":case"kk":case"km":case"ko":case"ky":case"lo":case"ms":case"my":case"sah":case"su":case"th":case"tt":case"ug":case"vi":case"wo":case"zh":return 0;case"is":return n%10!=1||n%100==11?1:0;case"jv":return 0!=n?1:0;case"mk":return 1==n||n%10==1?0:1;case"ach":case"ak":case"am":case"arn":case"br":case"fil":case"fr":case"gun":case"ln":case"mfe":case"mg":case"mi":case"oc":case"pt_BR":case"tg":case"ti":case"tr":case"uz":case"wa":case"zh":return n>1?1:0;case"lv":return n%10==1&&n%100!=11?0:0!=n?1:2;case"lt":return n%10==1&&n%100!=11?0:n%10>=2&&(10>n%100||n%100>=20)?1:2;case"be":case"bs":case"hr":case"ru":case"sr":case"uk":return n%10==1&&n%100!=11?0:n%10>=2&&4>=n%10&&(10>n%100||n%100>=20)?1:2;case"mnk":return 0==n?0:1==n?1:2;case"ro":return 1==n?0:0==n||n%100>0&&20>n%100?1:2;case"pl":return 1==n?0:n%10>=2&&4>=n%10&&(10>n%100||n%100>=20)?1:2;case"cs":case"sk":return 1==n?0:n>=2&&4>=n?1:2;case"sl":return n%100==1?1:n%100==2?2:n%100==3||n%100==4?3:0;case"mt":return 1==n?0:0==n||n%100>1&&11>n%100?1:n%100>10&&20>n%100?2:3;case"gd":return 1==n||11==n?0:2==n||12==n?1:n>2&&20>n?2:3;case"cy":return 1==n?0:2==n?1:8!=n&&11!=n?2:3;case"kw":return 1==n?0:2==n?1:3==n?2:3;case"ga":return 1==n?0:2==n?1:7>n?2:11>n?3:4;case"ar":return 0==n?0:1==n?1:2==n?2:n%100>=3&&10>=n%100?3:n%100>=11?4:5;default:return 1!=n?1:0}}});var duScrollDefaultEasing=function(e){"use strict";return.5>e?Math.pow(2*e,2)/2:1-Math.pow(2*(1-e),2)/2};angular.module("duScroll",["duScroll.scrollspy","duScroll.smoothScroll","duScroll.scrollContainer","duScroll.spyContext","duScroll.scrollHelpers"]).value("duScrollDuration",350).value("duScrollSpyWait",100).value("duScrollGreedy",!1).value("duScrollOffset",0).value("duScrollEasing",duScrollDefaultEasing).value("duScrollCancelOnEvents","scroll mousedown mousewheel touchmove keydown").value("duScrollBottomSpy",!1).value("duScrollActiveClass","active"),angular.module("duScroll.scrollHelpers",["duScroll.requestAnimation"]).run(["$window","$q","cancelAnimation","requestAnimation","duScrollEasing","duScrollDuration","duScrollOffset","duScrollCancelOnEvents",function(e,n,t,r,o,a,i,c){
"use strict";var u={},s=function(e){return"undefined"!=typeof HTMLDocument&&e instanceof HTMLDocument||e.nodeType&&e.nodeType===e.DOCUMENT_NODE},l=function(e){return"undefined"!=typeof HTMLElement&&e instanceof HTMLElement||e.nodeType&&e.nodeType===e.ELEMENT_NODE},d=function(e){return l(e)||s(e)?e:e[0]};u.duScrollTo=function(n,t,r,o){var a;if(angular.isElement(n)?a=this.duScrollToElement:angular.isDefined(r)&&(a=this.duScrollToAnimated),a)return a.apply(this,arguments);var i=d(this);return s(i)?e.scrollTo(n,t):(i.scrollLeft=n,void(i.scrollTop=t))};var p,f;u.duScrollToAnimated=function(e,a,i,u){i&&!u&&(u=o);var s=this.duScrollLeft(),l=this.duScrollTop(),d=Math.round(e-s),m=Math.round(a-l),g=null,h=0,v=this,y=function(e){(!e||h&&e.which>0)&&(c&&v.unbind(c,y),t(p),f.reject(),p=null)};if(p&&y(),f=n.defer(),0===i||!d&&!m)return 0===i&&v.duScrollTo(e,a),f.resolve(),f.promise;var S=function(e){null===g&&(g=e),h=e-g;var n=h>=i?1:u(h/i);v.scrollTo(s+Math.ceil(d*n),l+Math.ceil(m*n)),1>n?p=r(S):(c&&v.unbind(c,y),p=null,f.resolve())};return v.duScrollTo(s,l),c&&v.bind(c,y),p=r(S),f.promise},u.duScrollToElement=function(e,n,t,r){var o=d(this);(!angular.isNumber(n)||isNaN(n))&&(n=i);var a=this.duScrollTop()+d(e).getBoundingClientRect().top-n;return l(o)&&(a-=o.getBoundingClientRect().top),this.duScrollTo(0,a,t,r)},u.duScrollLeft=function(n,t,r){if(angular.isNumber(n))return this.duScrollTo(n,this.duScrollTop(),t,r);var o=d(this);return s(o)?e.scrollX||document.documentElement.scrollLeft||document.body.scrollLeft:o.scrollLeft},u.duScrollTop=function(n,t,r){if(angular.isNumber(n))return this.duScrollTo(this.duScrollLeft(),n,t,r);var o=d(this);return s(o)?e.scrollY||document.documentElement.scrollTop||document.body.scrollTop:o.scrollTop},u.duScrollToElementAnimated=function(e,n,t,r){return this.duScrollToElement(e,n,t||a,r)},u.duScrollTopAnimated=function(e,n,t){return this.duScrollTop(e,n||a,t)},u.duScrollLeftAnimated=function(e,n,t){return this.duScrollLeft(e,n||a,t)},angular.forEach(u,function(e,n){angular.element.prototype[n]=e;var t=n.replace(/^duScroll/,"scroll");angular.isUndefined(angular.element.prototype[t])&&(angular.element.prototype[t]=e)})}]),angular.module("duScroll.polyfill",[]).factory("polyfill",["$window",function(e){"use strict";var n=["webkit","moz","o","ms"];return function(t,r){if(e[t])return e[t];for(var o,a=t.substr(0,1).toUpperCase()+t.substr(1),i=0;i<n.length;i++)if(o=n[i]+a,e[o])return e[o];return r}}]),angular.module("duScroll.requestAnimation",["duScroll.polyfill"]).factory("requestAnimation",["polyfill","$timeout",function(e,n){"use strict";var t=0,r=function(e,r){var o=(new Date).getTime(),a=Math.max(0,16-(o-t)),i=n(function(){e(o+a)},a);return t=o+a,i};return e("requestAnimationFrame",r)}]).factory("cancelAnimation",["polyfill","$timeout",function(e,n){"use strict";var t=function(e){n.cancel(e)};return e("cancelAnimationFrame",t)}]),angular.module("duScroll.spyAPI",["duScroll.scrollContainerAPI"]).factory("spyAPI",["$rootScope","$timeout","$window","$document","scrollContainerAPI","duScrollGreedy","duScrollSpyWait","duScrollBottomSpy","duScrollActiveClass",function(e,n,t,r,o,a,i,c,u){"use strict";var s=function(o){var s=!1,l=!1,d=function(){l=!1;var n,i=o.container,s=i[0],d=0;"undefined"!=typeof HTMLElement&&s instanceof HTMLElement||s.nodeType&&s.nodeType===s.ELEMENT_NODE?(d=s.getBoundingClientRect().top,n=Math.round(s.scrollTop+s.clientHeight)>=s.scrollHeight):n=Math.round(t.pageYOffset+t.innerHeight)>=r[0].body.scrollHeight;var p,f,m,g,h,v,y=c&&n?"bottom":"top";for(g=o.spies,f=o.currentlyActive,m=void 0,p=0;p<g.length;p++)h=g[p],v=h.getTargetPosition(),v&&(c&&n||v.top+h.offset-d<20&&(a||-1*v.top+d)<v.height)&&(!m||m[y]<v[y])&&(m={spy:h},m[y]=v[y]);m&&(m=m.spy),f===m||a&&!m||(f&&(f.$element.removeClass(u),e.$broadcast("duScrollspy:becameInactive",f.$element,angular.element(f.getTargetElement()))),m&&(m.$element.addClass(u),e.$broadcast("duScrollspy:becameActive",m.$element,angular.element(m.getTargetElement()))),o.currentlyActive=m)};return i?function(){s?l=!0:(d(),s=n(function(){s=!1,l&&d()},i,!1))}:d},l={},d=function(e){var n=e.$id,t={spies:[]};return t.handler=s(t),l[n]=t,e.$on("$destroy",function(){p(e)}),n},p=function(e){var n=e.$id,t=l[n],r=t.container;r&&r.off("scroll",t.handler),delete l[n]},f=d(e),m=function(e){return l[e.$id]?l[e.$id]:e.$parent?m(e.$parent):l[f]},g=function(e){var n,t,r=e.$scope;if(r)return m(r);for(t in l)if(n=l[t],-1!==n.spies.indexOf(e))return n},h=function(e){for(;e.parentNode;)if(e=e.parentNode,e===document)return!0;return!1},v=function(e){var n=g(e);n&&(n.spies.push(e),n.container&&h(n.container)||(n.container&&n.container.off("scroll",n.handler),n.container=o.getContainer(e.$scope),n.container.on("scroll",n.handler).triggerHandler("scroll")))},y=function(e){var n=g(e);e===n.currentlyActive&&(n.currentlyActive=null);var t=n.spies.indexOf(e);-1!==t&&n.spies.splice(t,1),e.$element=null};return{addSpy:v,removeSpy:y,createContext:d,destroyContext:p,getContextForScope:m}}]),angular.module("duScroll.scrollContainerAPI",[]).factory("scrollContainerAPI",["$document",function(e){"use strict";var n={},t=function(e,t){var r=e.$id;return n[r]=t,r},r=function(e){return n[e.$id]?e.$id:e.$parent?r(e.$parent):void 0},o=function(t){var o=r(t);return o?n[o]:e},a=function(e){var t=r(e);t&&delete n[t]};return{getContainerId:r,getContainer:o,setContainer:t,removeContainer:a}}]),angular.module("duScroll.smoothScroll",["duScroll.scrollHelpers","duScroll.scrollContainerAPI"]).directive("duSmoothScroll",["duScrollDuration","duScrollOffset","scrollContainerAPI",function(e,n,t){"use strict";return{link:function(r,o,a){o.on("click",function(o){if(a.href&&-1!==a.href.indexOf("#")||""!==a.duSmoothScroll){var i=a.href?a.href.replace(/.*(?=#[^\s]+$)/,"").substring(1):a.duSmoothScroll,c=document.getElementById(i)||document.getElementsByName(i)[0];if(c&&c.getBoundingClientRect){o.stopPropagation&&o.stopPropagation(),o.preventDefault&&o.preventDefault();var u=a.offset?parseInt(a.offset,10):n,s=a.duration?parseInt(a.duration,10):e,l=t.getContainer(r);l.duScrollToElement(angular.element(c),isNaN(u)?0:u,isNaN(s)?0:s)}}})}}}]),angular.module("duScroll.spyContext",["duScroll.spyAPI"]).directive("duSpyContext",["spyAPI",function(e){"use strict";return{restrict:"A",scope:!0,compile:function(n,t,r){return{pre:function(n,t,r,o){e.createContext(n)}}}}}]),angular.module("duScroll.scrollContainer",["duScroll.scrollContainerAPI"]).directive("duScrollContainer",["scrollContainerAPI",function(e){"use strict";return{restrict:"A",scope:!0,compile:function(n,t,r){return{pre:function(n,t,r,o){r.$observe("duScrollContainer",function(r){angular.isString(r)&&(r=document.getElementById(r)),r=angular.isElement(r)?angular.element(r):t,e.setContainer(n,r),n.$on("$destroy",function(){e.removeContainer(n)})})}}}}}]),angular.module("duScroll.scrollspy",["duScroll.spyAPI"]).directive("duScrollspy",["spyAPI","duScrollOffset","$timeout","$rootScope",function(e,n,t,r){"use strict";var o=function(e,n,t,r){angular.isElement(e)?this.target=e:angular.isString(e)&&(this.targetId=e),this.$scope=n,this.$element=t,this.offset=r};return o.prototype.getTargetElement=function(){return!this.target&&this.targetId&&(this.target=document.getElementById(this.targetId)||document.getElementsByName(this.targetId)[0]),this.target},o.prototype.getTargetPosition=function(){var e=this.getTargetElement();return e?e.getBoundingClientRect():void 0},o.prototype.flushTargetCache=function(){this.targetId&&(this.target=void 0)},{link:function(a,i,c){var u,s=c.ngHref||c.href;if(s&&-1!==s.indexOf("#")?u=s.replace(/.*(?=#[^\s]+$)/,"").substring(1):c.duScrollspy?u=c.duScrollspy:c.duSmoothScroll&&(u=c.duSmoothScroll),u){var l=t(function(){var t=new o(u,a,i,(-(c.offset?parseInt(c.offset,10):n)));e.addSpy(t),a.$on("$locationChangeSuccess",t.flushTargetCache.bind(t));var s=r.$on("$stateChangeSuccess",t.flushTargetCache.bind(t));a.$on("$destroy",function(){e.removeSpy(t),s()})},0,!1);a.$on("$destroy",function(){t.cancel(l)})}}}}]),!function(){"use strict";angular.module("angular-loading-bar",["cfp.loadingBarInterceptor"]),angular.module("chieffancypants.loadingBar",["cfp.loadingBarInterceptor"]),angular.module("cfp.loadingBarInterceptor",["cfp.loadingBar"]).config(["$httpProvider",function(e){var n=["$q","$cacheFactory","$timeout","$rootScope","$log","cfpLoadingBar",function(n,t,r,o,a,i){function c(){r.cancel(s),i.complete(),d=0,l=0}function u(n){var r,o=t.get("$http"),a=e.defaults;!n.cache&&!a.cache||n.cache===!1||"GET"!==n.method&&"JSONP"!==n.method||(r=angular.isObject(n.cache)?n.cache:angular.isObject(a.cache)?a.cache:o);var i=void 0!==r&&void 0!==r.get(n.url);return void 0!==n.cached&&i!==n.cached?n.cached:(n.cached=i,i)}var s,l=0,d=0,p=i.latencyThreshold;return{request:function(e){return e.ignoreLoadingBar||u(e)||(o.$broadcast("cfpLoadingBar:loading",{url:e.url}),0===l&&(s=r(function(){i.start()},p)),l++,i.set(d/l)),e},response:function(e){return e&&e.config?(e.config.ignoreLoadingBar||u(e.config)||(d++,o.$broadcast("cfpLoadingBar:loaded",{url:e.config.url,result:e}),d>=l?c():i.set(d/l)),e):(a.error("Broken interceptor detected: Config object not supplied in response:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"),e)},responseError:function(e){return e&&e.config?(e.config.ignoreLoadingBar||u(e.config)||(d++,o.$broadcast("cfpLoadingBar:loaded",{url:e.config.url,result:e}),d>=l?c():i.set(d/l)),n.reject(e)):(a.error("Broken interceptor detected: Config object not supplied in rejection:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"),n.reject(e))}}}];e.interceptors.push(n)}]),angular.module("cfp.loadingBar",[]).provider("cfpLoadingBar",function(){this.autoIncrement=!0,this.includeSpinner=!0,this.includeBar=!0,this.latencyThreshold=100,this.startSize=.02,this.parentSelector="body",this.spinnerTemplate='<div id="loading-bar-spinner"><div class="spinner-icon"></div></div>',this.loadingBarTemplate='<div id="loading-bar"><div class="bar"><div class="peg"></div></div></div>',this.$get=["$injector","$document","$timeout","$rootScope",function(e,n,t,r){function o(){l||(l=e.get("$animate"));var o=n.find(f).eq(0);t.cancel(p),v||(r.$broadcast("cfpLoadingBar:started"),v=!0,w&&l.enter(m,o,angular.element(o[0].lastChild)),b&&l.enter(h,o,angular.element(o[0].lastChild)),a(C))}function a(e){if(v){var n=100*e+"%";g.css("width",n),y=e,S&&(t.cancel(d),d=t(function(){i()},250))}}function i(){if(!(c()>=1)){var e=0,n=c();e=n>=0&&.25>n?(3*Math.random()+3)/100:n>=.25&&.65>n?3*Math.random()/100:n>=.65&&.9>n?2*Math.random()/100:n>=.9&&.99>n?.005:0;var t=c()+e;a(t)}}function c(){return y}function u(){y=0,v=!1}function s(){l||(l=e.get("$animate")),r.$broadcast("cfpLoadingBar:completed"),a(1),t.cancel(p),p=t(function(){var e=l.leave(m,u);e&&e.then&&e.then(u),l.leave(h)},500)}var l,d,p,f=this.parentSelector,m=angular.element(this.loadingBarTemplate),g=m.find("div").eq(0),h=angular.element(this.spinnerTemplate),v=!1,y=0,S=this.autoIncrement,b=this.includeSpinner,w=this.includeBar,C=this.startSize;return{start:o,set:a,status:c,inc:i,complete:s,autoIncrement:this.autoIncrement,includeSpinner:this.includeSpinner,latencyThreshold:this.latencyThreshold,parentSelector:this.parentSelector,startSize:this.startSize}}]})}(),function(e){"use strict";angular.module("tmh.dynamicLocale",[]).provider("tmhDynamicLocale",function(){function e(e,n,t,r){var o=document.createElement("script"),a=document.getElementsByTagName("body")[0],i=!1;o.type="text/javascript",o.readyState?o.onreadystatechange=function(){"complete"!==o.readyState&&"loaded"!==o.readyState||(o.onreadystatechange=null,r(function(){i||(i=!0,a.removeChild(o),n())},30,!1))}:(o.onload=function(){i||(i=!0,a.removeChild(o),n())},o.onerror=function(){i||(i=!0,a.removeChild(o),t())}),o.src=e,o.async=!1,a.appendChild(o)}function n(n,t,a,i,s,l,d){function p(e,n){o===a&&(angular.forEach(e,function(t,r){n[r]?angular.isArray(n[r])&&(e[r].length=n[r].length):delete e[r]}),angular.forEach(n,function(t,r){angular.isArray(n[r])||angular.isObject(n[r])?(e[r]||(e[r]=angular.isArray(n[r])?[]:{}),p(e[r],n[r])):e[r]=n[r]}))}if(u[a])return u[a];var f,m=s.defer();return a===o?m.resolve(t):(f=l.get(a))?(o=a,i.$evalAsync(function(){p(t,f),i.$broadcast("$localeChangeSuccess",a,t),r.put(c,a),m.resolve(t)})):(o=a,u[a]=m.promise,e(n,function(){var e=angular.injector(["ngLocale"]),n=e.get("$locale");p(t,n),l.put(a,n),delete u[a],i.$apply(function(){i.$broadcast("$localeChangeSuccess",a,t),r.put(c,a),m.resolve(t)})},function(){delete u[a],i.$apply(function(){i.$broadcast("$localeChangeError",a),m.reject(a)})},d)),m.promise}var t,r,o,a="angular/i18n/angular-locale_{{locale}}.js",i="tmhDynamicLocaleStorageCache",c="tmhDynamicLocale.locale",u={};this.localeLocationPattern=function(e){return e?(a=e,this):a},this.useStorage=function(e){i=e},this.useCookieStorage=function(){this.useStorage("$cookieStore")},this.defaultLocale=function(e){t=e},this.$get=["$rootScope","$injector","$interpolate","$locale","$q","tmhDynamicLocaleCache","$timeout",function(e,o,u,s,l,d,p){var f=u(a);return r=o.get(i),e.$evalAsync(function(){var o;(o=r.get(c)||t)&&n(f({locale:o}),s,o,e,l,d,p)}),{set:function(t){return n(f({locale:t}),s,t,e,l,d,p)}}}]}).provider("tmhDynamicLocaleCache",function(){this.$get=["$cacheFactory",function(e){return e("tmh.dynamicLocales")}]}).provider("tmhDynamicLocaleStorageCache",function(){this.$get=["$cacheFactory",function(e){return e("tmh.dynamicLocales.store")}]}).run(["tmhDynamicLocale",angular.noop])}(window),angular.module("ui.bootstrap",["ui.bootstrap.tpls","ui.bootstrap.alert","ui.bootstrap.dropdown","ui.bootstrap.multiMap","ui.bootstrap.position","ui.bootstrap.modal","ui.bootstrap.stackedMap"]),angular.module("ui.bootstrap.tpls",["uib/template/alert/alert.html","uib/template/modal/window.html"]),angular.module("ui.bootstrap.alert",[]).controller("UibAlertController",["$scope","$element","$attrs","$interpolate","$timeout",function(e,n,t,r,o){e.closeable=!!t.close,n.addClass("alert"),t.$set("role","alert"),e.closeable&&n.addClass("alert-dismissible");var a=angular.isDefined(t.dismissOnTimeout)?r(t.dismissOnTimeout)(e.$parent):null;a&&o(function(){e.close()},parseInt(a,10))}]).directive("uibAlert",function(){return{controller:"UibAlertController",controllerAs:"alert",restrict:"A",templateUrl:function(e,n){return n.templateUrl||"uib/template/alert/alert.html"},transclude:!0,scope:{close:"&"}}}),angular.module("ui.bootstrap.dropdown",["ui.bootstrap.multiMap","ui.bootstrap.position"]).constant("uibDropdownConfig",{appendToOpenClass:"uib-dropdown-open",openClass:"open"}).service("uibDropdownService",["$document","$rootScope","$$multiMap",function(e,n,t){var r=null,o=t.createNew();this.isOnlyOpen=function(e,n){var t=o.get(n);if(t){var r=t.reduce(function(n,t){return t.scope===e?t:n},{});if(r)return 1===t.length}return!1},this.open=function(n,t,i){if(r||e.on("click",a),r&&r!==n&&(r.isOpen=!1),r=n,i){var c=o.get(i);if(c){var u=c.map(function(e){return e.scope});-1===u.indexOf(n)&&o.put(i,{scope:n})}else o.put(i,{scope:n})}},this.close=function(n,t,i){if(r===n&&(e.off("click",a),e.off("keydown",this.keybindFilter),r=null),i){var c=o.get(i);if(c){var u=c.reduce(function(e,t){return t.scope===n?t:e},{});u&&o.remove(i,u)}}};var a=function(e){if(r&&r.isOpen&&!(e&&"disabled"===r.getAutoClose()||e&&3===e.which)){var t=r.getToggleElement();if(!(e&&t&&t[0].contains(e.target))){var o=r.getDropdownElement();e&&"outsideClick"===r.getAutoClose()&&o&&o[0].contains(e.target)||(r.focusToggleElement(),r.isOpen=!1,n.$$phase||r.$apply())}}};this.keybindFilter=function(e){if(r){var n=r.getDropdownElement(),t=r.getToggleElement(),o=n&&n[0].contains(e.target),i=t&&t[0].contains(e.target);27===e.which?(e.stopPropagation(),r.focusToggleElement(),a()):r.isKeynavEnabled()&&-1!==[38,40].indexOf(e.which)&&r.isOpen&&(o||i)&&(e.preventDefault(),e.stopPropagation(),r.focusDropdownEntry(e.which))}}}]).controller("UibDropdownController",["$scope","$element","$attrs","$parse","uibDropdownConfig","uibDropdownService","$animate","$uibPosition","$document","$compile","$templateRequest",function(e,n,t,r,o,a,i,c,u,s,l){function d(){n.append(m.dropdownMenu)}var p,f,m=this,g=e.$new(),h=o.appendToOpenClass,v=o.openClass,y=angular.noop,S=t.onToggle?r(t.onToggle):angular.noop,b=!1,w=u.find("body");n.addClass("dropdown"),this.init=function(){t.isOpen&&(f=r(t.isOpen),y=f.assign,e.$watch(f,function(e){g.isOpen=!!e})),b=angular.isDefined(t.keyboardNav)},this.toggle=function(e){return g.isOpen=arguments.length?!!e:!g.isOpen,angular.isFunction(y)&&y(g,g.isOpen),g.isOpen},this.isOpen=function(){return g.isOpen},g.getToggleElement=function(){return m.toggleElement},g.getAutoClose=function(){return t.autoClose||"always"},g.getElement=function(){return n},g.isKeynavEnabled=function(){return b},g.focusDropdownEntry=function(e){var t=m.dropdownMenu?angular.element(m.dropdownMenu).find("a"):n.find("ul").eq(0).find("a");switch(e){case 40:m.selectedOption=angular.isNumber(m.selectedOption)?m.selectedOption===t.length-1?m.selectedOption:m.selectedOption+1:0;break;case 38:m.selectedOption=angular.isNumber(m.selectedOption)?0===m.selectedOption?0:m.selectedOption-1:t.length-1}t[m.selectedOption].focus()},g.getDropdownElement=function(){return m.dropdownMenu},g.focusToggleElement=function(){m.toggleElement&&m.toggleElement[0].focus()},g.$watch("isOpen",function(o,f){var b=null,C=!1;if(angular.isDefined(t.dropdownAppendTo)){var $=r(t.dropdownAppendTo)(g);$&&(b=angular.element($))}if(angular.isDefined(t.dropdownAppendToBody)){var _=r(t.dropdownAppendToBody)(g);_!==!1&&(C=!0)}if(C&&!b&&(b=w),b&&m.dropdownMenu&&(o?(b.append(m.dropdownMenu),n.on("$destroy",d)):(n.off("$destroy",d),d())),b&&m.dropdownMenu){var k,E,T,A=c.positionElements(n,m.dropdownMenu,"bottom-left",!0),M=0;if(k={top:A.top+"px",display:o?"block":"none"},E=m.dropdownMenu.hasClass("dropdown-menu-right"),E?(k.left="auto",T=c.scrollbarPadding(b),T.heightOverflow&&T.scrollbarWidth&&(M=T.scrollbarWidth),k.right=window.innerWidth-M-(A.left+n.prop("offsetWidth"))+"px"):(k.left=A.left+"px",k.right="auto"),!C){var I=c.offset(b);k.top=A.top-I.top+"px",E?k.right=window.innerWidth-(A.left-I.left+n.prop("offsetWidth"))+"px":k.left=A.left-I.left+"px"}m.dropdownMenu.css(k)}var x=b?b:n,O=b?h:v,N=x.hasClass(O),P=a.isOnlyOpen(e,b);if(N===!o){var L;L=b?P?"removeClass":"addClass":o?"addClass":"removeClass",i[L](x,O).then(function(){angular.isDefined(o)&&o!==f&&S(e,{open:!!o})})}if(o)m.dropdownMenuTemplateUrl?l(m.dropdownMenuTemplateUrl).then(function(e){p=g.$new(),s(e.trim())(p,function(e){var n=e;m.dropdownMenu.replaceWith(n),m.dropdownMenu=n,u.on("keydown",a.keybindFilter)})}):u.on("keydown",a.keybindFilter),g.focusToggleElement(),a.open(g,n,b);else{if(a.close(g,n,b),m.dropdownMenuTemplateUrl){p&&p.$destroy();var B=angular.element('<ul class="dropdown-menu"></ul>');m.dropdownMenu.replaceWith(B),m.dropdownMenu=B}m.selectedOption=null}angular.isFunction(y)&&y(e,o)})}]).directive("uibDropdown",function(){return{controller:"UibDropdownController",link:function(e,n,t,r){r.init()}}}).directive("uibDropdownMenu",function(){return{restrict:"A",require:"?^uibDropdown",link:function(e,n,t,r){if(r&&!angular.isDefined(t.dropdownNested)){n.addClass("dropdown-menu");var o=t.templateUrl;o&&(r.dropdownMenuTemplateUrl=o),r.dropdownMenu||(r.dropdownMenu=n)}}}}).directive("uibDropdownToggle",function(){return{require:"?^uibDropdown",link:function(e,n,t,r){if(r){n.addClass("dropdown-toggle"),r.toggleElement=n;var o=function(o){o.preventDefault(),n.hasClass("disabled")||t.disabled||e.$apply(function(){r.toggle()})};n.on("click",o),n.attr({"aria-haspopup":!0,"aria-expanded":!1}),e.$watch(r.isOpen,function(e){n.attr("aria-expanded",!!e)}),e.$on("$destroy",function(){n.off("click",o)})}}}}),angular.module("ui.bootstrap.multiMap",[]).factory("$$multiMap",function(){return{createNew:function(){var e={};return{entries:function(){return Object.keys(e).map(function(n){return{key:n,value:e[n]}})},get:function(n){return e[n]},hasKey:function(n){return!!e[n]},keys:function(){return Object.keys(e)},put:function(n,t){e[n]||(e[n]=[]),e[n].push(t)},remove:function(n,t){var r=e[n];if(r){var o=r.indexOf(t);-1!==o&&r.splice(o,1),r.length||delete e[n]}}}}}}),angular.module("ui.bootstrap.position",[]).factory("$uibPosition",["$document","$window",function(e,n){var t,r,o={normal:/(auto|scroll)/,hidden:/(auto|scroll|hidden)/},a={auto:/\s?auto?\s?/i,primary:/^(top|bottom|left|right)$/,secondary:/^(top|bottom|left|right|center)$/,vertical:/^(top|bottom)$/},i=/(HTML|BODY)/;return{getRawNode:function(e){return e.nodeName?e:e[0]||e},parseStyle:function(e){return e=parseFloat(e),isFinite(e)?e:0},offsetParent:function(t){function r(e){return"static"===(n.getComputedStyle(e).position||"static")}t=this.getRawNode(t);for(var o=t.offsetParent||e[0].documentElement;o&&o!==e[0].documentElement&&r(o);)o=o.offsetParent;return o||e[0].documentElement},scrollbarWidth:function(o){if(o){if(angular.isUndefined(r)){var a=e.find("body");a.addClass("uib-position-body-scrollbar-measure"),r=n.innerWidth-a[0].clientWidth,r=isFinite(r)?r:0,a.removeClass("uib-position-body-scrollbar-measure")}return r}if(angular.isUndefined(t)){var i=angular.element('<div class="uib-position-scrollbar-measure"></div>');e.find("body").append(i),t=i[0].offsetWidth-i[0].clientWidth,t=isFinite(t)?t:0,i.remove()}return t},scrollbarPadding:function(e){e=this.getRawNode(e);var t=n.getComputedStyle(e),r=this.parseStyle(t.paddingRight),o=this.parseStyle(t.paddingBottom),a=this.scrollParent(e,!1,!0),c=this.scrollbarWidth(i.test(a.tagName));return{scrollbarWidth:c,widthOverflow:a.scrollWidth>a.clientWidth,right:r+c,originalRight:r,heightOverflow:a.scrollHeight>a.clientHeight,bottom:o+c,originalBottom:o}},isScrollable:function(e,t){e=this.getRawNode(e);var r=t?o.hidden:o.normal,a=n.getComputedStyle(e);return r.test(a.overflow+a.overflowY+a.overflowX)},scrollParent:function(t,r,a){t=this.getRawNode(t);var i=r?o.hidden:o.normal,c=e[0].documentElement,u=n.getComputedStyle(t);if(a&&i.test(u.overflow+u.overflowY+u.overflowX))return t;var s="absolute"===u.position,l=t.parentElement||c;if(l===c||"fixed"===u.position)return c;for(;l.parentElement&&l!==c;){var d=n.getComputedStyle(l);if(s&&"static"!==d.position&&(s=!1),!s&&i.test(d.overflow+d.overflowY+d.overflowX))break;l=l.parentElement}return l},position:function(t,r){t=this.getRawNode(t);var o=this.offset(t);if(r){var a=n.getComputedStyle(t);o.top-=this.parseStyle(a.marginTop),o.left-=this.parseStyle(a.marginLeft)}var i=this.offsetParent(t),c={top:0,left:0};return i!==e[0].documentElement&&(c=this.offset(i),c.top+=i.clientTop-i.scrollTop,c.left+=i.clientLeft-i.scrollLeft),{width:Math.round(angular.isNumber(o.width)?o.width:t.offsetWidth),height:Math.round(angular.isNumber(o.height)?o.height:t.offsetHeight),top:Math.round(o.top-c.top),left:Math.round(o.left-c.left)}},offset:function(t){t=this.getRawNode(t);var r=t.getBoundingClientRect();return{width:Math.round(angular.isNumber(r.width)?r.width:t.offsetWidth),height:Math.round(angular.isNumber(r.height)?r.height:t.offsetHeight),top:Math.round(r.top+(n.pageYOffset||e[0].documentElement.scrollTop)),left:Math.round(r.left+(n.pageXOffset||e[0].documentElement.scrollLeft))}},viewportOffset:function(t,r,o){t=this.getRawNode(t),o=o!==!1;var a=t.getBoundingClientRect(),i={top:0,left:0,bottom:0,right:0},c=r?e[0].documentElement:this.scrollParent(t),u=c.getBoundingClientRect();if(i.top=u.top+c.clientTop,i.left=u.left+c.clientLeft,c===e[0].documentElement&&(i.top+=n.pageYOffset,i.left+=n.pageXOffset),i.bottom=i.top+c.clientHeight,i.right=i.left+c.clientWidth,o){var s=n.getComputedStyle(c);i.top+=this.parseStyle(s.paddingTop),i.bottom-=this.parseStyle(s.paddingBottom),i.left+=this.parseStyle(s.paddingLeft),i.right-=this.parseStyle(s.paddingRight)}return{top:Math.round(a.top-i.top),bottom:Math.round(i.bottom-a.bottom),left:Math.round(a.left-i.left),right:Math.round(i.right-a.right)}},parsePlacement:function(e){var n=a.auto.test(e);return n&&(e=e.replace(a.auto,"")),e=e.split("-"),e[0]=e[0]||"top",a.primary.test(e[0])||(e[0]="top"),e[1]=e[1]||"center",a.secondary.test(e[1])||(e[1]="center"),e[2]=!!n,e},positionElements:function(e,t,r,o){e=this.getRawNode(e),t=this.getRawNode(t);var i=angular.isDefined(t.offsetWidth)?t.offsetWidth:t.prop("offsetWidth"),c=angular.isDefined(t.offsetHeight)?t.offsetHeight:t.prop("offsetHeight");r=this.parsePlacement(r);var u=o?this.offset(e):this.position(e),s={top:0,left:0,placement:""};if(r[2]){var l=this.viewportOffset(e,o),d=n.getComputedStyle(t),p={width:i+Math.round(Math.abs(this.parseStyle(d.marginLeft)+this.parseStyle(d.marginRight))),height:c+Math.round(Math.abs(this.parseStyle(d.marginTop)+this.parseStyle(d.marginBottom)))};if(r[0]="top"===r[0]&&p.height>l.top&&p.height<=l.bottom?"bottom":"bottom"===r[0]&&p.height>l.bottom&&p.height<=l.top?"top":"left"===r[0]&&p.width>l.left&&p.width<=l.right?"right":"right"===r[0]&&p.width>l.right&&p.width<=l.left?"left":r[0],r[1]="top"===r[1]&&p.height-u.height>l.bottom&&p.height-u.height<=l.top?"bottom":"bottom"===r[1]&&p.height-u.height>l.top&&p.height-u.height<=l.bottom?"top":"left"===r[1]&&p.width-u.width>l.right&&p.width-u.width<=l.left?"right":"right"===r[1]&&p.width-u.width>l.left&&p.width-u.width<=l.right?"left":r[1],"center"===r[1])if(a.vertical.test(r[0])){var f=u.width/2-i/2;l.left+f<0&&p.width-u.width<=l.right?r[1]="left":l.right+f<0&&p.width-u.width<=l.left&&(r[1]="right")}else{var m=u.height/2-p.height/2;l.top+m<0&&p.height-u.height<=l.bottom?r[1]="top":l.bottom+m<0&&p.height-u.height<=l.top&&(r[1]="bottom")}}switch(r[0]){case"top":s.top=u.top-c;break;case"bottom":s.top=u.top+u.height;break;case"left":s.left=u.left-i;break;case"right":s.left=u.left+u.width}switch(r[1]){case"top":s.top=u.top;break;case"bottom":s.top=u.top+u.height-c;break;case"left":s.left=u.left;break;case"right":s.left=u.left+u.width-i;break;case"center":a.vertical.test(r[0])?s.left=u.left+u.width/2-i/2:s.top=u.top+u.height/2-c/2}return s.top=Math.round(s.top),s.left=Math.round(s.left),s.placement="center"===r[1]?r[0]:r[0]+"-"+r[1],s},adjustTop:function(e,n,t,r){return-1!==e.indexOf("top")&&t!==r?{top:n.top-r+"px"}:void 0},positionArrow:function(e,t){e=this.getRawNode(e);var r=e.querySelector(".tooltip-inner, .popover-inner");if(r){var o=angular.element(r).hasClass("tooltip-inner"),i=e.querySelector(o?".tooltip-arrow":".arrow");if(i){var c={top:"",bottom:"",left:"",right:""};if(t=this.parsePlacement(t),"center"===t[1])return void angular.element(i).css(c);var u="border-"+t[0]+"-width",s=n.getComputedStyle(i)[u],l="border-";l+=a.vertical.test(t[0])?t[0]+"-"+t[1]:t[1]+"-"+t[0],l+="-radius";var d=n.getComputedStyle(o?r:e)[l];switch(t[0]){case"top":c.bottom=o?"0":"-"+s;break;case"bottom":c.top=o?"0":"-"+s;break;case"left":c.right=o?"0":"-"+s;break;case"right":c.left=o?"0":"-"+s}c[t[1]]=d,angular.element(i).css(c)}}}}}]),angular.module("ui.bootstrap.modal",["ui.bootstrap.multiMap","ui.bootstrap.stackedMap","ui.bootstrap.position"]).provider("$uibResolve",function(){var e=this;this.resolver=null,this.setResolver=function(e){this.resolver=e},this.$get=["$injector","$q",function(n,t){var r=e.resolver?n.get(e.resolver):null;return{resolve:function(e,o,a,i){if(r)return r.resolve(e,o,a,i);var c=[];return angular.forEach(e,function(e){c.push(angular.isFunction(e)||angular.isArray(e)?t.resolve(n.invoke(e)):angular.isString(e)?t.resolve(n.get(e)):t.resolve(e))}),t.all(c).then(function(n){var t={},r=0;return angular.forEach(e,function(e,o){t[o]=n[r++]}),t})}}}]}).directive("uibModalBackdrop",["$animate","$injector","$uibModalStack",function(e,n,t){function r(n,r,o){o.modalInClass&&(e.addClass(r,o.modalInClass),n.$on(t.NOW_CLOSING_EVENT,function(t,a){var i=a();n.modalOptions.animation?e.removeClass(r,o.modalInClass).then(i):i()}))}return{restrict:"A",compile:function(e,n){return e.addClass(n.backdropClass),r}}}]).directive("uibModalWindow",["$uibModalStack","$q","$animateCss","$document",function(e,n,t,r){return{scope:{index:"@"},restrict:"A",transclude:!0,templateUrl:function(e,n){return n.templateUrl||"uib/template/modal/window.html"},link:function(o,a,i){a.addClass(i.windowTopClass||""),o.size=i.size,o.close=function(n){var t=e.getTop();t&&t.value.backdrop&&"static"!==t.value.backdrop&&n.target===n.currentTarget&&(n.preventDefault(),n.stopPropagation(),e.dismiss(t.key,"backdrop click"))},a.on("click",o.close),o.$isRendered=!0;var c=n.defer();o.$$postDigest(function(){c.resolve()}),c.promise.then(function(){var c=null;i.modalInClass&&(c=t(a,{addClass:i.modalInClass}).start(),o.$on(e.NOW_CLOSING_EVENT,function(e,n){var r=n();t(a,{removeClass:i.modalInClass}).start().then(r)})),n.when(c).then(function(){var n=e.getTop();if(n&&e.modalRendered(n.key),!r[0].activeElement||!a[0].contains(r[0].activeElement)){var t=a[0].querySelector("[autofocus]");t?t.focus():a[0].focus()}})})}}}]).directive("uibModalAnimationClass",function(){return{compile:function(e,n){n.modalAnimation&&e.addClass(n.uibModalAnimationClass)}}}).directive("uibModalTransclude",["$animate",function(e){return{link:function(n,t,r,o,a){a(n.$parent,function(n){t.empty(),e.enter(n,t)})}}}]).factory("$uibModalStack",["$animate","$animateCss","$document","$compile","$rootScope","$q","$$multiMap","$$stackedMap","$uibPosition",function(e,n,t,r,o,a,i,c,u){function s(e){var n="-";return e.replace(I,function(e,t){return(t?n:"")+e.toLowerCase()})}function l(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}function d(){for(var e=-1,n=$.keys(),t=0;t<n.length;t++)$.get(n[t]).value.backdrop&&(e=t);return e>-1&&E>e&&(e=E),e}function p(e,n){var t=$.get(e).value,r=t.appendTo;$.remove(e),T=$.top(),T&&(E=parseInt(T.value.modalDomEl.attr("index"),10)),g(t.modalDomEl,t.modalScope,function(){var n=t.openedClass||C;_.remove(n,e);var o=_.hasKey(n);r.toggleClass(n,o),!o&&w&&w.heightOverflow&&w.scrollbarWidth&&(r.css(w.originalRight?{paddingRight:w.originalRight+"px"}:{paddingRight:""}),w=null),f(!0)},t.closedDeferred),m(),n&&n.focus?n.focus():r.focus&&r.focus()}function f(e){var n;$.length()>0&&(n=$.top().value,n.modalDomEl.toggleClass(n.windowTopClass||"",e))}function m(){if(S&&-1===d()){var e=b;g(S,b,function(){e=null}),S=void 0,b=void 0}}function g(n,t,r,o){function i(){i.done||(i.done=!0,e.leave(n).then(function(){r&&r(),n.remove(),o&&o.resolve()}),t.$destroy())}var c,u=null,s=function(){return c||(c=a.defer(),u=c.promise),function(){c.resolve()}};return t.$broadcast(k.NOW_CLOSING_EVENT,s),a.when(u).then(i)}function h(e){if(e.isDefaultPrevented())return e;var n=$.top();if(n)switch(e.which){case 27:n.value.keyboard&&(e.preventDefault(),o.$apply(function(){k.dismiss(n.key,"escape key press")}));break;case 9:var t=k.loadFocusElementList(n),r=!1;e.shiftKey?(k.isFocusInFirstItem(e,t)||k.isModalFocused(e,n))&&(r=k.focusLastFocusableElement(t)):k.isFocusInLastItem(e,t)&&(r=k.focusFirstFocusableElement(t)),r&&(e.preventDefault(),e.stopPropagation())}}function v(e,n,t){return!e.value.modalScope.$broadcast("modal.closing",n,t).defaultPrevented}function y(){Array.prototype.forEach.call(document.querySelectorAll("["+A+"]"),function(e){var n=parseInt(e.getAttribute(A),10),t=n-1;e.setAttribute(A,t),t||(e.removeAttribute(A),e.removeAttribute("aria-hidden"))})}var S,b,w,C="modal-open",$=c.createNew(),_=i.createNew(),k={NOW_CLOSING_EVENT:"modal.stack.now-closing"},E=0,T=null,A="data-bootstrap-modal-aria-hidden-count",M="a[href], area[href], input:not([disabled]):not([tabindex='-1']), button:not([disabled]):not([tabindex='-1']),select:not([disabled]):not([tabindex='-1']), textarea:not([disabled]):not([tabindex='-1']), iframe, object, embed, *[tabindex]:not([tabindex='-1']), *[contenteditable=true]",I=/[A-Z]/g;return o.$watch(d,function(e){b&&(b.index=e)}),t.on("keydown",h),o.$on("$destroy",function(){t.off("keydown",h)}),k.open=function(n,a){function i(e){function n(e){var n=e.parent()?e.parent().children():[];return Array.prototype.filter.call(n,function(n){return n!==e[0];
})}if(e&&"BODY"!==e[0].tagName)return n(e).forEach(function(e){var n="true"===e.getAttribute("aria-hidden"),t=parseInt(e.getAttribute(A),10);t||(t=n?1:0),e.setAttribute(A,t+1),e.setAttribute("aria-hidden","true")}),i(e.parent())}var c=t[0].activeElement,l=a.openedClass||C;f(!1),T=$.top(),$.add(n,{deferred:a.deferred,renderDeferred:a.renderDeferred,closedDeferred:a.closedDeferred,modalScope:a.scope,backdrop:a.backdrop,keyboard:a.keyboard,openedClass:a.openedClass,windowTopClass:a.windowTopClass,animation:a.animation,appendTo:a.appendTo}),_.put(l,n);var p=a.appendTo,m=d();m>=0&&!S&&(b=o.$new(!0),b.modalOptions=a,b.index=m,S=angular.element('<div uib-modal-backdrop="modal-backdrop"></div>'),S.attr({class:"modal-backdrop","ng-style":"{'z-index': 1040 + (index && 1 || 0) + index*10}","uib-modal-animation-class":"fade","modal-in-class":"in"}),a.backdropClass&&S.addClass(a.backdropClass),a.animation&&S.attr("modal-animation","true"),r(S)(b),e.enter(S,p),u.isScrollable(p)&&(w=u.scrollbarPadding(p),w.heightOverflow&&w.scrollbarWidth&&p.css({paddingRight:w.right+"px"})));var g;a.component?(g=document.createElement(s(a.component.name)),g=angular.element(g),g.attr({resolve:"$resolve","modal-instance":"$uibModalInstance",close:"$close($value)",dismiss:"$dismiss($value)"})):g=a.content,E=T?parseInt(T.value.modalDomEl.attr("index"),10)+1:0;var h=angular.element('<div uib-modal-window="modal-window"></div>');h.attr({class:"modal","template-url":a.windowTemplateUrl,"window-top-class":a.windowTopClass,role:"dialog","aria-labelledby":a.ariaLabelledBy,"aria-describedby":a.ariaDescribedBy,size:a.size,index:E,animate:"animate","ng-style":"{'z-index': 1050 + $$topModalIndex*10, display: 'block'}",tabindex:-1,"uib-modal-animation-class":"fade","modal-in-class":"in"}).append(g),a.windowClass&&h.addClass(a.windowClass),a.animation&&h.attr("modal-animation","true"),p.addClass(l),a.scope&&(a.scope.$$topModalIndex=E),e.enter(r(h)(a.scope),p),$.top().value.modalDomEl=h,$.top().value.modalOpener=c,i(h)},k.close=function(e,n){var t=$.get(e);return y(),t&&v(t,n,!0)?(t.value.modalScope.$$uibDestructionScheduled=!0,t.value.deferred.resolve(n),p(e,t.value.modalOpener),!0):!t},k.dismiss=function(e,n){var t=$.get(e);return y(),t&&v(t,n,!1)?(t.value.modalScope.$$uibDestructionScheduled=!0,t.value.deferred.reject(n),p(e,t.value.modalOpener),!0):!t},k.dismissAll=function(e){for(var n=this.getTop();n&&this.dismiss(n.key,e);)n=this.getTop()},k.getTop=function(){return $.top()},k.modalRendered=function(e){var n=$.get(e);n&&n.value.renderDeferred.resolve()},k.focusFirstFocusableElement=function(e){return e.length>0&&(e[0].focus(),!0)},k.focusLastFocusableElement=function(e){return e.length>0&&(e[e.length-1].focus(),!0)},k.isModalFocused=function(e,n){if(e&&n){var t=n.value.modalDomEl;if(t&&t.length)return(e.target||e.srcElement)===t[0]}return!1},k.isFocusInFirstItem=function(e,n){return n.length>0&&(e.target||e.srcElement)===n[0]},k.isFocusInLastItem=function(e,n){return n.length>0&&(e.target||e.srcElement)===n[n.length-1]},k.loadFocusElementList=function(e){if(e){var n=e.value.modalDomEl;if(n&&n.length){var t=n[0].querySelectorAll(M);return t?Array.prototype.filter.call(t,function(e){return l(e)}):t}}},k}]).provider("$uibModal",function(){var e={options:{animation:!0,backdrop:!0,keyboard:!0},$get:["$rootScope","$q","$document","$templateRequest","$controller","$uibResolve","$uibModalStack",function(n,t,r,o,a,i,c){function u(e){return e.template?t.when(e.template):o(angular.isFunction(e.templateUrl)?e.templateUrl():e.templateUrl)}var s={},l=null;return s.getPromiseChain=function(){return l},s.open=function(o){function s(){return h}var d=t.defer(),p=t.defer(),f=t.defer(),m=t.defer(),g={result:d.promise,opened:p.promise,closed:f.promise,rendered:m.promise,close:function(e){return c.close(g,e)},dismiss:function(e){return c.dismiss(g,e)}};if(o=angular.extend({},e.options,o),o.resolve=o.resolve||{},o.appendTo=o.appendTo||r.find("body").eq(0),!o.appendTo.length)throw new Error("appendTo element not found. Make sure that the element passed is in DOM.");if(!o.component&&!o.template&&!o.templateUrl)throw new Error("One of component or template or templateUrl options is required.");var h;h=o.component?t.when(i.resolve(o.resolve,{},null,null)):t.all([u(o),i.resolve(o.resolve,{},null,null)]);var v;return v=l=t.all([l]).then(s,s).then(function(e){function t(n,t,r,o){n.$scope=i,n.$scope.$resolve={},r?n.$scope.$uibModalInstance=g:n.$uibModalInstance=g;var a=t?e[1]:e;angular.forEach(a,function(e,t){o&&(n[t]=e),n.$scope.$resolve[t]=e})}var r=o.scope||n,i=r.$new();i.$close=g.close,i.$dismiss=g.dismiss,i.$on("$destroy",function(){i.$$uibDestructionScheduled||i.$dismiss("$uibUnscheduledDestruction")});var u,s,l={scope:i,deferred:d,renderDeferred:m,closedDeferred:f,animation:o.animation,backdrop:o.backdrop,keyboard:o.keyboard,backdropClass:o.backdropClass,windowTopClass:o.windowTopClass,windowClass:o.windowClass,windowTemplateUrl:o.windowTemplateUrl,ariaLabelledBy:o.ariaLabelledBy,ariaDescribedBy:o.ariaDescribedBy,size:o.size,openedClass:o.openedClass,appendTo:o.appendTo},h={},v={};o.component?(t(h,!1,!0,!1),h.name=o.component,l.component=h):o.controller&&(t(v,!0,!1,!0),s=a(o.controller,v,!0,o.controllerAs),o.controllerAs&&o.bindToController&&(u=s.instance,u.$close=i.$close,u.$dismiss=i.$dismiss,angular.extend(u,{$resolve:v.$scope.$resolve},r)),u=s(),angular.isFunction(u.$onInit)&&u.$onInit()),o.component||(l.content=e[0]),c.open(g,l),p.resolve(!0)},function(e){p.reject(e),d.reject(e)}).finally(function(){l===v&&(l=null)}),g},s}]};return e}),angular.module("ui.bootstrap.stackedMap",[]).factory("$$stackedMap",function(){return{createNew:function(){var e=[];return{add:function(n,t){e.push({key:n,value:t})},get:function(n){for(var t=0;t<e.length;t++)if(n===e[t].key)return e[t]},keys:function(){for(var n=[],t=0;t<e.length;t++)n.push(e[t].key);return n},top:function(){return e[e.length-1]},remove:function(n){for(var t=-1,r=0;r<e.length;r++)if(n===e[r].key){t=r;break}return e.splice(t,1)[0]},removeTop:function(){return e.pop()},length:function(){return e.length}}}}}),angular.module("uib/template/alert/alert.html",[]).run(["$templateCache",function(e){e.put("uib/template/alert/alert.html",'<button ng-show="closeable" type="button" class="close" ng-click="close({$event: $event})">\n  <span aria-hidden="true">&times;</span>\n  <span class="sr-only">Close</span>\n</button>\n<div ng-transclude></div>\n')}]),angular.module("uib/template/modal/window.html",[]).run(["$templateCache",function(e){e.put("uib/template/modal/window.html","<div class=\"modal-dialog {{size ? 'modal-' + size : ''}}\"><div class=\"modal-content\" uib-modal-transclude></div></div>\n")}]),angular.module("ui.bootstrap.position").run(function(){!angular.$$csp().noInlineStyle&&!angular.$$uibPositionCss&&angular.element(document).find("head").prepend('<style type="text/css">.uib-position-measure{display:block !important;visibility:hidden !important;position:absolute !important;top:-9999px !important;left:-9999px !important;}.uib-position-scrollbar-measure{position:absolute !important;top:-9999px !important;width:50px !important;height:50px !important;overflow:scroll !important;}.uib-position-body-scrollbar-measure{overflow:scroll !important;}</style>'),angular.$$uibPositionCss=!0}),app.directive("updateCart",["CartService",function(e){return{restrict:"A",require:"^form",scope:{cart:"=updateCart",shippingIsBilling:"=?",params:"=?",error:"=?",onSubmit:"=?",onSuccess:"=?",onError:"=?"},link:function(n,t,r,o){t.bind("click",function(){n.onSubmit&&n.onSubmit(),n.error=null;var t=n.params||r.params;t=utils.mergeParams(t,null,null);var o=angular.copy(n.cart);n.shippingIsBilling&&o.customer.shipping_address&&(o.customer.shipping_address.name=null,o.customer.shipping_address.address_1=null,o.customer.shipping_address.address_2=null,o.customer.shipping_address.city=null,o.customer.shipping_address.state_prov=null,o.customer.shipping_address.postal_code=null,o.customer.shipping_address.country=null),e.update(o,n.params).then(function(e){n.cart&&(e.customer=n.cart.customer),n.cart=e,n.onSuccess&&n.onSuccess(e)},function(e){n.error=e,n.onError&&n.onError(e)})})}}}]),app.directive("updateInvoice",["InvoiceService",function(e){return{restrict:"A",require:"^form",scope:{invoice:"=updateInvoice",params:"=?",error:"=?",onSubmit:"=?",onSuccess:"=?",onError:"=?"},link:function(n,t,r,o){t.bind("click",function(){n.onSubmit&&n.onSubmit(),n.error=null;var t=n.params||r.params;t=utils.mergeParams(t,null,null),e.update(n.invoice,n.params).then(function(e){n.invoice=e,n.onSuccess&&n.onSuccess(e)},function(e){n.error=e,n.onError&&n.onError(e)})})}}}]),app.directive("addToCart",["CartService","gettextCatalog",function(e,n){return{restrict:"A",require:"^form",scope:{product:"=addToCart",params:"=?",quantity:"=?",error:"=?",onSubmit:"=?",onSuccess:"=?",onError:"=?"},link:function(t,r,o,a){r.bind("click",function(){if(t.onSubmit&&t.onSubmit(),1==a.$invalid)return void t.$apply(function(){t.error={type:"bad_request",reference:"AWu1twY",code:"invalid_input",message:n.getString("There was a problem with some of the information you supplied. Please review for errors and try again."),status:400}});t.error=null;var r={product_id:t.product.product_id};t.quantity&&(r.quantity=t.quantity);var i=t.params||o.params;i=utils.mergeParams(i,null,null),e.addItem(r,t.params).then(function(e){t.item=e,t.onSuccess&&t.onSuccess(e)},function(e){t.error=e,t.onError&&t.onError(e)})})}}}]),app.directive("submitPayment",["CartService","InvoiceService","gettextCatalog",function(e,n,t){return{restrict:"A",require:"^form",scope:{paymentMethod:"=submitPayment",cart:"=?",invoice:"=?",params:"=?",error:"=?",onSubmit:"=?",onSuccess:"=?",onError:"=?",shippingIsBilling:"=?"},link:function(r,o,a,i){o.bind("click",function(){if(r.onSubmit&&r.onSubmit(),1==i.$invalid&&"paypal"!=r.paymentMethod.type)return r.$apply(function(){r.error={type:"bad_request",reference:"kI1ETNz",code:"invalid_input",message:t.getString("There was a problem with some of the information you supplied. Please review for errors and try again."),status:400}}),void(r.onError&&r.onError(error));o.prop("disabled",!0),r.error=null;var c=r.params||a.params;c=utils.mergeParams(c,null,"order"),r.cart&&(r.shippingIsBilling&&delete r.cart.customer.shipping_address,e.pay(r.cart,r.paymentMethod,c).then(function(e){r.onSuccess&&r.onSuccess(e),o.prop("disabled",null)},function(e){r.error=e,r.onError&&r.onError(e),o.prop("disabled",null)})),r.invoice&&n.pay(r.invoice,r.paymentMethod,c).then(function(e){r.onSuccess&&r.onSuccess(e),o.prop("disabled",null)},function(e){r.error=e,r.onError&&r.onError(e),o.prop("disabled",null)})})}}}]),app.directive("commitPayment",["CartService","InvoiceService","PaymentService","gettextCatalog",function(e,n,t,r){return{restrict:"A",require:"^form",scope:{paymentId:"=commitPayment",paymentMethod:"=?",sale:"=?",invoice:"=?",params:"=?",error:"=?",onSubmit:"=?",onSuccess:"=?",onError:"=?"},link:function(n,o,a,i){o.bind("click",function(){if(n.onSubmit&&n.onSubmit(),1==i.$invalid)return n.$apply(function(){n.error={type:"bad_request",reference:"eS9G9MA",code:"invalid_input",message:r.getString("There was a problem with some of the information you supplied. Please review for errors and try again."),status:400}}),void(n.onError&&n.onError(error));o.prop("disabled",!0),n.error=null;var c=n.params||a.params;c=utils.mergeParams(c,null,"order");var u=function(e,r,a){t.commit(e,r,a).then(function(e){n.onSuccess&&n.onSuccess(e),o.prop("disabled",null)},function(e){n.error=e,n.onError&&n.onError(e),o.prop("disabled",null)})};"cart"==a.saleType?e.update(n.sale).then(function(e){u(n.paymentId,n.paymentMethod,c)},function(e){n.error=e,n.onError&&n.onError(e),o.prop("disabled",null)}):u(n.paymentId,n.paymentMethod,c)})}}}]),app.directive("currencySelect",["CurrencyService","CartService","InvoiceService","ProductService","SettingsService","$timeout","$rootScope",function(e,n,t,r,o,a,i){return{restrict:"A",scope:{currency:"=selectCurrency",cart:"=?",invoice:"=?",products:"=?",params:"=?",onSuccess:"=?",onError:"=?",error:"=?"},link:function(n,t,c){var u=o.get();if(utils.hasProperty(c,"asDropdown")){var s=angular.element(t[0]);_.each(u.account.currencies,function(e){var t='<li><a class="pointer">'+e.name+"</a></li>";optionNg=angular.element(t),s.append(optionNg),optionNg.bind("click",function(t){n.error=null,a(function(){p(n,e.code,c)})})});var l=angular.element(t.parent().children()),d=l.find("span");d&&d.text(e.getCurrencyName()),i.$on("currencyChanged",function(n,r){var o=angular.element(t.parent().children()),a=o.find("span");a&&a.text(e.getCurrencyName())})}else{var s=angular.element(t[0]);_.each(u.account.currencies,function(n){var t='<option value="'+n.code+'"';n.code==e.getCurrency()&&(t+=" selected"),t+=">"+n.name+"</option>",s.append(t)}),t.bind("change",function(e){n.error=null;var r=angular.element(t[0]).val();a(function(){p(n,r,c)})}),i.$on("currencyChanged",function(e,n){s[0].value=n})}var p=function(n,t,o){var a=n.params||o.params;a=utils.mergeParams(a,null,null),e.setCurrency(t,n.params).then(function(e){if(e.cart){var o=null;n.cart&&(o=n.cart.customer),n.cart=e.cart,o&&(n.cart.customer=o)}if(e.invoice){var o=null;n.invoice&&(o=n.invoice.customer),n.invoice=e.invoice,o&&(n.invoice.customer=o)}if(n.products){utils.getQueryParameters(n.products.current_page_url);a.currency=t,r.getList(n.params).then(function(e){n.products=e},function(e){n.error=e,n.onError&&n.onError(e)})}if(n.product){utils.getQueryParameters(n.product.url);n.params.currency=t,r.get(n.product.product_id,n.params).then(function(e){n.product=e},function(e){n.error=e,n.onError&&n.onError(e)})}n.onSuccess&&n.onSuccess(t)},function(e){n.error=e,n.onError&&n.onError(e)})}}}}]),app.directive("languageSelect",["LanguageService","$timeout","$rootScope",function(e,n,t){return{restrict:"A",link:function(r,o,a){var i=e.getLanguages();if(utils.hasProperty(a,"asDropdown")){var c=angular.element(o[0]);_.each(i,function(t){var r='<li><a class="pointer">'+t.name+"</a></li>";optionNg=angular.element(r),c.append(optionNg),optionNg.bind("click",function(r){n(function(){e.setLanguage(t.code,a.languagesPath)})})});var u=angular.element(o.parent().children()),s=u.find("span");s&&s.text(e.getSelectedLanguage().name),t.$on("languageChanged",function(n,t){var r=angular.element(o.parent().children()),a=r.find("span");a&&a.text(e.getSelectedLanguage().name)})}else{var c=angular.element(o[0]);_.each(i,function(n){var t='<option value="'+n.code+'"';n.code==e.getSelectedLanguage().code&&(t+=" selected"),t+=">"+n.name+"</option>",c.append(t)}),o.bind("change",function(t){var r=angular.element(o[0]).val();n(function(){e.setLanguage(r)})}),t.$on("languageChanged",function(e,n){c[0].value=n})}}}}]),app.directive("shippingSelect",["CartService","InvoiceService","$timeout",function(e,n,t){return{restrict:"A",scope:{sale:"=?",shippingQuotes:"=?",params:"=?",onSuccess:"=?",onError:"=?",error:"=?"},link:function(r,o,a){r.$watch("shippingQuotes",function(e,n){if(e){var t=null;r.sale.shipping_item&&(t=r.sale.shipping_item.item_id);var a=angular.element(o[0]);a.html(""),_.each(r.shippingQuotes,function(e){var n='<option value="'+e.method_id+'"';e.method_id==t&&(n+=" selected"),n+=">"+e.description+" ("+e.formatted.price+")</option>",a.append(n)})}}),o.bind("change",function(i){r.error=null;var c=angular.element(o[0]).val(),u=r.params||a.params;u=utils.mergeParams(u,null,null),t(function(){var t={shipping_method_id:c};"cart"==a.saleType&&e.update(t,r.params).then(function(e){e.customer=r.sale.customer,r.sale=e,r.onSuccess&&r.onSuccess(selectedCurrency)},function(e){r.error=e,r.onError&&r.onError(e)}),"invoice"==a.saleType&&n.update(t,r.params).then(function(e){e.customer=r.sale.customer,r.sale=e,r.onSuccess&&r.onSuccess(selectedCurrency)},function(e){r.error=e,r.onError&&r.onError(e)})})})}}}]),app.directive("shippingRadio",["CartService","InvoiceService","$timeout",function(e,n,t){return{restrict:"A",scope:{sale:"=?",shippingQuotes:"=?",params:"=?",onSuccess:"=?",onError:"=?",error:"=?"},link:function(r,o,a){o.bind("change",function(o){r.error=null;var i=a.shippingRadio,c=r.params||a.params;c=utils.mergeParams(c,null,null),t(function(){var t={shipping_method_id:i};"cart"==a.saleType&&e.update(t,r.params).then(function(e){r.sale&&(e.customer=r.sale.customer),r.sale=e,r.onSuccess&&r.onSuccess(selectedCurrency)},function(e){r.error=e,r.onError&&r.onError(e)}),"invoice"==a.saleType&&n.update(t,r.params).then(function(e){r.sale&&(e.customer=r.sale.customer),r.sale=e,r.onSuccess&&r.onSuccess(selectedCurrency)},function(e){r.error=e,r.onError&&r.onError(e)})})})}}}]),app.directive("customerCountries",["GeoService","$timeout",function(e,n){return{restrict:"A",require:"ngModel",link:function(n,t,r,o){n.$watch(r.customerCountries,function(n,r){if(n){var a=angular.element(t[0]);a.html("");var i=e.getData().countries;i=_.filter(i,function(e){return n.indexOf(e.code)>-1}),a.append("<option></option>");var c=o.$viewValue||o.$modelValue,u=!1;_.each(i,function(e){var n='<option value="'+e.code+'"';e.code==c&&(n+=" selected",u=!0),n+=">"+e.name+"</option>",a.append(n)}),0==u&&o.$setViewValue(null)}})}}}]),app.directive("showErrors",["$timeout","SettingsService",function(e,n){return{restrict:"A",require:"^form",link:function(t,r,o,a){var i=function(){e(function(){var e=r[0].querySelector("[name]"),i=r[0].querySelector("label"),c=angular.element(r[0].querySelector(".error-block")),u=angular.element(e),s=angular.element(i),l=angular.element(c);r.removeClass("has-error"),l.addClass("hidden");var d=u.attr("name");t.$watch(o.showErrors,function(n,t){n&&e&&(e.required?s&&s.addClass("required"):s.removeClass("required"))});var p="blur";e&&("checkbox"!=e.type&&"radio"!=e.type||(p="change")),u.bind(p,function(){var e=n.get(),t=e.app.error_notifications||"moderate";"moderate"==t&&r.toggleClass("has-error",a[d].$invalid),"aggressive"==t&&(r.toggleClass("has-error",a[d].$invalid),l.toggleClass("hidden",!a[d].$invalid)),0==a[d].$invalid&&l.toggleClass("hidden",!0)}),t.$on("show-errors-check-validity",function(){a[d]&&(r.toggleClass("has-error",a[d].$invalid),l.toggleClass("hidden",!a[d].$invalid))})})};i(),o.refreshOnChange&&t.$watch(o.refreshOnChange,function(e,n){i()})}}}]),app.directive("conversion",["SettingsService","StorageService",function(e,n){return{restrict:"A",scope:{conversion:"@"},link:function(n,t,r,o){var a=function(){r.$observe("conversion",function(e){if(0==utils.isNullOrEmpty(e)){var n=document.getElementsByTagName("head")[0],t=document.createElement("script");t.id="__conversion",t.type="text/javascript",t.src="analytics/conversion.js",t.setAttribute("data-order_id",e),null!=document.getElementById("__conversion")&&n.removeChild(document.getElementById("__conversion")),n.appendChild(t)}})},i=e.get();1!=i.config.development&&a()}}}]),app.directive("validateOnSubmit",function(){return{restrict:"A",require:"^form",link:function(e,n,t,r){n.bind("click",function(){e.$broadcast("show-errors-check-validity")})}}}),app.directive("validateExpMonth",function(){return{restrict:"A",require:"ngModel",link:function(e,n,t,r){r.$parsers.unshift(function(e){return 0==utils.isValidInteger(e)?void r.$setValidity("month",!1):e>12?void r.$setValidity("month",!1):e<1?void r.$setValidity("month",!1):(r.$setValidity("month",!0),e)})}}}),app.directive("validateExpYear",function(){return{restrict:"A",require:"ngModel",link:function(e,n,t,r){r.$parsers.unshift(function(e){return 0==utils.isValidInteger(e)?void r.$setValidity("year",!1):e.length>4?void r.$setValidity("year",!1):e.length<2?void r.$setValidity("year",!1):(r.$setValidity("year",!0),e)})}}}),app.directive("validateCvv",function(){return{restrict:"A",require:"ngModel",link:function(e,n,t,r){r.$parsers.unshift(function(e){var n,o=t.validateCvv;return o&&(n="3"==o.substring(0,1).toString()?4:3),0==utils.isValidInteger(e)?void r.$setValidity("cvv",!1):e.length<3?void r.$setValidity("cvv",!1):e.length>4?void r.$setValidity("cvv",!1):n&&e.length!=n?void r.$setValidity("cvv",!1):(r.$setValidity("cvv",!0),e)})}}}),app.directive("validateCard",function(){return{restrict:"A",require:"ngModel",link:function(e,n,t,r){r.$parsers.unshift(function(e){return e=utils.removeWhitespace(e),utils.isNullOrEmpty(e)?void r.$setValidity("card",!1):0==/^\d+$/.test(e)?void r.$setValidity("card",!1):e.length<14?void r.$setValidity("card",!1):e.length>19?void r.$setValidity("card",!1):0==utils.luhnCheck(e)?void r.$setValidity("card",!1):(r.$setValidity("card",!0),e)})}}}),app.directive("isValidInteger",function(){return{restrict:"A",require:"ngModel",link:function(e,n,t,r){r.$validators.characters=function(e,n){var r=e||n;return"true"==t.allowEmptyValue&&(""==r||null==r)||0!=utils.isValidInteger(r)&&(!(t.max&&r>t.max)&&(!(t.lessThan&&r>=t.lessThan)&&(!(t.min&&r<t.min)&&!(t.greaterThan&&r<=t.greaterThan))))}}}}),app.directive("isValidNumber",function(){return{restrict:"A",require:"ngModel",link:function(e,n,t,r){r.$validators.characters=function(e,n){var r=e||n;return"true"==t.allowEmptyValue&&(""==r||null==r)||0!=utils.isValidNumber(r)&&(!(t.max&&r>t.max)&&(!(t.lessThan&&r>=t.lessThan)&&(!(t.min&&r<t.min)&&!(t.greaterThan&&r<=t.greaterThan))))}}}}),app.directive("promoCode",["CartService","$timeout",function(e,n){return{restrict:"A",scope:{cart:"=?",params:"=?",error:"=?",onAdd:"=?",onRemove:"=?",onError:"=?"},link:function(t,r,o,a){var i=angular.element(r[0].querySelector(".ask-promo-code")),c=angular.element(r[0].querySelector(".supply-promo-code")),u=angular.element(r[0].querySelector(".applied-promo-code")),s=angular.element(r.find("input")),l=angular.element(r[0].querySelector(".apply-promo-code")),d=angular.element(r[0].querySelector(".remove-promo-code"));c.addClass("hidden"),u.addClass("hidden"),t.$watch("cart",function(e,n){e&&(e.promotion_code?(i.addClass("hidden"),u.removeClass("hidden")):u.addClass("hidden"))}),i.bind("click",function(){i.addClass("hidden"),c.removeClass("hidden"),n(function(){r.find("input")[0].focus()})}),l.bind("click",function(){var n=s.val();if(!utils.isNullOrEmpty(n)){t.error=null;var r={promotion_code:n},a=t.params||o.params;a=utils.mergeParams(a,null,null),e.update(r,t.params).then(function(e){t.cart=e,t.onAdd&&t.onAdd(e),c.addClass("hidden"),u.removeClass("hidden")},function(e){t.error=e,t.onError&&t.onError(e)})}}),d.bind("click",function(){s.val(""),t.error=null;var n={promotion_code:null},r=t.params||o.params;r=utils.mergeParams(r,null,null),e.update(n,t.params).then(function(e){t.cart=e,t.onRemove&&t.onRemove(e),i.removeClass("hidden"),u.addClass("hidden")},function(e){t.error=e,t.onError&&t.onError(e)})}),s.bind("blur",function(){utils.isNullOrEmpty(s.val())&&(c.addClass("hidden"),u.addClass("hidden"),i.removeClass("hidden"),n(function(){t.error=null}))})}}}]),app.directive("customerSignin",["CartService","$timeout",function(e,n){return{restrict:"A",scope:{cart:"=",paymentMethod:"=?",options:"=?",params:"=?",error:"=?",onSigninSubmit:"=?",onSignoutSubmit:"=?",onSigninSuccess:"=?",onSignoutSuccess:"=?",onSigninError:"=?",onSignoutError:"=?"},link:function(t,r,o){var a=angular.element(r[0].querySelector(".ask-signin")),i=angular.element(r[0].querySelector(".show-signin")),c=angular.element(r[0].querySelector(".supply-signin")),u=angular.element(r[0].querySelector(".signin-username")),s=angular.element(r[0].querySelector(".signin-password")),l=angular.element(r[0].querySelector(".submit-signin")),d=angular.element(r[0].querySelector(".cancel-signin")),p=angular.element(r[0].querySelector(".signed-in")),f=angular.element(r[0].querySelector(".submit-signout")),m=function(){a.addClass("hidden"),c.addClass("hidden"),p.addClass("hidden")};r.addClass("hidden"),m(),t.$watchGroup(["options","cart"],function(e,n){var t=e[0],o=e[1];t&&t.customer_optional_fields&&t.customer_optional_fields.indexOf("username")>=0&&(m(),r.removeClass("hidden"),a.removeClass("hidden")),o&&o.customer&&(m(),o.customer.username?p.removeClass("hidden"):a.removeClass("hidden"))},!0),i.bind("click",function(){a.addClass("hidden"),c.removeClass("hidden"),n(function(){r.find("input")[0].focus()})}),s.bind("keydown",function(e){13==e.which&&g()}),u.bind("keydown",function(e){13==e.which&&g()}),l.bind("click",function(e){g()}),f.bind("click",function(){t.onSignoutSubmit&&t.onSignoutSubmit();var n=t.params||o.params;n=utils.mergeParams(n,null,"customer.payment_methods"),e.logout(t.params).then(function(e){t.cart=e,delete t.paymentMethod.payment_method_id,t.onSignoutSuccess&&t.onSignoutSuccess(e)},function(e){t.error=e,t.onSignoutError&&t.onSignoutError(e)})}),d.bind("click",function(){u.val(""),s.val(""),t.error=null,m(),a.removeClass("hidden")});var g=function(){var n=u.val(),r=s.val();if(!utils.isNullOrEmpty(n)&&!utils.isNullOrEmpty(r)){t.error=null,t.onSigninSubmit&&t.onSigninSubmit();var a={username:n,password:r},i=t.params||o.params;i=utils.mergeParams(i,null,"customer.payment_methods"),e.login(a,t.params).then(function(e){if(t.cart=e,u.val(""),s.val(""),e.customer.payment_methods.data.length>0&&t.paymentMethod){var n=_.findWhere(e.customer.payment_methods.data,{is_default:!0}).payment_method_id;t.paymentMethod.payment_method_id=n}t.onSigninSuccess&&t.onSigninSuccess(e)},function(e){t.error=e,t.onSigninError&&t.onSigninError(e)})}}}}}]),app.directive("createAccount",["CustomerService","$timeout",function(e,n){return{restrict:"A",scope:{customer:"=",options:"=?",params:"=?",error:"=?",onSubmit:"=?",onSuccess:"=?",onError:"=?"},link:function(n,t,r){var o=angular.element(t[0].querySelector(".supply-credentials")),a=angular.element(t[0].querySelector(".create-account-username")),i=angular.element(t[0].querySelector(".create-account-password")),c=angular.element(t[0].querySelector(".submit-create-account")),u=angular.element(t[0].querySelector(".account-created"));t.addClass("hidden"),u.addClass("hidden"),n.$watchGroup(["options","customer"],function(e,n){var r=e[0],o=e[1];r&&o&&r.customer_optional_fields&&r.customer_optional_fields.indexOf("username")>=0&&!o.username&&t.removeClass("hidden")}),i.bind("keydown",function(e){13==e.which&&s()}),a.bind("keydown",function(e){13==e.which&&s()}),c.bind("click",function(e){s()});var s=function(){var t=a.val(),c=i.val();if(!utils.isNullOrEmpty(t)&&!utils.isNullOrEmpty(c)){n.error=null,n.onSubmit&&n.onSubmit(),n.customer.username=t,n.customer.password=c;var s=n.params||r.params;s=utils.mergeParams(s,null,"customer.payment_methods"),e.createAccount(n.customer,n.params).then(function(e){n.customer=e,a.val(""),i.val(""),u.removeClass("hidden"),o.addClass("hidden"),n.onSuccess&&n.onSuccess(e)},function(e){n.error=e,n.onError&&n.onError(e)})}}}}}]),app.directive("selectStateProv",["GeoService","$timeout",function(e,n){return{restrict:"A",require:"ngModel",link:function(n,t,r,o){n.$watch(r.country,function(n,r){if(n){var a=e.getStatesProvs(n),i=angular.element(t[0]);i.html(""),i.append("<option></option>");var c=o.$viewValue||o.$modelValue,u=!1;_.each(a,function(e){var n='<option value="'+e.code+'"';c==e.code&&(n+=" selected",u=!0),n+=">"+e.name+"</option>",i.append(n)}),0==u&&o.$setViewValue(null)}})}}}]),app.directive("customerBackgroundSave",["CartService","$timeout",function(e,n){return{restrict:"A",scope:{cart:"=customerBackgroundSave",shippingIsBilling:"=?",params:"=?",error:"=?"},link:function(t,r,o,a){var i=document.querySelectorAll(".customer-background-save");_.each(i,function(r){var a="blur";"SELECT"==r.nodeName&&(a="change"),"checkbox"==r.type&&(a="click");var i,c=angular.element(r);c.bind(a,function(){i&&n.cancel(i),i=n(function(){var n=angular.copy(t.cart);utils.undefinedToNull(n);var a=t.params||o.params;if(a=utils.mergeParams(a,null,null),t.cart){var i=r.getAttribute("ng-model");i&&(i=i.split("customer.")[1],t.cart.customer[i]=c.val(),t.shippingIsBilling&&n.customer.shipping_address&&(n.customer.shipping_address.name=null,n.customer.shipping_address.address_1=null,n.customer.shipping_address.address_2=null,n.customer.shipping_address.city=null,n.customer.shipping_address.state_prov=null,n.customer.shipping_address.postal_code=null,n.customer.shipping_address.country=null),e.update(n,t.params,!0).then(function(e){t.cart&&(e.customer=t.cart.customer),t.cart=e},function(e){t.error=e}))}},25)})})}}}]),app.directive("creditCardImage",[function(){return{restrict:"A",link:function(e,n,t){e.$watch(t.creditCardImage,function(e){var r="images/";if(t.path&&(r=t.path),e){var o=e.replace(" ","").toLowerCase()+".png",a='<img src="'+r+o+'" />',i=angular.element(n);i.empty(),i.html(a)}})}}}]),app.directive("creditCards",["CartService",function(e){return{restrict:"A",link:function(e,n,t){var r="images/";t.path&&(r=t.path),e.$watch(t.creditCards,function(e){if(_.isArray(e)){var t="";_.each(e,function(e){var n=e.replace(" ","").toLowerCase()+".png";t+='<img src="'+r+n+'" title="'+e+'" />'});var o=angular.element(n);o.empty(),o.html(t)}})}}}]),app.directive("stateProvInput",["GeoService","$compile",function(e,n){return{restrict:"E",terminal:!0,link:function(t,r,o){o.$observe("country",function(a){if(a){var i=e.getStatesProvs(o.country);if("select"==o.type){var c=r[0].querySelector("select").outerHTML;if(null==i){c=c.replace("ng-model","suspend-model");var u=angular.element(c);r.empty(),r.append(u),n(u)(t)}else{c=c.replace("suspend-model","ng-model");var u=angular.element(c);r.empty(),r.append(u),n(u)(t)}}if("input"==o.type){var c=r[0].querySelector("input").outerHTML;if(null!=i){c=c.replace("ng-model","suspend-model");var u=angular.element(c);r.empty(),r.append(u),n(u)(t)}else{c=c.replace("suspend-model","ng-model");var u=angular.element(c);r.empty(),r.append(u),n(u)(t)}}}})}}}]),app.directive("selectOnClick",function(){return{restrict:"A",link:function(e,n,t){n.on("click",function(){this.select()})}}}),app.directive("fields",["CartService","InvoiceService","$timeout","$rootScope","LanguageService",function(e,n,t,r,o){return{restrict:"AE",templateUrl:"app/templates/fields.html",scope:{fieldlist:"=",sale:"="},link:function(t,a,i,c){t.fields=[];var u=function(e){var n=[];if("string"==typeof e&&0==utils.isNullOrEmpty(e))try{n=JSON.parse(e)}catch(e){n=[],console.log("The JSON provided for custom fields is not valid JSON. As a result, no custom fields will display. Error message: "+e)}n=s(n);var t=o.getSelectedLanguage().code;return _.each(n,function(e){e.languages&&e.languages[t]&&(e.languages[t].label&&(e.label=e.languages[t].label),e.languages[t].description&&(e.description=e.languages[t].description),e.languages[t].section&&(e.section=e.languages[t].section),e.languages[t].options&&(e.options=e.languages[t].options))}),n},s=function(e){var n=[],t=[];return _.each(e,function(r){if(t.indexOf(r.section)==-1){var o=_.where(e,{section:r.section});o&&(n=n.concat(o),t.push(r.section))}}),n},l=function(e,n){for(var r in e)e.hasOwnProperty(r)&&null==t.sale.meta[e[r].name]&&(t.sale.meta[e[r].name]=e[r].default_value)};t.fields=u(t.fieldlist);var d=t.$watch("sale.meta",function(e,n){null!=t.sale&&(null==t.sale.meta&&(t.sale.meta={}),l(t.fields,t.sale.meta),d())},!0);r.$on("languageChanged",function(e,n){t.fields=u(t.fieldlist)}),t.pushToProperty=function(e,n,r){0==t.isInProperty(e,n)?null==t.sale.meta[e]?(t.sale.meta[e]=[],t.sale.meta[e].push(n)):t.sale.meta[e].push(n):t.sale.meta[e]=_.without(t.sale.meta[e],n),r&&t.record()},t.isInProperty=function(e,n){return null!=t.sale&&(null!=t.sale.meta&&(null!=t.sale.meta[e]&&_.indexOf(t.sale.meta[e],n)>=0))},t.isNewSection=function(e,n){if(0==n)return!0;var r=t.fields[n-1];return null!=r&&r.section!=e.section},t.record=function(){var r={meta:t.sale.meta};"invoice"==t.sale.object?n.update(r):e.update(r)}}}}]),app.directive("validateField",["gettextCatalog","$timeout",function(e,n){return{restrict:"A",require:"ngModel",scope:{field:"=validateField",error:"=?"},link:function(n,t,r,o){var a=(n.error,n.field);utils.isNullOrEmpty(t[0].value)&&1==a.required&&(n.error=e.getString("Please provide a value.")),
"boolean"==a.type&&1==a.required&&(n.error=e.getString("Please make a selection")),"toggle"==a.type&&1==a.required&&(n.error=e.getString("Please confirm")),o.$parsers.unshift(function(t){var r=null;if(null!=t||1==a.required){switch(a.type){case"integer":utils.isValidInteger(t)||(r=e.getString("Please supply a number without decimals"));break;case"decimal":utils.isValidNumber(t)||(r=e.getString("Please supply a number"))}null!=a.options&&utils.isNullOrEmpty(t)&&(r=e.getString("Please make a selection")),null==r&&(null!=a.options&&null==_.where(a.options,{value:t})&&(r=e.getString("Please provide one of the available options")),"integer"!=a.type&&"decimal"!=a.type||(a.min_value&&t<a.min_value&&(r=e.getPlural(a.min_value,"The value you provide must be greater than {{$count}}","The value you provide must be greater than {{$count}}",{})),a.max_value&&t>a.max_value&&(r=e.getPlural(a.max_value,"The value you provide must be less than {{$count}}","The value you provide must be less than {{$count}}",{}))),"string"!=a.type&&"text"!=a.type||(a.min_length&&t.length<a.min_length&&(r=e.getPlural(a.min_length,"The value must be at least one character","The value must be at least {{$count}} characters",{})),a.max_length&&t.length>a.max_length&&(r=e.getPlural(a.max_length,"The value must be less than one character","The value must be less than {{$count}} characters",{}))))}return null!=r?(o.$setValidity("field",!1),void(n.error=r)):(o.$setValidity("field",!0),t)})}}}]),app.factory("appCache",["$cacheFactory",function(e){return e("appCache")}]),app.filter("range",function(){return function(e,n,t,r){function r(e,n){var t=String(e);return t.length<n&&(t=utils.repeat(0,n-e.toString().length)+t),t}n=parseInt(n),t=parseInt(t);for(var o=n;o<=t;o++)r?e.push(r(o,t.toString().length)):e.push(o);return e}}),app.service("ApiService",["$http","$q","$location","SettingsService","HelperService","StorageService","$rootScope","gettextCatalog",function(e,n,t,r,o,a,i,c){function u(e){var n=360;return null!=e&&0==isNaN(e)&&(n=e/60),n-=10}function s(){var t=n.defer(),o=a.get("token");if(null!=o)return t.resolve(o),t.promise;var i={},c=r.get();c.account.account_id&&1==c.config.development&&(i={account_id:c.account.account_id});var u=h("/auths/limited",c),s=e({ignoreLoadingBar:!1,method:"post",url:u+"?timezone=UTC",params:i,timeout:15e3,headers:{"Content-Type":"application/json"}});return s.then(function(e){a.set("token",e.data.token,e.headers("X-Token-Expires-In-Seconds")),a.remove("cart_id"),a.remove("invoice_id"),t.resolve(e.data.token)},function(e){t.reject({type:"internal_server_error",reference:"6lnOOW1",code:"unspecified_error",message:"There was a problem obtaining authorization for this session. Please reload the page to try your request again.",status:e.status})}),t.promise}function l(t,o,a,i){var c=n.defer();return s().then(function(n){null==t&&(t=void 0);var u=r.get(),s=h(o,u),l=e({ignoreLoadingBar:i,method:"post",data:angular.toJson(t),url:s+"?timezone=UTC",params:a,timeout:65e3,headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"}});l.then(function(e){y(e,c)},function(e){S(e,c)})},function(e){c.reject(e)}),c.promise}function d(t,o,a){var i=n.defer();return s().then(function(n){var c=r.get(),u=h(t,c),s=e({ignoreLoadingBar:a,method:"get",url:u+"?timezone=UTC",params:o,timeout:15e3,headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"}});s.then(function(e){y(e,i)},function(e){S(e,i)})},function(e){i.reject(e)}),i.promise}function p(t,o,a){var i=n.defer();return s().then(function(n){var c=r.get(),u=h(t,c),s=utils.getQueryParameters(t);_.each(o,function(e,n){null!=s[n]&&delete s[n]}),t.indexOf("?")>0&&(t=t.substring(0,t.indexOf("?"))),t=utils.appendParams(t,s);var l=e({ignoreLoadingBar:a,method:"get",url:u,params:o,timeout:25e3,headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"}});l.then(function(e){y(e,i)},function(e){S(e,i)})},function(e){i.reject(e)}),i.promise}function f(t,o,a,i){var c=n.defer();return s().then(function(n){var u=r.get(),s=h(o,u);null==t&&(t=void 0);var l=e({ignoreLoadingBar:i,method:"post",data:angular.toJson(v(t)),url:s+"?timezone=UTC",params:a,timeout:25e3,headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"}});l.then(function(e){y(e,c)},function(e){S(e,c)})},function(e){c.reject(e)}),c.promise}function m(t,o,a){var i=n.defer();return s().then(function(n){var c=r.get(),u=h(t,c),s=e({ignoreLoadingBar:a,method:"delete",url:u+"?timezone=UTC",params:o,timeout:15e3,headers:{Authorization:"Bearer "+n,"Content-Type":"application/json"}});s.then(function(e){y(e,i)},function(e){S(e,i)})},function(e){i.reject(e)}),i.promise}function g(t,o,a){var i=n.defer();return s().then(function(n){var c=r.get(),u=h(t,c),s=e({ignoreLoadingBar:a,method:"get",url:u+"?timezone=UTC",params:o,timeout:15e3,responseType:"arraybuffer",headers:{Authorization:"Bearer "+n,Accept:"application/pdf"}});s.then(function(e){y(e,i)},function(e){S(e,i)})},function(e){i.reject(e)}),i.promise}function h(e,n){return"http://"==e.substring(0,7)||"https://"==e.substring(0,8)?e:n.config.apiPrefix+e}function v(e){if(null!=e&&"object"==typeof e){var n=JSON.parse(JSON.stringify(e));"cart"==n.object&&(delete n.options,delete n.shipping_item,delete n.payments,_.each(n.items,function(e){delete e.subscription_terms,delete e.url,delete e.date_created,delete e.date_modified,delete e.formatted,delete e.product,delete e.subscription_plan}),delete n.customer.url,delete n.customer.payments,delete n.customer.refunds,delete n.customer.orders,delete n.customer.subscriptions,delete n.customer.invoices,delete n.promotion),delete n.date_created,delete n.date_modified,delete n.object,delete n.url,delete n.test,delete n.account_id,delete n.formatted}return n}function y(e,n){return a.get("token")&&a.set("token",a.get("token"),e.headers("X-Token-Expires-In-Seconds")),n.resolve(e)}function S(e,n){var t={};e.data&&e.data.error&&(t=e.data.error);var r,a,i,u;if(t&&(t.type&&(r=t.type),t.code&&(i=t.code),t.reference&&(a=t.reference),t.message&&(u=t.message)),401==e.status&&"invalid_login"!=i&&"account_locked"!=i&&o.newSessionRedirect(!0,"Performing session reset due to invalid token in the cookie / request."),403==e.status&&(u="There was a problem establishing your session. Please reload the page to try again."),!u)switch(e.status){case 404:r="not_found",a="4jnJPb7",i="resource_not_found",u=c.getString("The item you are trying to access could not be found.");break;default:r="internal_server_error",a="XEnf9FY",i="unspecified_error",u=c.getString("An error occured while attempting to process your request. Please try your request again. If the problem persists, please contact support.")}t.type=r,t.reference=a,t.code=i,t.message=u,t.status=e.status,n.reject(t)}return{create:l,getItem:d,getList:p,update:f,remove:m,getItemPdf:g,getToken:s,getTokenExpiration:u}}]),app.service("CartService",["$http","$q","$rootScope","ApiService","PaymentService","SettingsService","HelperService","StorageService",function(e,n,t,r,o,a,i,c){function u(e,t,o){var a=n.defer();t=y(t);var i=c.get("currency");i&&(e.currency=i);var u="/carts";return r.create(e,u,t,o).then(function(e){var n=e.data;c.set("cart_id",n.cart_id,e.headers("X-Token-Expires-In-Seconds")),v(n.currency),a.resolve(n)},function(e){a.reject(e)}),a.promise}function s(e,t){var o=n.defer();e=y(e);var a=c.get("cart_id"),u={billing_address:{},shipping_address:{}},s={items:[],customer:u};if(a){var l="/carts/"+a;r.getItem(l,e,t).then(function(e){var n=e.data;null==n.customer&&(n.customer=u),null==n.customer.billing_address.country&&(n.customer.billing_address.country=n.customer_ip_country),null==n.customer.shipping_address.country&&(n.customer.shipping_address.country=n.customer_ip_country),v(n.currency),o.resolve(n)},function(e){404==e.status&&i.newSessionRedirect(!0,"Performing a session reset due to an invalid cart_id in the cookie / request. (404 - cart not found)"),o.reject(e)})}else o.resolve(s);return o.promise}function l(e,t,o){var a=n.defer();t=y(t);var s=c.get("cart_id");if(s){var l="/carts/"+s;return r.update(e,l,t,o).then(function(e){var n=e.data;c.set("cart_id",n.cart_id,e.headers("X-Token-Expires-In-Seconds")),v(n.currency),a.resolve(n)},function(e){404==e.status&&i.newSessionRedirect(!0,"Performing a session reset due to an invalid cart_id in the cookie / request. (404 - cart not found)"),"invalid_state"==e.code&&(c.remove("cart_id"),i.newSessionRedirect(!1,"Performing a cart_id reset due to an invalid cart_id in the cookie / request. (422 - invalid state): "+e.message)),a.reject(e)}),a.promise}return u(e,t,o)}function d(e,t,o){var a=n.defer();t=y(t);var u=c.get("cart_id"),s="/carts/"+u+"/login";return r.update(e,s,t,o).then(function(e){var n=e.data;c.set("cart_id",n.cart_id,e.headers("X-Token-Expires-In-Seconds")),v(n.currency),a.resolve(n)},function(e){404==e.status&&i.newSessionRedirect(!0,"Performing a session reset due to an invalid cart_id in the cookie / request. (404 - cart not found)"),a.reject(e)}),a.promise}function p(e,t){var o=n.defer();e=y(e);var a=c.get("cart_id"),u="/carts/"+a+"/logout";return r.update(null,u,e,t).then(function(e){var n=e.data;c.set("cart_id",n.cart_id,e.headers("X-Token-Expires-In-Seconds")),v(n.currency),o.resolve(n)},function(e){404==e.status&&i.newSessionRedirect(!0,"Performing a session reset due to an invalid cart_id in the cookie / request. (404 - cart not found)"),o.reject(e)}),o.promise}function f(e,t,o){var a=n.defer();return null==e?(a.reject({type:"bad_request",reference:"vbVcrcF",code:"invalid_input",message:"You must supply an item to add to the cart.",status:400}),a.promise):(t=y(t),s(t).then(function(n){if(n.url){var i=_.findWhere(n.items,e);null!=i?r.update(e,i.url,t,o).then(function(e){var n=e.data;v(n.currency),a.resolve(n)},function(e){a.reject(e)}):r.create(e,n.url+"/items",t,o).then(function(e){var n=e.data;v(n.currency),a.resolve(n)},function(e){a.reject(e)})}else n.items.push(e),u(n,t,o).then(function(n){a.resolve(_.findWhere(n.items,{item_id:e.product_id}))},function(e){a.reject(e)})},function(e){a.reject(e)}),a.promise)}function m(e,n){return s(e,n).then(function(e){v(e.currency),deferred.resolve(e.items)},function(e){deferred.reject(e)}),deferred.promise}function g(e,t,r,a){var i=n.defer();r=y(r);var s=function(n,t){var u="/carts/"+e.cart_id+"/payments";o.create(t,u,r,a).then(function(e){"completed"!=e.status&&"pending"!=e.status||c.remove("cart_id"),i.resolve(e)},function(e){i.reject(e)})};return null==e.cart_id?u(e,r,a).then(function(e){s(e.cart_id,t)},function(e){i.reject(e)}):l(e,r,a).then(function(e){s(e.cart_id,t)},function(e){i.reject(e)}),i.promise}function h(e,n){var t=n.search();utils.stringToBool(t.empty_cart)&&(e.items=[],n.search("empty_cart",null));for(var r in t)if(t.hasOwnProperty(r)&&"product_id:"==utils.left(r,11)){var o={product_id:r.substring(11)};0==utils.isValidInteger(t[r])?o.quantity=1:o.quantity=t[r];var a=_.find(e.items,function(e){return e.product_id==o.product_id});null!=a&&(e.items=_.reject(e.items,function(e){return e.product_id==o.product_id})),e.items=e.items||[],e.items.push(o),n.search(r,null)}t.promotion_code&&(e.promotion_code=t.promotion_code,n.search("promotion_code",null)),t.currency&&(e.currency=t.currency,n.search("currency",null)),t.name&&(e.customer.name=t.name,n.search("name",null)),t.email&&(utils.isValidEmail(t.email)&&(e.customer.email=t.email),n.search("email",null)),t.referrer&&(e.referrer=t.referrer,n.search("referrer",null)),t.affiliate_id&&(e.affiliate_id=t.affiliate_id,n.search("affiliate_id",null)),0==_.size(e.customer)&&delete e.customer;var t=n.search();for(var r in t)t.hasOwnProperty(r)&&(null==e.meta&&(e.meta={}),e.meta[r]=t[r]);return e}function v(e){var n=c.get("currency");e!=n&&(c.set("currency",e),t.$emit("currencyChanged",e))}function y(e,n){var t=angular.copy(e);return t?(t.formatted=!0,delete t.show,t):{formatted:!0,options:!0}}return{create:u,get:s,update:l,addItem:f,getItems:m,pay:g,login:d,logout:p,fromParams:h}}]),app.service("InvoiceService",["$http","$q","$rootScope","ApiService","PaymentService","SettingsService","HelperService","StorageService",function(e,n,t,r,o,a,i,c){function u(e,t){var o=n.defer();e=p(e);var a=c.get("invoice_id"),u="/invoices/"+a;return r.getItem(u,e,t).then(function(e){var n=e.data;d(n.currency),o.resolve(n)},function(e){404==e.status&&i.newSessionRedirect(!0,"Performing a session reset due to an invalid invoice_id in the cookie / request. (404 - invoice not found)"),o.reject(e)}),o.promise}function s(e,t,o){var a=n.defer();t=p(t);var u=c.get("invoice_id"),s="/invoices/"+u;return r.update(e,s,t,o).then(function(e){var n=e.data;c.set("invoice_id",n.invoice_id,e.headers("X-Token-Expires-In-Seconds")),d(n.currency),a.resolve(n)},function(e){404==e.status&&i.newSessionRedirect(!0,"Performing a session reset due to an invalid invoice_id in the cookie / request. (404 - invoice not found)"),a.reject(e)}),a.promise}function l(e,t,r,a){var i=n.defer();r=p(r);var c=function(n,t){var c="/invoices/"+e.invoice_id+"/payments";o.create(t,c,r,a).then(function(e){i.resolve(e)},function(e){i.reject(e)})};return c(e.invoice_id,t),i.promise}function d(e){var n=c.get("currency");e!=n&&(c.set("currency",e),t.$emit("currencyChanged",e))}function p(e,n){var t=angular.copy(e);return t?(t.formatted=!0,delete t.show,t):{formatted:!0,options:!0}}return{get:u,update:s,pay:l}}]),app.service("PaymentService",["$http","$q","ApiService","SettingsService","StorageService",function(e,n,t,r,o){function a(e,r,o,a){var i=n.defer();o=u(o);var c={payment_method:e};return t.create(c,r,o,a).then(function(e){var n=e.data;i.resolve(n)},function(e){i.reject(e)}),i.promise}function i(e,r,o){var a=n.defer();if(r=u(r),e){var i="/payments/"+e;t.getItem(i,r,o).then(function(e){var n=e.data;a.resolve(n)},function(e){a.reject(e)})}else a.reject({type:"bad_request",reference:"HdPWrih",code:"invalid_input",message:"You request contained invalid data and could not be processed.",status:400}),console.log("Your request for a payment must include a payment_id.");return a.promise}function c(e,r,a,i){var c="/payments/"+e+"/commit",s=n.defer();return a=u(a),t.create(r,c,a,i).then(function(e){var n=e.data;"completed"!=n.status&&"pending"!=n.status||(o.remove("cart_id"),o.remove("invoice_id")),s.resolve(n)},function(e){s.reject(e)}),s.promise}function u(e,n){return e?(e.formatted=!0,null==e.expand?e.expand="response_data,payment_method":("-1"==e.expand.indexOf("response_data")&&(e.expand+=",response_data"),"-1"==e.expand.indexOf("payment_method")&&(e.expand+=",payment_method")),e):{formatted:!0,expand:"response_data,payment_method"}}return{create:a,get:i,commit:c}}]),app.service("OrderService",["$http","$q","ApiService",function(e,n,t){function r(e,r,a){var i=n.defer();if(r=o(r),e){var c="/orders/"+e;t.getItem(c,r,a).then(function(e){var n=e.data;i.resolve(n)},function(e){i.reject(e)})}else i.reject({type:"bad_request",reference:"HdPWrih",code:"invalid_input",message:"The order you are trying to view cannot be found.",status:400}),console.log("The order_id was not provided.");return i.promise}function o(e,n){return e?(e.formatted=!0,e):{formatted:!0}}return{get:r}}]),app.service("CustomerService",["$http","$q","ApiService",function(e,n,t){function r(e,r,o){var a=n.defer();if(e.customer_id){var i="/customers/"+e.customer_id;t.update(e,i,r,o).then(function(e){a.resolve(e.data)},function(e){a.reject(e)})}else a.reject({type:"bad_request",reference:"8b1oMYs",code:"invalid_input",message:"The request could not be completed.",status:400}),console.log("The customer object in the account creation request did not contain a customer_id.");return a.promise}return{createAccount:r}}]),app.service("ProductService",["$http","$q","ApiService","CurrencyService",function(e,n,t,r){function o(e,o,a){var c=n.defer();if(o=i(o),e){var u="/products/"+e;t.getItem(u,o,a).then(function(e){var n=e.data;null==r.getCurrency()&&r.setCurrency(n.currency),c.resolve(n)},function(e){c.reject(e)})}else c.reject({type:"bad_request",reference:"IrUQTRv",code:"invalid_input",message:"The product you are trying to view cannot be found.",status:400}),console.log("The product_id was not provided.");return c.promise}function a(e,o){var a=n.defer();e=i(e);var c="/products";return t.getList(c,e,o).then(function(e){var n=e.data;null==r.getCurrency()&&n.data[0]&&r.setCurrency(n.data[0].currency),a.resolve(n)},function(e){a.reject(e)}),a.promise}function i(e,n){return e?(e.formatted=!0,e):{formatted:!0}}return{get:o,getList:a}}]),app.service("GeoService",[function(){function e(){var e={};return e.countries=[{name:"Afghanistan",code:"AF"},{name:"Albania",code:"AL"},{name:"Algeria",code:"DZ"},{name:"American Samoa",code:"AS"},{name:"Andorra",code:"AD"},{name:"Angola",code:"AO"},{name:"Anguilla",code:"AI"},{name:"Antarctica",code:"AQ"},{name:"Antigua and Barbuda",code:"AG"},{name:"Argentina",code:"AR"},{name:"Armenia",code:"AM"},{name:"Aruba",code:"AW"},{name:"Australia",code:"AU"},{name:"Austria",code:"AT"},{name:"Azerbaijan",code:"AZ"},{name:"Bahamas",code:"BS"},{name:"Bahrain",code:"BH"},{name:"Bangladesh",code:"BD"},{name:"Barbados",code:"BB"},{name:"Belarus",code:"BY"},{name:"Belgium",code:"BE"},{name:"Belize",code:"BZ"},{name:"Benin",code:"BJ"},{name:"Bermuda",code:"BM"},{name:"Bhutan",code:"BT"},{name:"Bolivia, Plurinational State of",code:"BO"},{name:"Bonaire, Sint Eustatius and Saba",code:"BQ"},{name:"Bosnia and Herzegovina",code:"BA"},{name:"Botswana",code:"BW"},{name:"Bouvet Island",code:"BV"},{name:"Brazil",code:"BR"},{name:"British Indian Ocean Territory",code:"IO"},{name:"Brunei Darussalam",code:"BN"},{name:"Bulgaria",code:"BG"},{name:"Burkina Faso",code:"BF"},{name:"Burundi",code:"BI"},{name:"Cambodia",code:"KH"},{name:"Cameroon",code:"CM"},{name:"Canada",code:"CA"},{name:"Cape Verde",code:"CV"},{name:"Cayman Islands",code:"KY"},{name:"Central African Republic",code:"CF"},{name:"Chad",code:"TD"},{name:"Chile",code:"CL"},{name:"China",code:"CN"},{name:"Christmas Island",code:"CX"},{name:"Cocos (Keeling) Islands",code:"CC"},{name:"Colombia",code:"CO"},{name:"Comoros",code:"KM"},{name:"Congo",code:"CG"},{name:"Congo, the Democratic Republic of the",code:"CD"},{name:"Cook Islands",code:"CK"},{name:"Costa Rica",code:"CR"},{name:"Cote d Ivoire",code:"CI"},{name:"Croatia",code:"HR"},{name:"Cuba",code:"CU"},{name:"Curacao",code:"CW"},{name:"Cyprus",code:"CY"},{name:"Czech Republic",code:"CZ"},{name:"Denmark",code:"DK"},{name:"Djibouti",code:"DJ"},{name:"Dominica",code:"DM"},{name:"Dominican Republic",code:"DO"},{name:"Ecuador",code:"EC"},{name:"Egypt",code:"EG"},{name:"El Salvador",code:"SV"},{name:"Equatorial Guinea",code:"GQ"},{name:"Eritrea",code:"ER"},{name:"Estonia",code:"EE"},{name:"Ethiopia",code:"ET"},{name:"Falkland Islands",code:"AX"},{name:"Falkland Islands (Malvinas)",code:"FK"},{name:"Faroe Islands",code:"FO"},{name:"Fiji",code:"FJ"},{name:"Finland",code:"FI"},{name:"France",code:"FR"},{name:"French Guiana",code:"GF"},{name:"French Polynesia",code:"PF"},{name:"French Southern Territories",code:"TF"},{name:"Gabon",code:"GA"},{name:"Gambia",code:"GM"},{name:"Georgia",code:"GE"},{name:"Germany",code:"DE"},{name:"Ghana",code:"GH"},{name:"Gibraltar",code:"GI"},{name:"Greece",code:"GR"},{name:"Greenland",code:"GL"},{name:"Grenada",code:"GD"},{name:"Guadeloupe",code:"GP"},{name:"Guam",code:"GU"},{name:"Guatemala",code:"GT"},{name:"Guernsey",code:"GG"},{name:"Guinea",code:"GN"},{name:"Guine Bissau",code:"GW"},{name:"Guyana",code:"GY"},{name:"Haiti",code:"HT"},{name:"Heard Island and McDonald Islands",code:"HM"},{name:"Holy See (Vatican City State)",code:"VA"},{name:"Honduras",code:"HN"},{name:"Hong Kong",code:"HK"},{name:"Hungary",code:"HU"},{name:"Iceland",code:"IS"},{name:"India",code:"IN"},{name:"Indonesia",code:"ID"},{name:"Iran",code:"IR"},{name:"Iraq",code:"IQ"},{name:"Ireland",code:"IE"},{name:"Isle of Man",code:"IM"},{name:"Israel",code:"IL"},{name:"Italy",code:"IT"},{name:"Jamaica",code:"JM"},{name:"Japan",code:"JP"},{name:"Jersey",code:"JE"},{name:"Jordan",code:"JO"},{name:"Kazakhstan",code:"KZ"},{name:"Kenya",code:"KE"},{name:"Kiribati",code:"KI"},{name:"Korea",code:"KR"},{name:"Kuwait",code:"KW"},{name:"Kyrgyzstan",code:"KG"},{name:"Lao Peoples Democratic Republic",code:"LA"},{name:"Latvia",code:"LV"},{name:"Lebanon",code:"LB"},{name:"Lesotho",code:"LS"},{name:"Liberia",code:"LR"},{name:"Libya",code:"LY"},{name:"Liechtenstein",code:"LI"},{name:"Lithuania",code:"LT"},{name:"Luxembourg",code:"LU"},{name:"Macao",code:"MO"},{name:"Macedonia",code:"MK"},{name:"Madagascar",code:"MG"},{name:"Malawi",code:"MW"},{name:"Malaysia",code:"MY"},{name:"Maldives",code:"MV"},{name:"Mali",code:"ML"},{name:"Malta",code:"MT"},{name:"Marshall Islands",code:"MH"},{name:"Martinique",code:"MQ"},{name:"Mauritania",code:"MR"},{name:"Mauritius",code:"MU"},{name:"Mayotte",code:"YT"},{name:"Mexico",code:"MX"},{name:"Micronesia",code:"FM"},{name:"Moldova",code:"MD"},{name:"Monaco",code:"MC"},{name:"Mongolia",code:"MN"},{name:"Montenegro",code:"ME"},{name:"Montserrat",code:"MS"},{name:"Morocco",code:"MA"},{name:"Mozambique",code:"MZ"},{name:"Myanmar",code:"MM"},{name:"Namibia",code:"NA"},{name:"Nauru",code:"NR"},{name:"Nepal",code:"NP"},{name:"Netherlands",code:"NL"},{name:"New Caledonia",code:"NC"},{name:"New Zealand",code:"NZ"},{name:"Nicaragua",code:"NI"},{name:"Niger",code:"NE"},{name:"Nigeria",code:"NG"},{name:"Niue",code:"NU"},{name:"Norfolk Island",code:"NF"},{name:"Northern Mariana Islands",code:"MP"},{name:"Norway",code:"NO"},{name:"Oman",code:"OM"},{name:"Pakistan",code:"PK"},{name:"Palau",code:"PW"},{name:"Panama",code:"PA"},{name:"Papua New Guinea",code:"PG"},{name:"Paraguay",code:"PY"},{name:"Peru",code:"PE"},{name:"Philippines",code:"PH"},{name:"Pitcairn",code:"PN"},{name:"Poland",code:"PL"},{name:"Portugal",code:"PT"},{name:"Puerto Rico",code:"PR"},{name:"Qatar",code:"QA"},{name:"Reunion",code:"RE"},{name:"Romania",code:"RO"},{name:"Russian Federation",code:"RU"},{name:"Rwanda",code:"RW"},{name:"Saint Barthélemy",code:"BL"},{name:"Saint Helena",code:"SH"},{name:"Saint Kitts and Nevis",code:"KN"},{name:"Saint Lucia",code:"LC"},{name:"Saint Martin French",code:"MF"},{name:"Saint Pierre and Miquelon",code:"PM"},{name:"Saint Vincent and the Grenadines",code:"VC"},{name:"Samoa",code:"WS"},{name:"San Marino",code:"SM"},{name:"Sao Tome and Principe",code:"ST"},{name:"Saudi Arabia",code:"SA"},{name:"Senegal",code:"SN"},{name:"Serbia",code:"RS"},{name:"Seychelles",code:"SC"},{name:"Sierra Leone",code:"SL"},{name:"Singapore",code:"SG"},{name:"Sint Maarten Dutch",code:"SX"},{name:"Slovakia",code:"SK"},{name:"Slovenia",code:"SI"},{name:"Solomon Islands",code:"SB"},{name:"Somalia",code:"SO"},{name:"South Africa",code:"ZA"},{name:"South Sudan",code:"SS"},{name:"Spain",code:"ES"},{name:"Sri Lanka",code:"LK"},{name:"Sudan",code:"SD"},{name:"Suriname",code:"SR"},{name:"Svalbard and Jan Mayen",code:"SJ"},{name:"Swaziland",code:"SZ"},{name:"Sweden",code:"SE"},{name:"Switzerland",code:"CH"},{name:"Syrian Arab Republic",code:"SY"},{name:"Taiwan",code:"TW"},{name:"Tajikistan",code:"TJ"},{name:"Tanzania",code:"TZ"},{name:"Thailand",code:"TH"},{name:"Timor Leste",code:"TL"},{name:"Togo",code:"TG"},{name:"Tokelau",code:"TK"},{name:"Tonga",code:"TO"},{name:"Trinidad and Tobago",code:"TT"},{name:"Tunisia",code:"TN"},{name:"Turkey",code:"TR"},{name:"Turkmenistan",code:"TM"},{name:"Turks and Caicos Islands",code:"TC"},{name:"Tuvalu",code:"TV"},{name:"Uganda",code:"UG"},{name:"Ukraine",code:"UA"},{name:"United Arab Emirates",code:"AE"},{name:"United Kingdom",code:"GB"},{name:"United States",code:"US"},{name:"United States Minor Outlying Islands",code:"UM"},{name:"Uruguay",code:"UY"},{name:"Uzbekistan",code:"UZ"},{name:"Vanuatu",code:"VU"},{name:"Venezuela",code:"VE"},{name:"Viet Nam",code:"VN"},{name:"Virgin Islands British",code:"VG"},{name:"Virgin Islands U.S.",code:"VI"},{name:"Wallis and Futuna",code:"WF"},{name:"Western Sahara",code:"EH"},{name:"Yemen",code:"YE"},{name:"Zambia",code:"ZM"},{name:"Zimbabwe",code:"ZW"}],e.usStates=[{name:"Alabama",code:"AL"},{name:"Alaska",code:"AK"},{name:"American Samoa",code:"AS"},{name:"Arizona",code:"AZ"},{name:"Arkansas",code:"AR"},{name:"California",code:"CA"},{name:"Colorado",code:"CO"},{name:"Connecticut",code:"CT"},{name:"Delaware",code:"DE"},{name:"District Of Columbia",code:"DC"},{name:"Federated States Of Micronesia",code:"FM"},{name:"Florida",code:"FL"},{name:"Georgia",code:"GA"},{name:"Guam",code:"GU"},{name:"Hawaii",code:"HI"},{name:"Idaho",code:"ID"},{name:"Illinois",code:"IL"},{name:"Indiana",code:"IN"},{name:"Iowa",code:"IA"},{name:"Kansas",code:"KS"},{name:"Kentucky",code:"KY"},{name:"Louisiana",code:"LA"},{name:"Maine",code:"ME"},{name:"Marshall Islands",code:"MH"},{name:"Maryland",code:"MD"},{name:"Massachusetts",code:"MA"},{name:"Michigan",code:"MI"},{name:"Minnesota",code:"MN"},{name:"Mississippi",code:"MS"},{name:"Missouri",code:"MO"},{name:"Montana",code:"MT"},{name:"Nebraska",code:"NE"},{name:"Nevada",code:"NV"},{name:"New Hampshire",code:"NH"},{name:"New Jersey",code:"NJ"},{name:"New Mexico",code:"NM"},{name:"New York",code:"NY"},{name:"North Carolina",code:"NC"},{name:"North Dakota",code:"ND"},{name:"Northern Mariana Islands",code:"MP"},{name:"Ohio",code:"OH"},{name:"Oklahoma",code:"OK"},{name:"Oregon",code:"OR"},{name:"Palau",code:"PW"},{name:"Pennsylvania",code:"PA"},{name:"Puerto Rico",code:"PR"},{name:"Rhode Island",code:"RI"},{name:"South Carolina",code:"SC"},{name:"South Dakota",code:"SD"},{name:"Tennessee",code:"TN"},{name:"Texas",code:"TX"},{name:"Utah",code:"UT"},{name:"Vermont",code:"VT"},{name:"Virgin Islands",code:"VI"},{name:"Virginia",code:"VA"},{name:"Washington",code:"WA"},{name:"West Virginia",code:"WV"},{name:"Wisconsin",code:"WI"},{name:"Wyoming",code:"WY"},{name:"U.S. Armed Forces Americas",code:"AA"},{name:"U.S. Armed Forces Europe",code:"AE"},{name:"U.S. Armed Forces Pacific",code:"AP"}],e.caProvinces=[{code:"AB",name:"Alberta"},{code:"BC",name:"British Columbia"},{code:"LB",name:"Labrador"},{code:"MB",name:"Manitoba"},{code:"NB",name:"New Brunswick"},{code:"NL",name:"Newfoundland"},{code:"NS",name:"Nova Scotia"},{code:"NU",name:"Nunavut"},{code:"NW",name:"Northwest Territories"},{code:"ON",name:"Ontario"},{code:"PE",name:"Prince Edward Island"},{code:"QC",name:"Quebec"},{code:"SK",name:"Saskatchewen"},{code:"YT",name:"Yukon"}],e}function n(n){var t=e();return"US"==n?t.usStates:"CA"==n?t.caProvinces:null}function t(e){var n=["AT","BE","BG","HR","CY","CZ","DK","EE","FI","FR","DE","GR","HU","IE","IT","LV","LT","LU","MT","NL","PL","PT","RO","SK","SI","ES","SE","GB"];return n.indexOf(e)>-1}return{getData:e,getStatesProvs:n,isEu:t}}]),app.service("CurrencyService",["$q","$rootScope","SettingsService","CartService","InvoiceService","StorageService","ApiService",function(e,n,t,r,o,a,i){function c(){return a.get("currency")}function u(){var e=c(),n=t.get(),r=null;return _.each(n.account.currencies,function(n){n.code==e&&(r=n.name)}),r}function s(t,i){var c=e.defer();return a.get("cart_id")?r.update({currency:t},i).then(function(e){a.set("currency",t),n.$emit("currencyChanged",t),c.resolve({cart:e})},function(e){c.reject(e)}):a.get("invoice_id")?o.update({currency:t},i).then(function(e){a.set("currency",t),c.resolve({invoice:e})},function(e){c.reject(e)}):(a.set("currency",t),n.$emit("currencyChanged",t),c.resolve({})),c.promise}return{getCurrency:c,getCurrencyName:u,setCurrency:s}}]),app.service("LanguageService",["$q","$rootScope","SettingsService","StorageService","gettextCatalog","ApiService",function(e,n,t,r,o,a){function i(){return n.languages?n.languages:[{code:"en",name:"English"}]}function c(){var e=i(),n=r.get("language"),n=_.findWhere(e,{code:n});return n?n:{name:null,code:null}}function u(e){var n=i();return!(null==_.findWhere(n,{code:e}))}function s(e,t){0!=u(e)&&null!=e&&(r.set("language",e),o.setCurrentLanguage(e),n.$emit("languageChanged",e),"en"!=e&&o.loadRemote((t||"languages/")+e+"/"+e+".json"))}function l(){var r=e.defer();if(!n.languages)return r.resolve("en"),r.promise;var o=c();if(o.code)r.resolve(o.code);else{t.get();a.getItem("/browser_info",null,!0).then(function(e){r.resolve(e.data.language)},function(e){r.resolve(null)})}return r.promise}function d(e){l().then(function(n){null==n&&(n="en"),s(n,e)})}return{getSelectedLanguage:c,getLanguages:i,setLanguage:s,establishLanguage:d}}]),app.service("SettingsService",[function(e,n){function t(){var e=function(){var e={};window.__settings&&window.__settings.account&&(e=window.__settings.account),e.date_utc||(e.date_utc=utils.getCurrentIsoDate(!0));var n=new Date(e.date_utc);return e.year=n.getFullYear(),e.month=n.getMonth(),e.date=n.getDate(),e},n=function(){var e={};return window.__settings&&window.__settings.app&&(e=window.__settings.app),e},t={account:e(),app:n(),config:{}};return t.config.apiPrefix="/api/v1",t.config.development=!1,(t.account.development||t.app.development)&&(t.config.development=!0,t.config.apiPrefix="https://api.comecero.com"+t.config.apiPrefix),t}return{get:t}}]),app.service("HelperService",["SettingsService","StorageService","$location",function(e,n,t){function r(e,n,t){if(!e||!n)return!1;var r=!1;return"shipping_address."==e.substring(0,17)&&(e="billing_address."+e.substring(17),r=!0),"billing_address.name"==e&&(e="name"),t!==!0&&(!!n.customer_required_fields&&n.customer_required_fields.indexOf(e)>=0)}function o(e,n,t){if(!e||!n)return!1;var r=!1;return"shipping_address."==e.substring(0,17)&&(e="billing_address."+e.substring(17),r=!0),"billing_address.name"==e&&(e="name"),t!==!0&&(!!n.customer_optional_fields&&n.customer_optional_fields.indexOf(e)>=0)}function a(e,n,t){return!(!e||!n)&&(!(!n.customer_required_fields||!r(e,n,t))||!(!n.customer_optional_fields||!o(e,n,t)))}function i(e){return!(!e||(e.shipping_address,!e.shipping_address.address_1))}function c(r,o){console.log(o),r===!0&&(n.remove("cart_id"),n.remove("invoice_id"),n.remove("token"));var a=e.get().app;a.main_shopping_url?window.location.replace(a.main_shopping_url):"/"!=t.path()?(t.path("/"),t.replace()):window.location.reload()}function u(){var n=e.get().app;return null==n.main_shopping_url?window.location.href.substring(0,window.location.href.indexOf("#"))+"#/":n.main_shopping_url}function s(e){return null!=_.find(e,function(e){return null!=e.subscription_plan})}function l(e){return null!=_.find(e,function(e){return"physical"==e.type})}function d(e,n){return!(!e||!n)&&null!=_.find(n.payment_methods,function(n){return n.payment_method_type==e})}return{isRequiredCustomerField:r,isOptionalCustomerField:o,isCustomerField:a,hasShippingAddress:i,newSessionRedirect:c,getShoppingUrl:u,hasSubscription:s,hasPhysical:l,supportsPaymentMethod:d}}]),app.service("StorageService",["appCache",function(e){function n(n){var t=e.get(n);return null==t&&(t=utils.getCookie(n)),t}function t(n,t,r){e.put(n,t),null==r&&(r=1209600),utils.setCookie(n,t,r/60)}function r(n){e.remove(n),utils.deleteCookie(n)}return{get:n,set:t,remove:r}}]);